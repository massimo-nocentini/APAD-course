
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>numpy module &#8212; APAD course  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pandas module" href="pandas.html" />
    <link rel="prev" title="Exercises" href="exercises.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">APAD course</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=massimo-nocentini&repo=APAD-course&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter-notebooks.html">Jupyter notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="core-concepts.html">Core concepts</a></li>
<li class="toctree-l1"><a class="reference internal" href="exercises.html">Exercises</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">numpy module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-numpy">Introduction to NumPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#understanding-data-types-in-python">Understanding Data Types in Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-arrays-from-python-lists">Creating Arrays from Python Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-arrays-from-scratch">Creating Arrays from Scratch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numpy-standard-data-types">NumPy Standard Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intermezzo">INTERMEZZO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-basics-of-numpy-arrays">The Basics of NumPy Arrays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#numpy-array-attributes">NumPy Array Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-indexing-accessing-single-elements">Array Indexing: Accessing Single Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="#array-slicing-accessing-subarrays">Array Slicing: Accessing Subarrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reshaping-of-arrays">Reshaping of Arrays</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#computation-on-numpy-arrays-universal-functions">Computation on NumPy Arrays: Universal Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-slowness-of-loops">The Slowness of Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#introducing-ufuncs">Introducing UFuncs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#aggregations-min-max-and-everything-in-between">Aggregations: Min, Max, and Everything In Between</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#summing-the-values-in-an-array">Summing the Values in an Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="#minimum-and-maximum">Minimum and Maximum</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#computation-on-arrays-broadcasting">Computation on Arrays: Broadcasting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introducing-broadcasting">Introducing Broadcasting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rules-of-broadcasting">Rules of Broadcasting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#comparisons-masks-and-boolean-logic">Comparisons, Masks, and Boolean Logic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#comparison-operators-as-ufuncs">Comparison Operators as ufuncs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#boolean-arrays-as-masks">Boolean Arrays as Masks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#fancy-indexing">Fancy Indexing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#combined-indexing">Combined Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-selecting-random-points">Example: Selecting Random Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modifying-values-with-fancy-indexing">Modifying Values with Fancy Indexing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-binning-data">Example: Binning Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sorting-arrays">Sorting Arrays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fast-sorting-in-numpy-np-sort-and-np-argsort">Fast Sorting in NumPy: <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#partial-sorts-partitioning">Partial Sorts: Partitioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-k-nearest-neighbors">Example: k-Nearest Neighbors</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pandas.html">pandas module</a></li>
<li class="toctree-l1"><a class="reference internal" href="matplotlib.html">matplotlib module</a></li>
<li class="toctree-l1"><a class="reference internal" href="networkx.html">networkx module</a></li>
<li class="toctree-l1"><a class="reference internal" href="gotchas.html">Tips an’ Tricks</a></li>
<li class="toctree-l1"><a class="reference internal" href="oo.html">Object Orientation</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="exercises.html" title="previous chapter">Exercises</a></li>
      <li>Next: <a href="pandas.html" title="next chapter">pandas module</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="exercises.html" title="Previous document">Exercises</a>
        </li>
        <li>
          <a href="pandas.html" title="Next document">pandas module</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <div class="section" id="numpy-module">
<h1>numpy module<a class="headerlink" href="#numpy-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-numpy">
<h2>Introduction to NumPy<a class="headerlink" href="#introduction-to-numpy" title="Permalink to this headline">¶</a></h2>
<p>The topic is very broad: datasets can come from a wide range of sources
and a wide range of formats, including be collections of documents,
collections of images, collections of sound clips, collections of
numerical measurements, or nearly anything else. Despite this apparent
heterogeneity, it will help us to think of all data fundamentally as
arrays of numbers.</p>
<p>For this reason, efficient storage and manipulation of numerical arrays
is absolutely fundamental to the process of doing data science.</p>
<p>NumPy (short for <em>Numerical Python</em>) provides an efficient interface to
store and operate on dense data buffers. In some ways, NumPy arrays are
like Python’s built-in <code class="docutils literal notranslate"><span class="pre">list</span></code> type, but NumPy arrays provide much more
efficient storage and data operations as the arrays grow larger in size.
NumPy arrays form the core of nearly the entire ecosystem of data
science tools in Python, so time spent learning to use NumPy effectively
will be valuable no matter what aspect of data science interests you.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy
numpy.__version__
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;1.19.5&#39;</span>
</pre></div>
</div>
<p>By convention, you’ll find that most people in the SciPy/PyData world
will import NumPy using <code class="docutils literal notranslate"><span class="pre">np</span></code> as an alias:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
</pre></div>
</div>
<p>Throughout this chapter, and indeed the rest of the book, you’ll find
that this is the way we will import and use NumPy.</p>
</div>
<div class="section" id="understanding-data-types-in-python">
<h2>Understanding Data Types in Python<a class="headerlink" href="#understanding-data-types-in-python" title="Permalink to this headline">¶</a></h2>
<p>Effective data-driven science and computation requires understanding how
data is stored and manipulated.</p>
<p>Here we outlines and contrasts how arrays of data are handled in the
Python language itself, and how NumPy improves on this.</p>
<p>Python offers several different options for storing data in efficient,
fixed-type data buffers. The built-in <code class="docutils literal notranslate"><span class="pre">array</span></code> module (available since
Python 3.3) can be used to create dense arrays of a uniform type:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import array
L = list(range(10))
A = array.array(&#39;i&#39;, L)
A
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>type(A)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="o">.</span><span class="n">array</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[x ** 2 for x in range(10)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>type(_)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">'i'</span></code> is a type code indicating the contents are integers.</p>
<p>Much more useful, however, is the <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> object of the NumPy
package. While Python’s <code class="docutils literal notranslate"><span class="pre">array</span></code> object provides efficient storage of
array-based data, NumPy adds to this efficient <em>operations</em> on that
data.</p>
<div class="section" id="creating-arrays-from-python-lists">
<h3>Creating Arrays from Python Lists<a class="headerlink" href="#creating-arrays-from-python-lists" title="Permalink to this headline">¶</a></h3>
<p>First, we can use <code class="docutils literal notranslate"><span class="pre">np.array</span></code> to create arrays from Python lists:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.array([1, 4, 2, 5, 3])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Remember that unlike Python lists, NumPy is constrained to arrays that
all contain the same type. If types do not match, NumPy will upcast if
possible (here, integers are up-cast to floating point):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.array([3.14, 4, 2, 3])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">4.</span>  <span class="p">,</span> <span class="mf">2.</span>  <span class="p">,</span> <span class="mf">3.</span>  <span class="p">])</span>
</pre></div>
</div>
<p>If we want to explicitly set the data type of the resulting array, we
can use the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.array([1, 2, 3, 4], dtype=&#39;float32&#39;)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-arrays-from-scratch">
<h3>Creating Arrays from Scratch<a class="headerlink" href="#creating-arrays-from-scratch" title="Permalink to this headline">¶</a></h3>
<p>Especially for larger arrays, it is more efficient to create arrays from
scratch using routines built into NumPy:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.zeros(10, dtype=int)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.ones((3, 5), dtype=float)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.full((3, 5), 3.14)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.arange(0, 20, 2)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.linspace(0, 1, 5)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span>  <span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span> <span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.</span>  <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.random((3, 3))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">0.49760049</span><span class="p">,</span> <span class="mf">0.67705904</span><span class="p">,</span> <span class="mf">0.59093804</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.99268699</span><span class="p">,</span> <span class="mf">0.42792808</span><span class="p">,</span> <span class="mf">0.8336333</span> <span class="p">],</span>
       <span class="p">[</span><span class="mf">0.44928886</span><span class="p">,</span> <span class="mf">0.70924885</span><span class="p">,</span> <span class="mf">0.1681015</span> <span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.normal(0, 1, (3, 3))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.84044642</span><span class="p">,</span>  <span class="mf">1.54753956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.023514</span>  <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.09749938</span><span class="p">,</span>  <span class="mf">0.70455525</span><span class="p">,</span>  <span class="mf">0.57204258</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.47691043</span><span class="p">,</span>  <span class="mf">0.89482679</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.07735954</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.eye(3)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="numpy-standard-data-types">
<h3>NumPy Standard Data Types<a class="headerlink" href="#numpy-standard-data-types" title="Permalink to this headline">¶</a></h3>
<p>NumPy arrays contain values of a single type, so have a look at those
types and their bounds:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bool_</span></code></p></td>
<td><p>Boolean (True or False) stored
as a byte</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int_</span></code></p></td>
<td><p>Default integer type (same as
C <code class="docutils literal notranslate"><span class="pre">long</span></code>; normally either
<code class="docutils literal notranslate"><span class="pre">int64</span></code> or <code class="docutils literal notranslate"><span class="pre">int32</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">intc</span></code></p></td>
<td><p>Identical to C <code class="docutils literal notranslate"><span class="pre">int</span></code>
(normally <code class="docutils literal notranslate"><span class="pre">int32</span></code> or
<code class="docutils literal notranslate"><span class="pre">int64</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">intp</span></code></p></td>
<td><p>Integer used for indexing
(same as C <code class="docutils literal notranslate"><span class="pre">ssize_t</span></code>;
normally either <code class="docutils literal notranslate"><span class="pre">int32</span></code> or
<code class="docutils literal notranslate"><span class="pre">int64</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int8</span></code></p></td>
<td><p>Byte (-128 to 127)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int16</span></code></p></td>
<td><p>Integer (-32768 to 32767)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int32</span></code></p></td>
<td><p>Integer (-2147483648 to
2147483647)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int64</span></code></p></td>
<td><p>Integer (-9223372036854775808
to 9223372036854775807)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></td>
<td><p>Unsigned integer (0 to 255)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint16</span></code></p></td>
<td><p>Unsigned integer (0 to 65535)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint32</span></code></p></td>
<td><p>Unsigned integer (0 to
4294967295)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint64</span></code></p></td>
<td><p>Unsigned integer (0 to
18446744073709551615)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float_</span></code></p></td>
<td><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float16</span></code></p></td>
<td><p>Half precision float: sign
bit, 5 bits exponent, 10 bits
mantissa</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
<td><p>Single precision float: sign
bit, 8 bits exponent, 23 bits
mantissa</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
<td><p>Double precision float: sign
bit, 11 bits exponent, 52 bits
mantissa</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex_</span></code></p></td>
<td><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">complex128</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p>Complex number, represented by
two 32-bit floats</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p>Complex number, represented by
two 64-bit floats</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="intermezzo">
<h3>INTERMEZZO<a class="headerlink" href="#intermezzo" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[x**4 for i, x in enumerate(range(10, 0, -1))]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">6561</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">2401</span><span class="p">,</span> <span class="mi">1296</span><span class="p">,</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">6561</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">2401</span><span class="p">,</span> <span class="mi">1296</span><span class="p">,</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[ _**4 for (x, _, _) in [(1, 2, 3), (2, 3, 4)]]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">81</span><span class="p">,</span> <span class="mi">256</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[ tuple([x**4, y**3]) for (x, y, _) in [(1, 2, 3), (2, 3, 4)]]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">27</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a = (2, 3, 4)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a.append(5)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">AttributeError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">80</span><span class="n">c7c94d949c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>


<span class="ne">AttributeError</span><span class="p">:</span> <span class="s1">&#39;tuple&#39;</span> <span class="nb">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="s1">&#39;append&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>b = a + (5,)
b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>assert a != b
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>(1,2,3), [1, 2, 3]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>tuple(range(100))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>
 <span class="mi">1</span><span class="p">,</span>
 <span class="mi">2</span><span class="p">,</span>
 <span class="mi">3</span><span class="p">,</span>
 <span class="mi">4</span><span class="p">,</span>
 <span class="mi">5</span><span class="p">,</span>
 <span class="mi">6</span><span class="p">,</span>
 <span class="mi">7</span><span class="p">,</span>
 <span class="mi">8</span><span class="p">,</span>
 <span class="mi">9</span><span class="p">,</span>
 <span class="mi">10</span><span class="p">,</span>
 <span class="mi">11</span><span class="p">,</span>
 <span class="mi">12</span><span class="p">,</span>
 <span class="mi">13</span><span class="p">,</span>
 <span class="mi">14</span><span class="p">,</span>
 <span class="mi">15</span><span class="p">,</span>
 <span class="mi">16</span><span class="p">,</span>
 <span class="mi">17</span><span class="p">,</span>
 <span class="mi">18</span><span class="p">,</span>
 <span class="mi">19</span><span class="p">,</span>
 <span class="mi">20</span><span class="p">,</span>
 <span class="mi">21</span><span class="p">,</span>
 <span class="mi">22</span><span class="p">,</span>
 <span class="mi">23</span><span class="p">,</span>
 <span class="mi">24</span><span class="p">,</span>
 <span class="mi">25</span><span class="p">,</span>
 <span class="mi">26</span><span class="p">,</span>
 <span class="mi">27</span><span class="p">,</span>
 <span class="mi">28</span><span class="p">,</span>
 <span class="mi">29</span><span class="p">,</span>
 <span class="mi">30</span><span class="p">,</span>
 <span class="mi">31</span><span class="p">,</span>
 <span class="mi">32</span><span class="p">,</span>
 <span class="mi">33</span><span class="p">,</span>
 <span class="mi">34</span><span class="p">,</span>
 <span class="mi">35</span><span class="p">,</span>
 <span class="mi">36</span><span class="p">,</span>
 <span class="mi">37</span><span class="p">,</span>
 <span class="mi">38</span><span class="p">,</span>
 <span class="mi">39</span><span class="p">,</span>
 <span class="mi">40</span><span class="p">,</span>
 <span class="mi">41</span><span class="p">,</span>
 <span class="mi">42</span><span class="p">,</span>
 <span class="mi">43</span><span class="p">,</span>
 <span class="mi">44</span><span class="p">,</span>
 <span class="mi">45</span><span class="p">,</span>
 <span class="mi">46</span><span class="p">,</span>
 <span class="mi">47</span><span class="p">,</span>
 <span class="mi">48</span><span class="p">,</span>
 <span class="mi">49</span><span class="p">,</span>
 <span class="mi">50</span><span class="p">,</span>
 <span class="mi">51</span><span class="p">,</span>
 <span class="mi">52</span><span class="p">,</span>
 <span class="mi">53</span><span class="p">,</span>
 <span class="mi">54</span><span class="p">,</span>
 <span class="mi">55</span><span class="p">,</span>
 <span class="mi">56</span><span class="p">,</span>
 <span class="mi">57</span><span class="p">,</span>
 <span class="mi">58</span><span class="p">,</span>
 <span class="mi">59</span><span class="p">,</span>
 <span class="mi">60</span><span class="p">,</span>
 <span class="mi">61</span><span class="p">,</span>
 <span class="mi">62</span><span class="p">,</span>
 <span class="mi">63</span><span class="p">,</span>
 <span class="mi">64</span><span class="p">,</span>
 <span class="mi">65</span><span class="p">,</span>
 <span class="mi">66</span><span class="p">,</span>
 <span class="mi">67</span><span class="p">,</span>
 <span class="mi">68</span><span class="p">,</span>
 <span class="mi">69</span><span class="p">,</span>
 <span class="mi">70</span><span class="p">,</span>
 <span class="mi">71</span><span class="p">,</span>
 <span class="mi">72</span><span class="p">,</span>
 <span class="mi">73</span><span class="p">,</span>
 <span class="mi">74</span><span class="p">,</span>
 <span class="mi">75</span><span class="p">,</span>
 <span class="mi">76</span><span class="p">,</span>
 <span class="mi">77</span><span class="p">,</span>
 <span class="mi">78</span><span class="p">,</span>
 <span class="mi">79</span><span class="p">,</span>
 <span class="mi">80</span><span class="p">,</span>
 <span class="mi">81</span><span class="p">,</span>
 <span class="mi">82</span><span class="p">,</span>
 <span class="mi">83</span><span class="p">,</span>
 <span class="mi">84</span><span class="p">,</span>
 <span class="mi">85</span><span class="p">,</span>
 <span class="mi">86</span><span class="p">,</span>
 <span class="mi">87</span><span class="p">,</span>
 <span class="mi">88</span><span class="p">,</span>
 <span class="mi">89</span><span class="p">,</span>
 <span class="mi">90</span><span class="p">,</span>
 <span class="mi">91</span><span class="p">,</span>
 <span class="mi">92</span><span class="p">,</span>
 <span class="mi">93</span><span class="p">,</span>
 <span class="mi">94</span><span class="p">,</span>
 <span class="mi">95</span><span class="p">,</span>
 <span class="mi">96</span><span class="p">,</span>
 <span class="mi">97</span><span class="p">,</span>
 <span class="mi">98</span><span class="p">,</span>
 <span class="mi">99</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def A(a, b=0, c=1):
    return a+b+c
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>A(1, 2,)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>{1, 2, 23,}
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">23</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>L = [
    &#39;/my/path/to/an/interesting/file0&#39;,
    &#39;/my/path/to/an/interesting/file1&#39;,
    &#39;/my/path/to/an/interesting/file2&#39;,
    &#39;/my/path/to/an/interesting/file3&#39;,
    &#39;/my/path/to/an/interesting/file4&#39;,
    &#39;/my/path/to/an/interesting/file5&#39;,
]
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>L
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/my/path/to/an/interesting/file0&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/my/path/to/an/interesting/file1&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/my/path/to/an/interesting/file2&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/my/path/to/an/interesting/file3&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/my/path/to/an/interesting/file4&#39;</span><span class="p">,</span>
 <span class="s1">&#39;/my/path/to/an/interesting/file5&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[object(), 3, 3.14, &#39;hello world&#39;]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7fd9f964d760</span><span class="o">&gt;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="s1">&#39;hello world&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="the-basics-of-numpy-arrays">
<h2>The Basics of NumPy Arrays<a class="headerlink" href="#the-basics-of-numpy-arrays" title="Permalink to this headline">¶</a></h2>
<p>Data manipulation in Python is nearly synonymous with NumPy array
manipulation: even newer tools like Pandas are built around the NumPy
array.</p>
<ul class="simple">
<li><p><em>Attributes of arrays</em>: Determining the size, shape, memory
consumption, and data types of arrays</p></li>
<li><p><em>Indexing of arrays</em>: Getting and setting the value of individual
array elements</p></li>
<li><p><em>Slicing of arrays</em>: Getting and setting smaller subarrays within a
larger array</p></li>
<li><p><em>Reshaping of arrays</em>: Changing the shape of a given array</p></li>
<li><p><em>Joining and splitting of arrays</em>: Combining multiple arrays into
one, and splitting one array into many</p></li>
<li><p><em>Universal functions and broadcasting</em></p></li>
</ul>
<div class="section" id="numpy-array-attributes">
<h3>NumPy Array Attributes<a class="headerlink" href="#numpy-array-attributes" title="Permalink to this headline">¶</a></h3>
<p>First let’s discuss some useful array attributes. We’ll start by
defining three random arrays, a one-dimensional, two-dimensional, and
three-dimensional array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.seed(0)  # seed for reproducibility

x1 = np.random.randint(10, size=6)  # One-dimensional array
x2 = np.random.randint(10, size=(3, 4))  # Two-dimensional array
x3 = np.random.randint(10, size=(3, 4, 5))  # Three-dimensional array
</pre></div>
</div>
<p>Each array has attributes <code class="docutils literal notranslate"><span class="pre">ndim</span></code> (the number of dimensions), <code class="docutils literal notranslate"><span class="pre">shape</span></code>
(the size of each dimension), <code class="docutils literal notranslate"><span class="pre">size</span></code> (the total size of the array) and
<code class="docutils literal notranslate"><span class="pre">dtype</span></code> (the data type of the array):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;x3 ndim: &quot;, x3.ndim)
print(&quot;x3 shape:&quot;, x3.shape)
print(&quot;x3 size: &quot;, x3.size)
print(&quot;dtype:&quot;, x3.dtype)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x3</span> <span class="n">ndim</span><span class="p">:</span>  <span class="mi">3</span>
<span class="n">x3</span> <span class="n">shape</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">x3</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">60</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="array-indexing-accessing-single-elements">
<h3>Array Indexing: Accessing Single Elements<a class="headerlink" href="#array-indexing-accessing-single-elements" title="Permalink to this headline">¶</a></h3>
<p>In a one-dimensional array, the <span class="math notranslate nohighlight">\(i^{th}\)</span> value (counting from
zero) can be accessed by specifying the desired index in square
brackets, just as with Python lists:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x1
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x1[0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x1[-1] # To index from the end of the array, you can use negative indices.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span>
</pre></div>
</div>
<p>In a multi-dimensional array, items can be accessed using a
comma-separated tuple of indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[0, 0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[2, -1]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
<p>Values can also be modified using any of the above index notation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[0, 0] = 12
x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p>Keep in mind that, unlike Python lists, NumPy arrays have a fixed type.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x1[0] = 3.14159  # this will be truncated!
x1
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="array-slicing-accessing-subarrays">
<h3>Array Slicing: Accessing Subarrays<a class="headerlink" href="#array-slicing-accessing-subarrays" title="Permalink to this headline">¶</a></h3>
<p>Just as we can use square brackets to access individual array elements,
we can also use them to access subarrays with the <em>slice</em> notation,
marked by the colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) character.</p>
<p>The NumPy slicing syntax follows that of the standard Python list; to
access a slice of an array <code class="docutils literal notranslate"><span class="pre">x</span></code>, use this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">:</span><span class="n">step</span><span class="p">]</span>
</pre></div>
</div>
<p>If any of these are unspecified, they default to the values <code class="docutils literal notranslate"><span class="pre">start=0</span></code>,
<code class="docutils literal notranslate"><span class="pre">stop=</span></code><em>``size of dimension``</em>, <code class="docutils literal notranslate"><span class="pre">step=1</span></code>.</p>
<div class="section" id="one-dimensional-subarrays">
<h4>One-dimensional subarrays<a class="headerlink" href="#one-dimensional-subarrays" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(10)
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[:5]  # first five elements
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[5:]  # elements after index 5
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[4:7]  # middle sub-array
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[::2]  # every other element
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[1::2]  # every other element, starting at index 1
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>A potentially confusing case is when the <code class="docutils literal notranslate"><span class="pre">step</span></code> value is negative. In
this case, the defaults for <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code> are swapped. This
becomes a convenient way to reverse an array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[::-1]  # all elements, reversed
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[5::-2]  # reversed every other from index 5
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-dimensional-subarrays">
<h4>Multi-dimensional subarrays<a class="headerlink" href="#multi-dimensional-subarrays" title="Permalink to this headline">¶</a></h4>
<p>Multi-dimensional slices work in the same way, with multiple slices
separated by commas:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[:2, :3]  # two rows, three columns
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[:3, ::2]  # all rows, every other column
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2[::-1, ::-1]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="accessing-array-rows-and-columns">
<h5>Accessing array rows and columns<a class="headerlink" href="#accessing-array-rows-and-columns" title="Permalink to this headline">¶</a></h5>
<p>One commonly needed routine is accessing of single rows or columns of an
array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(x2[:, 0])  # first column of x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">7</span>  <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(x2[0, :])  # first row of x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(x2[0])  # equivalent to x2[0, :]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subarrays-as-no-copy-views">
<h4>Subarrays as no-copy views<a class="headerlink" href="#subarrays-as-no-copy-views" title="Permalink to this headline">¶</a></h4>
<p>One important–and extremely useful–thing to know about array slices is
that they return <em>views</em> rather than <em>copies</em> of the array data.</p>
<p>This is one area in which NumPy array slicing differs from Python list
slicing: in lists, slices will be copies.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2_sub = x2[:2, :2]
x2_sub
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x2_sub[0, 0] = 99 # if we modify this subarray, the original array is changed too
x2
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">99</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p>It is sometimes useful to instead explicitly copy the data within an
array or a subarray. This can be most easily done with the <code class="docutils literal notranslate"><span class="pre">copy()</span></code>
method.</p>
</div>
</div>
<div class="section" id="reshaping-of-arrays">
<h3>Reshaping of Arrays<a class="headerlink" href="#reshaping-of-arrays" title="Permalink to this headline">¶</a></h3>
<p>If you want to put the numbers 1 through 9 in a <span class="math notranslate nohighlight">\(3 \times 3\)</span> grid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.arange(1, 10)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">9</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>__.reshape((3, 3))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([1, 2, 3])
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.reshape((1, 3)) # row vector via reshape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.shape # therefore `reshape` doesn&#39;t modify in place the array we are working on
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[np.newaxis, :] # row vector via newaxis
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.reshape((3, 1)) # column vector via reshape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[:, np.newaxis] # column vector via newaxis
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>_.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
</pre></div>
</div>
<div class="section" id="concatenation-of-arrays">
<h4>Concatenation of arrays<a class="headerlink" href="#concatenation-of-arrays" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> takes a tuple or list of arrays as its first
argument:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([1, 2, 3])
y = np.array([3, 2, 1])
np.concatenate([x, y])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>z = [99, 99, 99]
np.concatenate([x, y, z])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>grid = np.array([[1, 2, 3],
                 [4, 5, 6]])
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.concatenate([grid, grid]) # concatenate along the first axis
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.concatenate([grid, grid], axis=1) # concatenate along the second axis (zero-indexed)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>For working with arrays of mixed dimensions, it can be clearer to use
the <code class="docutils literal notranslate"><span class="pre">np.vstack</span></code> (vertical stack) and <code class="docutils literal notranslate"><span class="pre">np.hstack</span></code> (horizontal stack)
functions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([1, 2, 3])
grid = np.array([[9, 8, 7],
                 [6, 5, 4]])

np.vstack([x, grid]) # vertically stack the arrays
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>y = np.array([[99],
              [99]])
np.hstack([grid, y]) # horizontally stack the arrays
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">99</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="splitting-of-arrays">
<h4>Splitting of arrays<a class="headerlink" href="#splitting-of-arrays" title="Permalink to this headline">¶</a></h4>
<p>The opposite of concatenation is splitting, we can pass a list of
indices giving the split points:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = [1, 2, 3, 99, 99, 3, 2, 1]
x1, x2, x3 = np.split(x, [3, 5])
print(x1, x2, x3)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">99</span><span class="p">]</span> <span class="p">[</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>grid = np.arange(16).reshape((4, 4))
grid
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.vsplit(grid, [2])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]),</span>
 <span class="n">array</span><span class="p">([[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.hsplit(grid, [2])
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]]),</span>
 <span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-on-numpy-arrays-universal-functions">
<h2>Computation on NumPy Arrays: Universal Functions<a class="headerlink" href="#computation-on-numpy-arrays-universal-functions" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Numpy</span></code> provides an easy and flexible interface to optimized
computation with arrays of data.</p>
<p>The key to making it fast is to use <em>vectorized</em> operations, generally
implemented through NumPy’s <em>universal functions</em> (ufuncs).</p>
<div class="section" id="the-slowness-of-loops">
<h3>The Slowness of Loops<a class="headerlink" href="#the-slowness-of-loops" title="Permalink to this headline">¶</a></h3>
<p>Python’s default implementation (known as CPython) does some operations
very slowly, this is in part due to the dynamic, interpreted nature of
the language.</p>
<p>The relative sluggishness of Python generally manifests itself in
situations where many small operations are being repeated – for instance
looping over arrays to operate on each element.</p>
<p>For example, pretend to compute the reciprocal of values contained in a
array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.seed(0)

def compute_reciprocals(values):
    output = np.empty(len(values))
    for i in range(len(values)):
        output[i] = 1.0 / values[i]
    return output

values = np.random.randint(1, 10, size=5)
compute_reciprocals(values)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.16666667</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">0.125</span>     <span class="p">])</span>
</pre></div>
</div>
<p>If we measure the execution time of this code for a large input, we see
that this operation is very slow, perhaps surprisingly so!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>big_array = np.random.randint(1, 100, size=1000000)
%timeit compute_reciprocals(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.63 s ± 29.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
<p>It takes <span class="math notranslate nohighlight">\(2.63\)</span> seconds to compute these million operations and to
store the result.</p>
<p>It turns out that the bottleneck here is not the operations themselves,
but the type-checking and function dispatches that CPython must do at
each cycle of the loop.</p>
<p>If we were working in compiled code instead, this type specification
would be known before the code executes and the result could be computed
much more efficiently.</p>
</div>
<div class="section" id="introducing-ufuncs">
<h3>Introducing UFuncs<a class="headerlink" href="#introducing-ufuncs" title="Permalink to this headline">¶</a></h3>
<p>For many types of operations, NumPy provides a convenient interface into
just this kind of compiled routine.</p>
<p>This is known as a <em>vectorized</em> operation.</p>
<p>This can be accomplished by performing an operation on the array, which
will then be applied to each element.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%timeit (1.0 / big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.97 ms ± 35.3 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>Vectorized operations in NumPy are implemented via <em>ufuncs</em>, whose main
purpose is to quickly execute repeated operations on values in NumPy
arrays.</p>
<p>Ufuncs are extremely flexible – before we saw an operation between a
scalar and an array, but we can also operate between two arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.arange(5) / np.arange(1, 6)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.5</span>       <span class="p">,</span> <span class="mf">0.66666667</span><span class="p">,</span> <span class="mf">0.75</span>      <span class="p">,</span> <span class="mf">0.8</span>       <span class="p">])</span>
</pre></div>
</div>
<p>And ufunc operations are not limited to one-dimensional arrays–they can
also act on multi-dimensional arrays as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(9).reshape((3, 3))
2 ** x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>   <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">16</span><span class="p">,</span>  <span class="mi">32</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">]])</span>
</pre></div>
</div>
<p><em>Any time you see such a loop in a Python script, you should consider
whether it can be replaced with a vectorized expression.</em></p>
<div class="section" id="array-arithmetic">
<h4>Array arithmetic<a class="headerlink" href="#array-arithmetic" title="Permalink to this headline">¶</a></h4>
<p>NumPy’s ufuncs feel very natural to use because they make use of
Python’s native arithmetic operators:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(4)
print(&quot;x     =&quot;, x)
print(&quot;x + 5 =&quot;, x + 5)
print(&quot;x - 5 =&quot;, x - 5)
print(&quot;x * 2 =&quot;, x * 2)
print(&quot;x / 2 =&quot;, x / 2)
print(&quot;x // 2 =&quot;, x // 2)  # floor division
print(&quot;-x     = &quot;, -x)
print(&quot;x ** 2 = &quot;, x ** 2)
print(&quot;x % 2  = &quot;, x % 2)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">x</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">x</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>  <span class="mf">0.5</span> <span class="mf">1.</span>  <span class="mf">1.5</span><span class="p">]</span>
<span class="n">x</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">-</span><span class="n">x</span>     <span class="o">=</span>  <span class="p">[</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">x</span> <span class="o">%</span> <span class="mi">2</span>  <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>-(0.5*x + 1) ** 2 # can be strung together also
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">6.25</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="trigonometric-functions">
<h4>Trigonometric functions<a class="headerlink" href="#trigonometric-functions" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code> provides a large number of useful ufuncs, we’ll start by
defining an array of angles:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>theta = np.linspace(0, np.pi, 3)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;theta      = &quot;, theta)
print(&quot;sin(theta) = &quot;, np.sin(theta))
print(&quot;cos(theta) = &quot;, np.cos(theta))
print(&quot;tan(theta) = &quot;, np.tan(theta))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span>      <span class="o">=</span>  <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.57079633</span> <span class="mf">3.14159265</span><span class="p">]</span>
<span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0000000e+00</span> <span class="mf">1.0000000e+00</span> <span class="mf">1.2246468e-16</span><span class="p">]</span>
<span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span> <span class="mf">1.000000e+00</span>  <span class="mf">6.123234e-17</span> <span class="o">-</span><span class="mf">1.000000e+00</span><span class="p">]</span>
<span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span> <span class="mf">0.00000000e+00</span>  <span class="mf">1.63312394e+16</span> <span class="o">-</span><span class="mf">1.22464680e-16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="exponents-and-logarithms">
<h4>Exponents and logarithms<a class="headerlink" href="#exponents-and-logarithms" title="Permalink to this headline">¶</a></h4>
<p>Another common <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> ufunc are the exponentials (that are useful for
maintaining precision with very small inputs)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = [1, 2, 3]
print(&quot;x     =&quot;, x)
print(&quot;e^x   =&quot;, np.exp(x))
print(&quot;2^x   =&quot;, np.exp2(x))
print(&quot;3^x   =&quot;, np.power(3, x))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">e</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span> <span class="mf">2.71828183</span>  <span class="mf">7.3890561</span>  <span class="mf">20.08553692</span><span class="p">]</span>
<span class="mi">2</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">2.</span> <span class="mf">4.</span> <span class="mf">8.</span><span class="p">]</span>
<span class="mi">3</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span> <span class="mi">3</span>  <span class="mi">9</span> <span class="mi">27</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = [1, 2, 4, 10]
print(&quot;x        =&quot;, x)
print(&quot;ln(x)    =&quot;, np.log(x))
print(&quot;log2(x)  =&quot;, np.log2(x))
print(&quot;log10(x) =&quot;, np.log10(x))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>        <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">0.69314718</span> <span class="mf">1.38629436</span> <span class="mf">2.30258509</span><span class="p">]</span>
<span class="n">log2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.</span>         <span class="mf">2.</span>         <span class="mf">3.32192809</span><span class="p">]</span>
<span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">0.30103</span>    <span class="mf">0.60205999</span> <span class="mf">1.</span>        <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-output">
<h4>Specifying output<a class="headerlink" href="#specifying-output" title="Permalink to this headline">¶</a></h4>
<p>For large calculations, it is sometimes useful to be able to specify the
array where the result of the calculation will be stored:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(5)
y = np.empty(5)
np.multiply(x, 10, out=y)
print(y)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">0.</span> <span class="mf">10.</span> <span class="mf">20.</span> <span class="mf">30.</span> <span class="mf">40.</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>y = np.zeros(10)
np.power(2, x, out=y[::2])
print(y)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">1.</span>  <span class="mf">0.</span>  <span class="mf">2.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">8.</span>  <span class="mf">0.</span> <span class="mf">16.</span>  <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="outer-products">
<h4>Outer products<a class="headerlink" href="#outer-products" title="Permalink to this headline">¶</a></h4>
<p>Finally, any ufunc can compute the output of all pairs of two different
inputs using the <code class="docutils literal notranslate"><span class="pre">outer</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(1, 6)
np.multiply.outer(x, x)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="aggregations-min-max-and-everything-in-between">
<h2>Aggregations: Min, Max, and Everything In Between<a class="headerlink" href="#aggregations-min-max-and-everything-in-between" title="Permalink to this headline">¶</a></h2>
<div class="section" id="summing-the-values-in-an-array">
<h3>Summing the Values in an Array<a class="headerlink" href="#summing-the-values-in-an-array" title="Permalink to this headline">¶</a></h3>
<p>As a quick example, consider computing the sum of all values in an
array. Python itself can do this using the built-in <code class="docutils literal notranslate"><span class="pre">sum</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>L = np.random.random(100)
sum(L)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">54.43983466916921</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.sum(L)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">54.439834669169194</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>big_array = np.random.rand(1_000_000)
%timeit sum(big_array)
%timeit np.sum(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>222 ms ± 6.88 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
791 µs ± 7.3 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
<div class="section" id="minimum-and-maximum">
<h3>Minimum and Maximum<a class="headerlink" href="#minimum-and-maximum" title="Permalink to this headline">¶</a></h3>
<p>Similarly, Python has built-in <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> functions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>min(big_array), max(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.min(big_array), np.max(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%timeit min(big_array)
%timeit np.min(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>118 ms ± 1.78 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
656 µs ± 8 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>big_array.min(), big_array.max(), big_array.sum()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">,</span> <span class="mf">500216.8034810001</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="multi-dimensional-aggregates">
<h4>Multi dimensional aggregates<a class="headerlink" href="#multi-dimensional-aggregates" title="Permalink to this headline">¶</a></h4>
<p>One common type of aggregation operation is an aggregate along a row or
column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M = np.random.random((3, 4))
M
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">0.07452786</span><span class="p">,</span> <span class="mf">0.41843762</span><span class="p">,</span> <span class="mf">0.99939192</span><span class="p">,</span> <span class="mf">0.66974416</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.54717434</span><span class="p">,</span> <span class="mf">0.82711104</span><span class="p">,</span> <span class="mf">0.23097044</span><span class="p">,</span> <span class="mf">0.16283152</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.27950484</span><span class="p">,</span> <span class="mf">0.58540569</span><span class="p">,</span> <span class="mf">0.90657413</span><span class="p">,</span> <span class="mf">0.18671025</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M.sum() # By default, each NumPy aggregation function works on the whole array
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">5.888383818472106</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M.min(axis=0) # specifying the axis along which the aggregate is computed
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.07452786</span><span class="p">,</span> <span class="mf">0.41843762</span><span class="p">,</span> <span class="mf">0.23097044</span><span class="p">,</span> <span class="mf">0.16283152</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M.max(axis=1) # find the maximum value within each row
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.99939192</span><span class="p">,</span> <span class="mf">0.82711104</span><span class="p">,</span> <span class="mf">0.90657413</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="other-aggregation-functions">
<h4>Other aggregation functions<a class="headerlink" href="#other-aggregation-functions" title="Permalink to this headline">¶</a></h4>
<p>Additionally, most aggregates have a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>-safe counterpart that
computes the result while ignoring missing values, which are marked by
the special IEEE floating-point <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 24%" />
<col style="width: 55%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function
Name</p></th>
<th class="head"><p>NaN-safe
Version</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.sum</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nansum</span></code></p></td>
<td><p>Compute sum of elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.prod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanprod</span></code></p></td>
<td><p>Compute product of elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.mean</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmean</span></code></p></td>
<td><p>Compute mean of elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.std</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanstd</span></code></p></td>
<td><p>Compute standard deviation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.var</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanvar</span></code></p></td>
<td><p>Compute variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.min</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmin</span></code></p></td>
<td><p>Find minimum value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.max</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmax</span></code></p></td>
<td><p>Find maximum value</p></td>
</tr>
<tr class="row-odd"><td><p>`
<cite>np.argmin`</cite></p></td>
<td><p>``
np.nanargmin``</p></td>
<td><p>Find index of minimum value</p></td>
</tr>
<tr class="row-even"><td><p>`
<cite>np.argmax`</cite></p></td>
<td><p>``
np.nanargmax``</p></td>
<td><p>Find index of maximum value</p></td>
</tr>
<tr class="row-odd"><td><p>`
<cite>np.median`</cite></p></td>
<td><p>``
np.nanmedian``</p></td>
<td><p>Compute median of elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.</span>
<span class="pre">percentile</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.n</span>
<span class="pre">anpercentile</span></code></p></td>
<td><p>Compute rank-based statistics of
elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.any</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Evaluate whether any elements are
true</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.all</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Evaluate whether all elements are
true</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="computation-on-arrays-broadcasting">
<h2>Computation on Arrays: Broadcasting<a class="headerlink" href="#computation-on-arrays-broadcasting" title="Permalink to this headline">¶</a></h2>
<p>Another means of vectorizing operations is to use NumPy’s <em>broadcasting</em>
functionality.</p>
<p>Broadcasting is simply a set of rules for applying binary ufuncs (e.g.,
addition, subtraction, multiplication, etc.) on arrays of different
sizes.</p>
<div class="section" id="introducing-broadcasting">
<h3>Introducing Broadcasting<a class="headerlink" href="#introducing-broadcasting" title="Permalink to this headline">¶</a></h3>
<p>Recall that for arrays of the same size, binary operations are performed
on an element-by-element basis:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a = np.array([0, 1, 2])
b = np.array([5, 5, 5])
a + b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>Broadcasting allows these types of binary operations to be performed on
arrays of different sizes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a + 5
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>We can think of this as an operation that stretches or duplicates the
value <code class="docutils literal notranslate"><span class="pre">5</span></code> into the array <code class="docutils literal notranslate"><span class="pre">[5,</span> <span class="pre">5,</span> <span class="pre">5]</span></code>, and adds the results; the
advantage of NumPy’s broadcasting is that this duplication of values
does not actually take place.</p>
<p>We can similarly extend this to arrays of higher dimensions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M = np.ones((3, 3))
M
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>M + a
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]])</span>
</pre></div>
</div>
<p>Here the one-dimensional array <code class="docutils literal notranslate"><span class="pre">a</span></code> is stretched, or broadcast across
the second dimension in order to match the shape of <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p>
<p>More complicated cases can involve broadcasting of both arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a = np.arange(3)
b = np.arange(3)[:, np.newaxis]
a, b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">]]))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>a + b
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="rules-of-broadcasting">
<h3>Rules of Broadcasting<a class="headerlink" href="#rules-of-broadcasting" title="Permalink to this headline">¶</a></h3>
<p>Broadcasting in NumPy follows a strict set of rules to determine the
interaction between the two arrays:</p>
<ul class="simple">
<li><p>Rule 1: If the two arrays differ in their number of dimensions, the
shape of the one with fewer dimensions is <em>padded</em> with ones on its
leading (left) side.</p></li>
<li><p>Rule 2: If the shape of the two arrays does not match in any
dimension, the array with shape equal to 1 in that dimension is
stretched to match the other shape.</p></li>
<li><p>Rule 3: If in any dimension the sizes disagree and neither is equal
to 1, an error is raised.</p></li>
</ul>
<div class="section" id="centering-an-array">
<h4>Centering an array<a class="headerlink" href="#centering-an-array" title="Permalink to this headline">¶</a></h4>
<p>Imagine you have an array of 10 observations, each of which consists of
3 values, we’ll store this in a <span class="math notranslate nohighlight">\(10 \times 3\)</span> array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X = np.random.random((10, 3))
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>Xmean = X.mean(0)
Xmean
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.55965135</span><span class="p">,</span> <span class="mf">0.52179051</span><span class="p">,</span> <span class="mf">0.41008518</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X_centered = X - Xmean
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X_centered.mean(0) # To double-check, we can check that the centered array has near 0 means.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.66133815e-17</span><span class="p">,</span>  <span class="mf">3.33066907e-17</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.77156117e-17</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-a-two-dimensional-function">
<h4>Plotting a two-dimensional function<a class="headerlink" href="#plotting-a-two-dimensional-function" title="Permalink to this headline">¶</a></h4>
<p>One place that broadcasting is very useful is in displaying images based
on two-dimensional functions. If we want to define a function
<span class="math notranslate nohighlight">\(z = f(x, y)\)</span>, broadcasting can be used to compute the function
across the grid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>steps = 500
x = np.linspace(0, 5, steps) # # x and y have 500 steps from 0 to 5
y = np.linspace(0, 5, steps)[:, np.newaxis]
z = np.sin(x) ** 10 + np.cos(10 + y * x) * np.cos(x)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%matplotlib inline
import matplotlib.pyplot as plt
plt.imshow(z, origin=&#39;lower&#39;, extent=[0, 5, 0, 5], cmap=&#39;viridis&#39;)
plt.colorbar();
</pre></div>
</div>
<img alt="_images/numpy_185_0.png" src="_images/numpy_185_0.png" />
</div>
</div>
</div>
<div class="section" id="comparisons-masks-and-boolean-logic">
<h2>Comparisons, Masks, and Boolean Logic<a class="headerlink" href="#comparisons-masks-and-boolean-logic" title="Permalink to this headline">¶</a></h2>
<p>Masking comes up when you want to extract, modify, count, or otherwise
manipulate values in an array based on some criterion: for example, you
might wish to count all values greater than a certain value, or perhaps
remove all outliers that are above some threshold. In NumPy, Boolean
masking is often the most efficient way to accomplish these types of
tasks.</p>
<div class="section" id="comparison-operators-as-ufuncs">
<h3>Comparison Operators as ufuncs<a class="headerlink" href="#comparison-operators-as-ufuncs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([1, 2, 3, 4, 5])
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x &lt; 3  # less than
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x &gt; 3  # greater than
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x != 3  # not equal
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>(2 * x) == (x ** 2)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
<p>Just as in the case of arithmetic ufuncs, these will work on arrays of
any size and shape:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rng = np.random.RandomState(0)
x = rng.randint(10, size=(3, 4))
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x &lt; 6
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="counting-entries">
<h4>Counting entries<a class="headerlink" href="#counting-entries" title="Permalink to this headline">¶</a></h4>
<p>To count the number of <code class="docutils literal notranslate"><span class="pre">True</span></code> entries in a Boolean array,
<code class="docutils literal notranslate"><span class="pre">np.count_nonzero</span></code> is useful:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.count_nonzero(x &lt; 6) # how many values less than 6?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.sum(x &lt; 6)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.sum(x &lt; 6, axis=1) # how many values less than 6 in each row?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.any(x &gt; 8) # are there any values greater than 8?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.any(x &lt; 0) # are there any values less than zero?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.all(x &lt; 10) # are all values less than 10?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.all(x &lt; 8, axis=1) # are all values in each row less than 8?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="boolean-arrays-as-masks">
<h3>Boolean Arrays as Masks<a class="headerlink" href="#boolean-arrays-as-masks" title="Permalink to this headline">¶</a></h3>
<p>A more powerful pattern is to use Boolean arrays as masks, to select
particular subsets of the data themselves:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x &lt; 5
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
       <span class="p">[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[x &lt; 5]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>What is returned is a one-dimensional array filled with all the values
that meet this condition; in other words, all the values in positions at
which the mask array is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</div>
<div class="section" id="fancy-indexing">
<h2>Fancy Indexing<a class="headerlink" href="#fancy-indexing" title="Permalink to this headline">¶</a></h2>
<p>We saw how to access and modify portions of arrays using simple indices
(e.g., <code class="docutils literal notranslate"><span class="pre">arr[0]</span></code>), slices (e.g., <code class="docutils literal notranslate"><span class="pre">arr[:5]</span></code>), and Boolean masks (e.g.,
<code class="docutils literal notranslate"><span class="pre">arr[arr</span> <span class="pre">&gt;</span> <span class="pre">0]</span></code>).</p>
<p>We’ll look at another style of array indexing, known as <em>fancy
indexing</em>, that is like the simple indexing we’ve already seen, but we
pass arrays of indices in place of single scalars.</p>
<p>Fancy indexing is conceptually simple: it means passing an array of
indices to access multiple array elements at once:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rand = np.random.RandomState(42)

x = rand.randint(100, size=10)
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">51</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">74</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>[x[3], x[7], x[2]] # Suppose we want to access three different elements.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ind = [3, 7, 4]
x[ind] # Alternatively, we can pass a single list or array of indices
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
<p>When using fancy indexing, the shape of the result reflects the shape of
the index arrays rather than the shape of the array being indexed:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>ind = np.array([[3, 7],
                [4, 5]])
x[ind]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">20</span><span class="p">]])</span>
</pre></div>
</div>
<p>Fancy indexing also works in multiple dimensions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X = np.arange(12).reshape((3, 4))
X
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>Like with standard indexing, the first index refers to the row, and the
second to the column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>row = np.array([0, 1, 2])
col = np.array([2, 1, 3])
X[row, col]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
<p>The pairing of indices in fancy indexing follows all the broadcasting
rules that we’ve already seen:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X[row[:, np.newaxis], col]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>each row value is matched with each column vector, exactly as we saw in
broadcasting of arithmetic operations</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>row[:, np.newaxis] * col
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>Remember: <em>with fancy indexing that the return value reflects
the</em><strong>broadcasted shape of the indices</strong><em>, rather than the shape of
the array being indexed</em>.</p>
<div class="section" id="combined-indexing">
<h3>Combined Indexing<a class="headerlink" href="#combined-indexing" title="Permalink to this headline">¶</a></h3>
<p>For even more powerful operations, fancy indexing can be combined with
the other indexing schemes we’ve seen:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X[2, [2, 0, 1]] # combine fancy and simple indices
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X[1:, [2, 0, 1]] # combine fancy indexing with slicing
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>mask = np.array([1, 0, 1, 0], dtype=bool)
X[row[:, np.newaxis], mask] # combine fancy indexing with masking
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="example-selecting-random-points">
<h3>Example: Selecting Random Points<a class="headerlink" href="#example-selecting-random-points" title="Permalink to this headline">¶</a></h3>
<p>One common use of fancy indexing is the selection of subsets of rows
from a matrix.</p>
<p>For example, we might have an <span class="math notranslate nohighlight">\(N\)</span> by <span class="math notranslate nohighlight">\(D\)</span> matrix representing
<span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(D\)</span> dimensions, such as the following points
drawn from a two-dimensional normal distribution:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>mean = [0, 0]
cov = [[1, 2],
       [2, 5]]
X = rand.multivariate_normal(mean, cov, 100)
X.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.scatter(X[:, 0], X[:, 1]);
</pre></div>
</div>
<img alt="_images/numpy_232_0.png" src="_images/numpy_232_0.png" />
<p>Let’s use fancy indexing to select 20 random points. We’ll do this by
first choosing 20 random indices with no repeats, and use these indices
to select a portion of the original array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>indices = np.random.choice(X.shape[0], 20, replace=False)
indices
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
       <span class="mi">92</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">34</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>selection = X[indices]  # fancy indexing here
selection.shape
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now to see which points were selected, let’s over-plot large circles at
the locations of the selected points:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.scatter(X[:, 0], X[:, 1], alpha=0.3);
</pre></div>
</div>
<img alt="_images/numpy_237_0.png" src="_images/numpy_237_0.png" />
</div>
<div class="section" id="modifying-values-with-fancy-indexing">
<h3>Modifying Values with Fancy Indexing<a class="headerlink" href="#modifying-values-with-fancy-indexing" title="Permalink to this headline">¶</a></h3>
<p>Fancy indexing it can also be used to modify parts of an array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.arange(10)
i = np.array([2, 1, 8, 4])
x[i] = 99
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[i] -= 10 # use any assignment-type operator for this
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice, though, that repeated indices with these operations can cause
some potentially unexpected results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.zeros(10)
x[[0, 0]] = [4, 6]
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>Where did the 4 go? The result of this operation is to first assign
<code class="docutils literal notranslate"><span class="pre">x[0]</span> <span class="pre">=</span> <span class="pre">4</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">x[0]</span> <span class="pre">=</span> <span class="pre">6</span></code>. The result, of course, is that
<code class="docutils literal notranslate"><span class="pre">x[0]</span></code> contains the value 6.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>i = [2, 3, 3, 4, 4, 4]
x[i] += 1
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>You might expect that <code class="docutils literal notranslate"><span class="pre">x[3]</span></code> would contain the value 2, and <code class="docutils literal notranslate"><span class="pre">x[4]</span></code>
would contain the value 3, as this is how many times each index is
repeated. Why is this not the case?</p>
<p>Conceptually, this is because <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">+=</span> <span class="pre">1</span></code> is meant as a shorthand of
<code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">=</span> <span class="pre">x[i]</span> <span class="pre">+</span> <span class="pre">1</span></code>. <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">+</span> <span class="pre">1</span></code> is evaluated, and then the result is
assigned to the indices in x.</p>
<p>With this in mind, it is not the augmentation that happens multiple
times, but the assignment, which leads to the rather nonintuitive
results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.zeros(10)
np.add.at(x, i, 1)
x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">at()</span></code> method does an in-place application of the given operator
at the specified indices (here, <code class="docutils literal notranslate"><span class="pre">i</span></code>) with the specified value (here,
1). Another method that is similar in spirit is the <code class="docutils literal notranslate"><span class="pre">reduceat()</span></code>
method of ufuncs, which you can read about in the NumPy documentation.</p>
</div>
<div class="section" id="example-binning-data">
<h3>Example: Binning Data<a class="headerlink" href="#example-binning-data" title="Permalink to this headline">¶</a></h3>
<p>You can use these ideas to efficiently bin data to create a histogram by
hand. For example, imagine we have 1,000 values and would like to
quickly find where they fall within an array of bins. We could compute
it using <code class="docutils literal notranslate"><span class="pre">ufunc.at</span></code> like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.random.seed(42)
x = np.random.randn(100)

# compute a histogram by hand
bins = np.linspace(-5, 5, 20)
counts = np.zeros_like(bins)

# find the appropriate bin for each x
i = np.searchsorted(bins, x)

# add 1 to each of these bins
np.add.at(counts, i, 1)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># The counts now reflect the number of points
# within each bin–in other words, a histogram:
line, = plt.plot(bins, counts);
line.set_drawstyle(&quot;steps&quot;)
</pre></div>
</div>
<img alt="_images/numpy_250_0.png" src="_images/numpy_250_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>print(&quot;NumPy routine:&quot;)
%timeit counts, edges = np.histogram(x, bins)

print(&quot;Custom routine:&quot;)
%timeit np.add.at(counts, np.searchsorted(bins, x), 1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NumPy routine:
35.1 µs ± 209 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
Custom routine:
18.5 µs ± 405 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<p>Our own one-line algorithm is several times faster than the optimized
algorithm in NumPy! How can this be? If you dig into the
<code class="docutils literal notranslate"><span class="pre">np.histogram</span></code> source code (you can do this in IPython by typing
<code class="docutils literal notranslate"><span class="pre">np.histogram??</span></code>), you’ll see that it’s quite a bit more involved than
the simple search-and-count that we’ve done; this is because NumPy’s
algorithm is more flexible, and particularly is designed for better
performance when the number of data points becomes large…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.random.randn(1000000)
print(&quot;NumPy routine:&quot;)
%timeit counts, edges = np.histogram(x, bins)

print(&quot;Custom routine:&quot;)
%timeit np.add.at(counts, np.searchsorted(bins, x), 1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NumPy routine:
95.9 ms ± 1.17 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
Custom routine:
142 ms ± 115 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>What this comparison shows is that algorithmic efficiency is almost
never a simple question. An algorithm efficient for large datasets will
not always be the best choice for small datasets, and vice versa.</p>
<p>The key to efficiently using Python in data-intensive applications is
knowing about general convenience routines like <code class="docutils literal notranslate"><span class="pre">np.histogram</span></code> and
when they’re appropriate, but also knowing how to make use of
lower-level functionality when you need more pointed behavior.</p>
</div>
</div>
<div class="section" id="sorting-arrays">
<h2>Sorting Arrays<a class="headerlink" href="#sorting-arrays" title="Permalink to this headline">¶</a></h2>
<p>Up to this point we have been concerned mainly with tools to access and
operate on array data with NumPy. This section covers algorithms related
to sorting values in NumPy arrays.</p>
<div class="section" id="fast-sorting-in-numpy-np-sort-and-np-argsort">
<h3>Fast Sorting in NumPy: <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code><a class="headerlink" href="#fast-sorting-in-numpy-np-sort-and-np-argsort" title="Permalink to this headline">¶</a></h3>
<p>Although Python has built-in <code class="docutils literal notranslate"><span class="pre">sort</span></code> and <code class="docutils literal notranslate"><span class="pre">sorted</span></code> functions to work
with lists, NumPy’s <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> function turns out to be much more
efficient and useful.</p>
<p>To return a sorted version of the array <em>without modifying the input</em>,
you can use <code class="docutils literal notranslate"><span class="pre">np.sort</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([2, 1, 4, 3, 5])
np.sort(x)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>A related function is <code class="docutils literal notranslate"><span class="pre">argsort</span></code>, which instead returns the <em>indices</em>
of the sorted elements:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>i = np.argsort(x)
i
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>The first element of this result gives the index of the smallest
element, the second value gives the index of the second smallest, and so
on.</p>
<p>These indices can then be used (via fancy indexing) to construct the
sorted array if desired:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x[i]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="sorting-along-rows-or-columns">
<h4>Sorting along rows or columns<a class="headerlink" href="#sorting-along-rows-or-columns" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>rand = np.random.RandomState(42)
X = rand.randint(0, 10, (4, 6))
X
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.sort(X, axis=0) # sort each column of X
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.sort(X, axis=1) # sort each row of X
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<p>Keep in mind that this treats each row or column as an independent
array, and any relationships between the row or column values will be
lost!</p>
</div>
</div>
<div class="section" id="partial-sorts-partitioning">
<h3>Partial Sorts: Partitioning<a class="headerlink" href="#partial-sorts-partitioning" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we’re not interested in sorting the entire array, but simply
want to find the <em>k</em> smallest values in the array. <code class="docutils literal notranslate"><span class="pre">np.partition</span></code>
takes an array and a number <em>K</em>; the result is a new array with the
smallest <em>K</em> values to the left of the partition, and the remaining
values to the right, in arbitrary order:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>x = np.array([7, 2, 3, 1, 6, 5, 4])
np.partition(x, 3)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that the first three values in the resulting array are the three
smallest in the array, and the remaining array positions contain the
remaining values.</p>
<p><em>Within the two partitions, the elements have arbitrary order.</em></p>
<p>Similarly to sorting, we can partition along an arbitrary axis of a
multidimensional array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.partition(X, 2, axis=1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
<p>The result is an array where the first two slots in each row contain the
smallest values from that row, with the remaining values filling the
remaining slots.</p>
<p>Finally, just as there is a <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code> that computes indices of the
sort, there is a <code class="docutils literal notranslate"><span class="pre">np.argpartition</span></code> that computes indices of the
partition.</p>
</div>
<div class="section" id="example-k-nearest-neighbors">
<h3>Example: k-Nearest Neighbors<a class="headerlink" href="#example-k-nearest-neighbors" title="Permalink to this headline">¶</a></h3>
<p>Let’s quickly see how we might use this <code class="docutils literal notranslate"><span class="pre">argsort</span></code> function along
multiple axes to find the nearest neighbors of each point in a set.</p>
<p>We’ll start by creating a random set of 10 points on a two-dimensional
plane:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>X = rand.rand(50, 2)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="n">ffd1d8c0b963</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">X</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;rand&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.scatter(X[:, 0], X[:, 1], s=100);
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">68</span><span class="n">a4fcce3c3f</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;plt&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># compute the distance between each pair of points
dist_sq = np.sum((X[:, np.newaxis, :] - X[np.newaxis, :, :]) ** 2, axis=-1)
dist_sq.shape, np.all(dist_sq.diagonal() == 0)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>With the pairwise square-distances converted, we can now use
<code class="docutils literal notranslate"><span class="pre">np.argsort</span></code> to sort along each row.</p>
<p>The leftmost columns will then give the indices of the nearest
neighbors:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>nearest = np.argsort(dist_sq, axis=1)
nearest[:,0]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
       <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>
       <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice that the first column is order because each point’s closest
neighbor is itself.</p>
<p>If we’re simply interested in the nearest <span class="math notranslate nohighlight">\(k\)</span> neighbors, all we
need is to partition each row so that the smallest <span class="math notranslate nohighlight">\(k + 1\)</span> squared
distances come first, with larger distances filling the remaining
positions of the array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>K = 2
nearest_partition = np.argpartition(dist_sq, K + 1, axis=1)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>plt.scatter(X[:, 0], X[:, 1], s=100)
K = 2 # draw lines from each point to its two nearest neighbors
for i in range(X.shape[0]):
    for j in nearest_partition[i, :K+1]:
        plt.plot(*zip(X[j], X[i]), color=&#39;black&#39;)
</pre></div>
</div>
<img alt="_images/numpy_283_0.png" src="_images/numpy_283_0.png" />
<p>At first glance, it might seem strange that some of the points have more
than two lines coming out of them: this is due to the fact that if point
A is one of the two nearest neighbors of point B, this does not
necessarily imply that point B is one of the two nearest neighbors of
point A.</p>
<p>You might be tempted to do the same type of operation by manually
looping through the data and sorting each set of neighbors individually.
The beauty of our approach is that <em>it’s written in a way that’s
agnostic to the size of the input data</em>: we could just as easily compute
the neighbors among 100 or 1,000,000 points in any number of dimensions,
and the code would look the same.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def A(a: int) -&gt; (3 if 0 else 4):
    return 4
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>A(3)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>A.__annotations__
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;return&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>type(_)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">dict</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>def B(f):
    print(f.__annotations__)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>B(A)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{&#39;a&#39;: &lt;class &#39;int&#39;&gt;, &#39;return&#39;: &lt;object object at 0x7fd9be16ccc0&gt;}
</pre></div>
</div>
</div>
</div>
</div>


          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="exercises.html" title="Previous document">Exercises</a>
        </li>
        <li>
          <a href="pandas.html" title="Next document">pandas module</a>
          &rarr;
        </li>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2021, Massimo Nocentini.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/numpy.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>