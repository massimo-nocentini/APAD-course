
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Introduction &#8212; APAD course  documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="APAD course’s content" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="APAD course’s content"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">APAD course  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. February 7, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract A (very concise) introduction to the Python ecosystem.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;notebooks&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outline</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Python&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Whys and refs&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;On the shoulders of giants&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Course agenda&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">this</span>
</pre></div>
</div>
<pre class="literal-block">The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren't special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you're Dutch.
Now is better than never.
Although never is often better than <em>right</em> now.
If the implementation is hard to explain, it's a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let's do more of those!</pre>
<div class="section" id="past-and-present">
<h2>past and present<a class="headerlink" href="#past-and-present" title="Permalink to this headline">¶</a></h2>
<p>From <a class="reference external" href="https://en.wikipedia.org/wiki/Python_(programming_language">https://en.wikipedia.org/wiki/Python_(programming_language</a>) -
Python is an interpreted, high-level, general-purpose programming
language. Created by Guido van Rossum and first released in 1991,
Python’s design philosophy emphasizes code readability with its notable
use of significant whitespace. Its language constructs and
object-oriented approach aim to help programmers write clear, logical
code for small and large-scale projects. - Python is dynamically typed
and garbage-collected. It supports multiple programming paradigms,
including procedural, object-oriented, and functional programming.
Python is often described as a “batteries included” language due to its
comprehensive standard library. - Python was conceived in the late 1980s
as a successor to the ABC language. Python 2.0, released in 2000,
introduced features like list comprehensions and a garbage collection
system capable of collecting reference cycles. Python 3.0, released in
2008, was a major revision of the language that is not completely
backward-compatible, and much Python 2 code does not run unmodified on
Python 3. - <a class="reference external" href="https://brochure.getpython.info/media/releases/prerelases/psf-python-brochure-vol-1-final-content-preview">PSF Python Brochure
Project</a></p>
<p>From <a class="reference external" href="https://www.python.org/">https://www.python.org/</a></p>
<ul class="simple">
<li><p><strong>Functions Defined</strong>. The core of extensible programming is defining
functions. Python allows mandatory and optional arguments, keyword
arguments, and even arbitrary argument lists.</p></li>
<li><p><strong>Compound Data Types</strong>. Lists (known as arrays in other languages)
are one of the compound data types that Python understands. Lists can
be indexed, sliced and manipulated with other built-in functions.</p></li>
<li><p><strong>Intuitive Interpretation</strong>. Calculations are simple with Python,
and expression syntax is straightforward: the operators +, -, * and
/ work as expected; parentheses () can be used for grouping.</p></li>
<li><p><strong>Quick &amp; Easy to Learn</strong>. Experienced programmers in any other
language can pick up Python very quickly, and beginners find the
clean syntax and indentation structure easy to learn.</p></li>
<li><p><strong>All the Flow You’d Expect</strong>. Python knows the usual control flow
statements that other languages speak — <code class="docutils literal notranslate"><span class="pre">if,</span> <span class="pre">for,</span> <span class="pre">while</span></code> and
<code class="docutils literal notranslate"><span class="pre">range</span></code> — with some of its own twists, of course.</p></li>
</ul>
<p>Some supporting quotes <a class="reference external" href="https://www.python.org/about/quotes/">here</a>.</p>
<p>From <a class="reference external" href="https://docs.python.org/3/">https://docs.python.org/3/</a></p>
<img alt="_images/Python-doc-page.png" src="_images/Python-doc-page.png" />
</div>
<div class="section" id="beware-of-shadows">
<h2>beware of shadows<a class="headerlink" href="#beware-of-shadows" title="Permalink to this headline">¶</a></h2>
<p>Python can be installed in many different ways with respect to different
needs. - <a class="reference external" href="https://www.anaconda.com/">https://www.anaconda.com/</a> - <a class="reference external" href="https://www.spyder-ide.org/">https://www.spyder-ide.org/</a> -
<a class="reference external" href="https://www.sagemath.org/">https://www.sagemath.org/</a></p>
<p>We advice to stick to the official one for the sake of being self
contained and use an unified environment.</p>
<p>All such distributions customize the base package for domain-specific
domains, in the future you will be able to take into account the one
that best suites your needs; for the present, trust the default one.</p>
<p>Therefore, go head and install the Python interpreter.</p>
<p><a class="reference external" href="https://www.python.org/downloads/">https://www.python.org/downloads/</a></p>
<img alt="_images/Python-download.png" src="_images/Python-download.png" />
</div>
<div class="section" id="welcome-to-the-carousel">
<h2>welcome to the carousel<a class="headerlink" href="#welcome-to-the-carousel" title="Permalink to this headline">¶</a></h2>
<p>We have just scraped a little bit the surface of a big iceberg.</p>
<p>Help yourself with the good documentation, otherwise go ahead on the
shoulders of: - <a class="reference external" href="https://g.co/kgs/q5aSbf">Guido van Rossum</a> - <a class="reference external" href="https://g.co/kgs/SAHeD1">Peter
Norvig</a> - <a class="reference external" href="https://g.co/kgs/9qkvkY">David M.
Beazley</a> - <a class="reference external" href="https://g.co/kgs/RqGztj">Alex
Martelli</a> - <a class="reference external" href="https://g.co/kgs/A54z1o">Tim
Peters</a> - <a class="reference external" href="https://g.co/kgs/UsKs8e">Fredrik
Lundh</a></p>
</div>
</div>
<div class="section" id="jupyter-notebooks">
<h1>Jupyter notebooks<a class="headerlink" href="#jupyter-notebooks" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. February 7, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract A (very concise) introduction to the Python ecosystem.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;notebooks&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="ipython-beyond-normal-python">
<h2>IPython: Beyond Normal Python<a class="headerlink" href="#ipython-beyond-normal-python" title="Permalink to this headline">¶</a></h2>
<p>There are many options for development environments for Python, and I’m
often asked which one I use in my own work. My answer sometimes
surprises people: my preferred environment is
<a class="reference external" href="http://ipython.org/">IPython</a> plus a text editor (in my case, Emacs
or Atom depending on my mood). IPython (short for <em>Interactive Python</em>)
was started in 2001 by Fernando Perez as an enhanced Python interpreter,
and has since grown into a project aiming to provide, in Perez’s words,
“Tools for the entire life cycle of research computing.” If Python is
the engine of our data science task, you might think of IPython as the
interactive control panel.</p>
<p>As well as being a useful interactive interface to Python, IPython also
provides a number of useful syntactic additions to the language; we’ll
cover the most useful of these additions here. In addition, IPython is
closely tied with the <a class="reference external" href="http://jupyter.org">Jupyter project</a>, which
provides a browser-based notebook that is useful for development,
collaboration, sharing, and even publication of data science results.
The IPython notebook is actually a special case of the broader Jupyter
notebook structure, which encompasses notebooks for Julia, R, and other
programming languages. As an example of the usefulness of the notebook
format, look no further than the page you are reading: the entire
manuscript for this book was composed as a set of IPython notebooks.</p>
<p>IPython is about using Python effectively for interactive scientific and
data-intensive computing. This chapter will start by stepping through
some of the IPython features that are useful to the practice of data
science, focusing especially on the syntax it offers beyond the standard
features of Python. Next, we will go into a bit more depth on some of
the more useful “magic commands” that can speed-up common tasks in
creating and using data science code. Finally, we will touch on some of
the features of the notebook that make it useful in understanding data
and sharing results.</p>
<div class="section" id="shell-or-notebook">
<h3>Shell or Notebook?<a class="headerlink" href="#shell-or-notebook" title="Permalink to this headline">¶</a></h3>
<p>There are two primary means of using IPython that we’ll discuss in this
chapter: the IPython shell and the IPython notebook. The bulk of the
material in this chapter is relevant to both, and the examples will
switch between them depending on what is most convenient. In the few
sections that are relevant to just one or the other, we will explicitly
state that fact. Before we start, some words on how to launch the
IPython shell and IPython notebook.</p>
<div class="section" id="launching-the-ipython-shell">
<h4>Launching the IPython Shell<a class="headerlink" href="#launching-the-ipython-shell" title="Permalink to this headline">¶</a></h4>
<p>This chapter, like most of this book, is not designed to be absorbed
passively. I recommend that as you read through it, you follow along and
experiment with the tools and syntax we cover: the muscle-memory you
build through doing this will be far more useful than the simple act of
reading about it. Start by launching the IPython interpreter by typing
<strong>``ipython``</strong> on the command-line; alternatively, if you’ve installed
a distribution like Anaconda or EPD, there may be a launcher specific to
your system (we’ll discuss this more fully in <a class="reference external" href="01.01-Help-And-Documentation.ipynb">Help and Documentation in
IPython</a>).</p>
<p>Once you do this, you should see a prompt like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>IPython 4.0.1 -- An enhanced Interactive Python.
?         -&gt; Introduction and overview of IPython&#39;s features.
%quickref -&gt; Quick reference.
help      -&gt; Python&#39;s own help system.
object?   -&gt; Details about &#39;object&#39;, use &#39;object??&#39; for extra details.
In [1]:
</pre></div>
</div>
<p>With that, you’re ready to follow along.</p>
</div>
<div class="section" id="launching-the-jupyter-notebook">
<h4>Launching the Jupyter Notebook<a class="headerlink" href="#launching-the-jupyter-notebook" title="Permalink to this headline">¶</a></h4>
<p>The Jupyter notebook is a browser-based graphical interface to the
IPython shell, and builds on it a rich set of dynamic display
capabilities. As well as executing Python/IPython statements, the
notebook allows the user to include formatted text, static and dynamic
visualizations, mathematical equations, JavaScript widgets, and much
more. Furthermore, these documents can be saved in a way that lets other
people open them and execute the code on their own systems.</p>
<p>Though the IPython notebook is viewed and edited through your web
browser window, it must connect to a running Python process in order to
execute code. This process (known as a “kernel”) can be started by
running the following command in your system shell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jupyter notebook
</pre></div>
</div>
<p>This command will launch a local web server that will be visible to your
browser. It immediately spits out a log showing what it is doing; that
log will look something like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ jupyter notebook
[NotebookApp] Serving notebooks from local directory: /Users/jakevdp/PythonDataScienceHandbook
[NotebookApp] 0 active kernels
[NotebookApp] The IPython Notebook is running at: http://localhost:8888/
[NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
</pre></div>
</div>
<p>Upon issuing the command, your default browser should automatically open
and navigate to the listed local URL; the exact address will depend on
your system. If the browser does not open automatically, you can open a
window and manually open this address (<em>http://localhost:8888/</em> in this
example).</p>
</div>
</div>
</div>
<div class="section" id="help-and-documentation-in-ipython">
<h2>Help and Documentation in IPython<a class="headerlink" href="#help-and-documentation-in-ipython" title="Permalink to this headline">¶</a></h2>
<p>If you read no other section in this chapter, read this one: I find the
tools discussed here to be the most transformative contributions of
IPython to my daily workflow.</p>
<p>When a technologically-minded person is asked to help a friend, family
member, or colleague with a computer problem, most of the time it’s less
a matter of knowing the answer as much as knowing how to quickly find an
unknown answer.</p>
<p>In data science it’s the same: searchable web resources such as online
documentation, mailing-list threads, and StackOverflow answers contain a
wealth of information, even (especially?) if it is a topic you’ve found
yourself searching before.</p>
<p><em>Being an effective practitioner of data science is less about
memorizing the tool or command you should use for every possible
situation, and more about learning to effectively find the information
you don’t know, whether through a web search engine or another means.</em></p>
<p>One of the most useful functions of IPython/Jupyter is to shorten the
gap between the user and the type of documentation and search that will
help them do their work effectively.</p>
<p>While web searches still play a role in answering complicated questions,
an amazing amount of information can be found through IPython alone.
Some examples of the questions IPython can help answer in a few
keystrokes:</p>
<ul class="simple">
<li><p>How do I call this function? What arguments and options does it have?</p></li>
<li><p>What does the source code of this Python object look like?</p></li>
<li><p>What is in this package I imported? What attributes or methods does
this object have?</p></li>
</ul>
<p>Here we’ll discuss IPython’s tools to quickly access this information,
namely the <code class="docutils literal notranslate"><span class="pre">?</span></code> character to explore documentation, the <code class="docutils literal notranslate"><span class="pre">??</span></code>
characters to explore source code, and the Tab key for auto-completion.</p>
<div class="section" id="accessing-documentation-with">
<h3>Accessing Documentation with <code class="docutils literal notranslate"><span class="pre">?</span></code><a class="headerlink" href="#accessing-documentation-with" title="Permalink to this headline">¶</a></h3>
<p>The Python language and its data science ecosystem is built with the
user in mind, and one big part of that is access to documentation. Every
Python object contains the reference to a string, known as a <em>doc
string</em>, which in most cases will contain a concise summary of the
object and how to use it. Python has a built-in <code class="docutils literal notranslate"><span class="pre">help()</span></code> function that
can access this information and prints the results. For example, to see
the documentation of the built-in <code class="docutils literal notranslate"><span class="pre">len</span></code> function, you can do the
following:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Help</span> <span class="n">on</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">len</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">builtins</span><span class="p">:</span>

<span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span>
    <span class="n">Return</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">container</span><span class="o">.</span>
</pre></div>
</div>
<p>This notation works for just about anything, including object methods:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">help</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">insert</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Help</span> <span class="n">on</span> <span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="n">insert</span><span class="p">:</span>

<span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">object</span><span class="p">,</span> <span class="o">/</span><span class="p">)</span> <span class="n">method</span> <span class="n">of</span> <span class="n">builtins</span><span class="o">.</span><span class="n">list</span> <span class="n">instance</span>
    <span class="n">Insert</span> <span class="nb">object</span> <span class="n">before</span> <span class="n">index</span><span class="o">.</span>
</pre></div>
</div>
<p>or even objects themselves, with the documentation from their type:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on list object:

class list(object)
 |  list(iterable=(), /)
 |
 |  Built-in mutable sequence.
 |
 |  If no argument is given, the constructor creates a new empty list.
 |  The argument must be an iterable if specified.
 |
 |  Methods defined here:
 |
 |  __add__(self, value, /)
 |      Return self+value.
 |
 |  __contains__(self, key, /)
 |      Return key in self.
 |
 |  __delitem__(self, key, /)
 |      Delete self[key].
 |
 |  __eq__(self, value, /)
 |      Return self==value.
 |
 |  __ge__(self, value, /)
 |      Return self&gt;=value.
 |
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |
 |  __getitem__(...)
 |      x.__getitem__(y) &lt;==&gt; x[y]
 |
 |  __gt__(self, value, /)
 |      Return self&gt;value.
 |
 |  __iadd__(self, value, /)
 |      Implement self+=value.
 |
 |  __imul__(self, value, /)
 |      Implement self*=value.
 |
 |  __init__(self, /, <em>args, **kwargs)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  __iter__(self, /)
 |      Implement iter(self).
 |
 |  __le__(self, value, /)
 |      Return self&lt;=value.
 |
 |  __len__(self, /)
 |      Return len(self).
 |
 |  __lt__(self, value, /)
 |      Return self&lt;value.
 |
 |  __mul__(self, value, /)
 |      Return self*value.
 |
 |  __ne__(self, value, /)
 |      Return self!=value.
 |
 |  __repr__(self, /)
 |      Return repr(self).
 |
 |  __reversed__(self, /)
 |      Return a reverse iterator over the list.
 |
 |  __rmul__(self, value, /)
 |      Return value*self.
 |
 |  __setitem__(self, key, value, /)
 |      Set self[key] to value.
 |
 |  __sizeof__(self, /)
 |      Return the size of the list in memory, in bytes.
 |
 |  append(self, object, /)
 |      Append object to the end of the list.
 |
 |  clear(self, /)
 |      Remove all items from list.
 |
 |  copy(self, /)
 |      Return a shallow copy of the list.
 |
 |  count(self, value, /)
 |      Return number of occurrences of value.
 |
 |  extend(self, iterable, /)
 |      Extend list by appending elements from the iterable.
 |
 |  index(self, value, start=0, stop=9223372036854775807, /)
 |      Return first index of value.
 |
 |      Raises ValueError if the value is not present.
 |
 |  insert(self, index, object, /)
 |      Insert object before index.
 |
 |  pop(self, index=-1, /)
 |      Remove and return item at index (default last).
 |
 |      Raises IndexError if list is empty or index is out of range.
 |
 |  remove(self, value, /)
 |      Remove first occurrence of value.
 |
 |      Raises ValueError if the value is not present.
 |
 |  reverse(self, /)
 |      Reverse *IN PLACE</em>.
 |
 |  sort(self, /, <em>, key=None, reverse=False)
 |      Stable sort *IN PLACE</em>.
 |
 |  ----------------------------------------------------------------------
 |  Static methods defined here:
 |
 |  __new__(<a href="#id1"><span class="problematic" id="id2">*</span></a>args, <a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |
 |  ----------------------------------------------------------------------
 |  Data and other attributes defined here:
 |
 |  __hash__ = None</pre>
<p>Importantly, this will even work for functions or other objects you
create yourself! Here we’ll define a small function with a docstring:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the square of a.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Note that to create a docstring for our function, we simply placed a
string literal in the first line. Because doc strings are usually
multiple lines, by convention we used Python’s triple-quote notation for
multi-line strings.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">square</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Help</span> <span class="n">on</span> <span class="n">function</span> <span class="n">square</span> <span class="ow">in</span> <span class="n">module</span> <span class="n">__main__</span><span class="p">:</span>

<span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">Return</span> <span class="n">the</span> <span class="n">square</span> <span class="n">of</span> <span class="n">a</span><span class="o">.</span>
</pre></div>
</div>
<p>This quick access to documentation via docstrings is one reason you
should get in the habit of always adding such inline documentation to
the code you write!</p>
</div>
<div class="section" id="accessing-source-code-with">
<h3>Accessing Source Code with <code class="docutils literal notranslate"><span class="pre">??</span></code><a class="headerlink" href="#accessing-source-code-with" title="Permalink to this headline">¶</a></h3>
<p>Because the Python language is so easily readable, another level of
insight can usually be gained by reading the source code of the object
you’re curious about. IPython provides a shortcut to the source code
with the double question mark (<code class="docutils literal notranslate"><span class="pre">??</span></code>):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> square<span class="o">??</span>
<span class="n">Type</span><span class="p">:</span>        <span class="n">function</span>
<span class="n">String</span> <span class="n">form</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">square</span> <span class="n">at</span> <span class="mh">0x103713cb0</span><span class="o">&gt;</span>
<span class="n">Definition</span><span class="p">:</span>  <span class="n">square</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">Source</span><span class="p">:</span>
<span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="s2">&quot;Return the square of a&quot;</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>For simple functions like this, the double question-mark can give quick
insight into the under-the-hood details.</p>
<p>If you play with this much, you’ll notice that sometimes the <code class="docutils literal notranslate"><span class="pre">??</span></code>
suffix doesn’t display any source code: this is generally because the
object in question is not implemented in Python, but in C or some other
compiled extension language. If this is the case, the <code class="docutils literal notranslate"><span class="pre">??</span></code> suffix
gives the same output as the <code class="docutils literal notranslate"><span class="pre">?</span></code> suffix. You’ll find this particularly
with many of Python’s built-in objects and types, for example <code class="docutils literal notranslate"><span class="pre">len</span></code>
from above:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> len<span class="o">??</span>
<span class="n">Type</span><span class="p">:</span>        <span class="n">builtin_function_or_method</span>
<span class="n">String</span> <span class="n">form</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">len</span><span class="o">&gt;</span>
<span class="n">Namespace</span><span class="p">:</span>   <span class="n">Python</span> <span class="n">builtin</span>
<span class="n">Docstring</span><span class="p">:</span>
<span class="nb">len</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">integer</span>

<span class="n">Return</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">items</span> <span class="n">of</span> <span class="n">a</span> <span class="n">sequence</span> <span class="ow">or</span> <span class="n">mapping</span><span class="o">.</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">?</span></code> and/or <code class="docutils literal notranslate"><span class="pre">??</span></code> gives a powerful and quick interface for
finding information about what any Python function or module does.</p>
</div>
<div class="section" id="exploring-modules-with-tab-completion">
<h3>Exploring Modules with Tab-Completion<a class="headerlink" href="#exploring-modules-with-tab-completion" title="Permalink to this headline">¶</a></h3>
<p>IPython’s other useful interface is the use of the tab key for
auto-completion and exploration of the contents of objects, modules, and
name-spaces. In the examples that follow, we’ll use <code class="docutils literal notranslate"><span class="pre">&lt;TAB&gt;</span></code> to
indicate when the Tab key should be pressed.</p>
<div class="section" id="tab-completion-of-object-contents">
<h4>Tab-completion of object contents<a class="headerlink" href="#tab-completion-of-object-contents" title="Permalink to this headline">¶</a></h4>
<p>Every Python object has various attributes and methods associated with
it. Like with the <code class="docutils literal notranslate"><span class="pre">help</span></code> function discussed before, Python has a
built-in <code class="docutils literal notranslate"><span class="pre">dir</span></code> function that returns a list of these, but the
tab-completion interface is much easier to use in practice. To see a
list of all available attributes of an object, you can type the name of
the object followed by a period (“<code class="docutils literal notranslate"><span class="pre">.</span></code>”) character and the Tab key:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">L</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">L</span><span class="o">.</span><span class="n">append</span>   <span class="n">L</span><span class="o">.</span><span class="n">copy</span>     <span class="n">L</span><span class="o">.</span><span class="n">extend</span>   <span class="n">L</span><span class="o">.</span><span class="n">insert</span>   <span class="n">L</span><span class="o">.</span><span class="n">remove</span>   <span class="n">L</span><span class="o">.</span><span class="n">sort</span>
<span class="n">L</span><span class="o">.</span><span class="n">clear</span>    <span class="n">L</span><span class="o">.</span><span class="n">count</span>    <span class="n">L</span><span class="o">.</span><span class="n">index</span>    <span class="n">L</span><span class="o">.</span><span class="n">pop</span>      <span class="n">L</span><span class="o">.</span><span class="n">reverse</span>
</pre></div>
</div>
<p>To narrow-down the list, you can type the first character or several
characters of the name, and the Tab key will find the matching
attributes and methods:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">L</span><span class="o">.</span><span class="n">c</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">L</span><span class="o">.</span><span class="n">clear</span>  <span class="n">L</span><span class="o">.</span><span class="n">copy</span>   <span class="n">L</span><span class="o">.</span><span class="n">count</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">L</span><span class="o">.</span><span class="n">co</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">L</span><span class="o">.</span><span class="n">copy</span>   <span class="n">L</span><span class="o">.</span><span class="n">count</span>
</pre></div>
</div>
<p>If there is only a single option, pressing the Tab key will complete the
line for you. For example, the following will instantly be replaced with
<code class="docutils literal notranslate"><span class="pre">L.count</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">L</span><span class="o">.</span><span class="n">cou</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Though Python has no strictly-enforced distinction between
public/external attributes and private/internal attributes, by
convention a preceding underscore is used to denote such methods. For
clarity, these private methods and special methods are omitted from the
list by default, but it’s possible to list them by explicitly typing the
underscore:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="n">L</span><span class="o">.</span><span class="n">_</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">L</span><span class="o">.</span><span class="fm">__add__</span>           <span class="n">L</span><span class="o">.</span><span class="fm">__gt__</span>            <span class="n">L</span><span class="o">.</span><span class="n">__reduce__</span>
<span class="n">L</span><span class="o">.</span><span class="vm">__class__</span>         <span class="n">L</span><span class="o">.</span><span class="fm">__hash__</span>          <span class="n">L</span><span class="o">.</span><span class="n">__reduce_ex__</span>
</pre></div>
</div>
<p>For brevity, we’ve only shown the first couple lines of the output. Most
of these are Python’s special double-underscore methods (often nicknamed
“dunder” methods).</p>
</div>
<div class="section" id="tab-completion-when-importing">
<h4>Tab completion when importing<a class="headerlink" href="#tab-completion-when-importing" title="Permalink to this headline">¶</a></h4>
<p>Tab completion is also useful when importing objects from packages. Here
we’ll use it to find all possible imports in the <code class="docutils literal notranslate"><span class="pre">itertools</span></code> package
that start with <code class="docutils literal notranslate"><span class="pre">co</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">co</span><span class="o">&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
<span class="n">combinations</span>                   <span class="n">compress</span>
<span class="n">combinations_with_replacement</span>  <span class="n">count</span>
</pre></div>
</div>
<p>Similarly, you can use tab-completion to see which imports are available
on your system (this will change depending on which third-party scripts
and modules are visible to your Python session):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>In [10]: import &lt;TAB&gt;
Display all 399 possibilities? (y or n)
Crypto              dis                 py_compile
Cython              distutils           pyclbr
...                 ...                 ...
difflib             pwd                 zmq

In [10]: import h&lt;TAB&gt;
hashlib             hmac                http
heapq               html                husl
</pre></div>
</div>
<p>(Note that for brevity, I did not print here all 399 importable packages
and modules on my system.)</p>
</div>
<div class="section" id="beyond-tab-completion-wildcard-matching">
<h4>Beyond tab completion: wildcard matching<a class="headerlink" href="#beyond-tab-completion-wildcard-matching" title="Permalink to this headline">¶</a></h4>
<p>Tab completion is useful if you know the first few characters of the
object or attribute you’re looking for, but is little help if you’d like
to match characters at the middle or end of the word. For this use-case,
IPython provides a means of wildcard matching for names using the <code class="docutils literal notranslate"><span class="pre">*</span></code>
character.</p>
<p>For example, we can use this to list every object in the namespace that
ends with <code class="docutils literal notranslate"><span class="pre">Warning</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> *Warning<span class="o">?</span>
<span class="ne">BytesWarning</span>                  <span class="ne">RuntimeWarning</span>
<span class="ne">DeprecationWarning</span>            <span class="ne">SyntaxWarning</span>
<span class="ne">FutureWarning</span>                 <span class="ne">UnicodeWarning</span>
<span class="ne">ImportWarning</span>                 <span class="ne">UserWarning</span>
<span class="ne">PendingDeprecationWarning</span>     <span class="ne">Warning</span>
<span class="ne">ResourceWarning</span>
</pre></div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">*</span></code> character matches any string, including the empty
string.</p>
<p>Similarly, suppose we are looking for a string method that contains the
word <code class="docutils literal notranslate"><span class="pre">find</span></code> somewhere in its name. We can search for it this way:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> str.*find*<span class="o">?</span>
<span class="nb">str</span><span class="o">.</span><span class="n">find</span>
<span class="nb">str</span><span class="o">.</span><span class="n">rfind</span>
</pre></div>
</div>
<p>I find this type of flexible wildcard search can be very useful for
finding a particular command when getting to know a new package or
reacquainting myself with a familiar one.</p>
</div>
</div>
</div>
<div class="section" id="ipython-magic-commands">
<h2>IPython Magic Commands<a class="headerlink" href="#ipython-magic-commands" title="Permalink to this headline">¶</a></h2>
<p>The previous two sections showed how IPython lets you use and explore
Python efficiently and interactively. Here we’ll begin discussing some
of the enhancements that IPython adds on top of the normal Python
syntax. These are known in IPython as <em>magic commands</em>, and are prefixed
by the <code class="docutils literal notranslate"><span class="pre">%</span></code> character. These magic commands are designed to succinctly
solve various common problems in standard data analysis. Magic commands
come in two flavors: <em>line magics</em>, which are denoted by a single <code class="docutils literal notranslate"><span class="pre">%</span></code>
prefix and operate on a single line of input, and <em>cell magics</em>, which
are denoted by a double <code class="docutils literal notranslate"><span class="pre">%%</span></code> prefix and operate on multiple lines of
input. We’ll demonstrate and discuss a few brief examples here, and come
back to more focused discussion of several useful magic commands later
in the chapter.</p>
<div class="section" id="running-external-code-run">
<h3>Running External Code: <code class="docutils literal notranslate"><span class="pre">%run</span></code><a class="headerlink" href="#running-external-code-run" title="Permalink to this headline">¶</a></h3>
<p>As you begin developing more extensive code, you will likely find
yourself working in both IPython for interactive exploration, as well as
a text editor to store code that you want to reuse. Rather than running
this code in a new window, it can be convenient to run it within your
IPython session. This can be done with the <code class="docutils literal notranslate"><span class="pre">%run</span></code> magic.</p>
<p>For example, imagine you’ve created a <code class="docutils literal notranslate"><span class="pre">myscript.py</span></code> file with the
following contents:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%%bash

cat my-script.py
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;square a number&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>

<span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="s2">&quot;squared is&quot;</span><span class="p">,</span> <span class="n">square</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</pre></div>
</div>
<p>You can execute this from your IPython session as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> my-script.py
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="n">squared</span> <span class="ow">is</span> <span class="mi">1</span>
<span class="mi">2</span> <span class="n">squared</span> <span class="ow">is</span> <span class="mi">4</span>
<span class="mi">3</span> <span class="n">squared</span> <span class="ow">is</span> <span class="mi">9</span>
</pre></div>
</div>
<p>Note also that after you’ve run this script, any functions defined
within it are available for use in your IPython session:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">square</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">25</span>
</pre></div>
</div>
<p>There are several options to fine-tune how your code is run; you can see
the documentation in the normal way, by typing <strong>``%run?``</strong> in the
IPython interpreter.</p>
</div>
<div class="section" id="timing-code-execution-timeit">
<h3>Timing Code Execution: <code class="docutils literal notranslate"><span class="pre">%timeit</span></code><a class="headerlink" href="#timing-code-execution-timeit" title="Permalink to this headline">¶</a></h3>
<p>Another example of a useful magic function is <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>, which will
automatically determine the execution time of the single-line Python
statement that follows it. For example, we may want to check the
performance of a list comprehension:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> L = [n ** 2 for n in range(1000)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>307 µs ± 262 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>The benefit of <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> is that for short commands it will
automatically perform multiple runs in order to attain more robust
results.</p>
<p>For multi line statements, adding a second <code class="docutils literal notranslate"><span class="pre">%</span></code> sign will turn this
into a cell magic that can handle multiple lines of input. For example,
here’s the equivalent construction with a <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>346 µs ± 351 ns per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>We can immediately see that list comprehensions are about 10% faster
than the equivalent <code class="docutils literal notranslate"><span class="pre">for</span></code>-loop construction in this case.</p>
</div>
<div class="section" id="help-on-magic-functions-magic-and-lsmagic">
<h3>Help on Magic Functions: <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">%magic</span></code>, and <code class="docutils literal notranslate"><span class="pre">%lsmagic</span></code><a class="headerlink" href="#help-on-magic-functions-magic-and-lsmagic" title="Permalink to this headline">¶</a></h3>
<p>Like normal Python functions, IPython magic functions have docstrings,
and this useful documentation can be accessed in the standard manner.
So, for example, to read the documentation of the <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> magic
simply type this:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> %timeit<span class="o">?</span>
</pre></div>
</div>
<p>Documentation for other functions can be accessed similarly. To access a
general description of available magic functions, including some
examples, you can type this:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]:</span> <span class="o">%</span><span class="k">magic</span>
</pre></div>
</div>
<p>For a quick and simple list of all available magic functions, type this:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]:</span> <span class="o">%</span><span class="k">lsmagic</span>
</pre></div>
</div>
<p>Finally, I’ll mention that it is quite straightforward to define your
own magic functions if you wish.</p>
</div>
</div>
<div class="section" id="input-and-output-history">
<h2>Input and Output History<a class="headerlink" href="#input-and-output-history" title="Permalink to this headline">¶</a></h2>
<p>Previously we saw that the IPython shell allows you to access previous
commands with the up and down arrow keys, or equivalently the
Ctrl-p/Ctrl-n shortcuts. Additionally, in both the shell and the
notebook, IPython exposes several ways to obtain the output of previous
commands, as well as string versions of the commands themselves. We’ll
explore those here.</p>
<div class="section" id="ipythons-in-and-out-objects">
<h3>IPython’s <code class="docutils literal notranslate"><span class="pre">In</span></code> and <code class="docutils literal notranslate"><span class="pre">Out</span></code> Objects<a class="headerlink" href="#ipythons-in-and-out-objects" title="Permalink to this headline">¶</a></h3>
<p>By now I imagine you’re quite familiar with the <code class="docutils literal notranslate"><span class="pre">In</span> <span class="pre">[1]:</span></code>/<code class="docutils literal notranslate"><span class="pre">Out[1]:</span></code>
style prompts used by IPython. But it turns out that these are not just
pretty decoration: they give a clue as to how you can access previous
inputs and outputs in your current session. Imagine you start a session
that looks like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.9092974268256817</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">0.4161468365471424</span>
</pre></div>
</div>
<p>We’ve imported the built-in <code class="docutils literal notranslate"><span class="pre">math</span></code> package, then computed the sine and
the cosine of the number 2. These inputs and outputs are displayed in
the shell with <code class="docutils literal notranslate"><span class="pre">In</span></code>/<code class="docutils literal notranslate"><span class="pre">Out</span></code> labels, but there’s more–IPython actually
creates some Python variables called <code class="docutils literal notranslate"><span class="pre">In</span></code> and <code class="docutils literal notranslate"><span class="pre">Out</span></code> that are
automatically updated to reflect this history:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">In</span><span class="p">)[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">['', '__AUTHORS__ = {'am': (&quot;Andrea Marino&quot;, n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),n               'mn': (&quot;Massimo Nocentini&quot;, n                      &quot;<a class="reference external" href="mailto:massimo&#46;nocentini&#37;&#52;&#48;unifi&#46;it">massimo<span>&#46;</span>nocentini<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;, n                      &quot;<a class="reference external" href="https://github.com/massimo-nocentini/">https://github.com/massimo-nocentini/</a>&quot;,)}nn__KEYWORDS__ = ['Python', 'Jupyter', 'notebooks', 'keynote',]', &quot;outline = []noutline.append('Hello!')noutline.append('Python')noutline.append('Whys and refs')noutline.append('On the shoulders of giants')noutline.append('Set the env up')noutline.append('Notebooks')noutline.append('Course agenda')&quot;, 'help(len)', '__AUTHORS__ = {'am': (&quot;Andrea Marino&quot;, n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),n               'mn': (&quot;Massimo Nocentini&quot;, n                      &quot;<a class="reference external" href="mailto:massimo&#46;nocentini&#37;&#52;&#48;unifi&#46;it">massimo<span>&#46;</span>nocentini<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;, n                      &quot;<a class="reference external" href="https://github.com/massimo-nocentini/">https://github.com/massimo-nocentini/</a>&quot;,)}nn__KEYWORDS__ = ['Python', 'Jupyter', 'notebooks', 'keynote',]', 'help(len)', 'L = [1, 2, 3]nhelp(L.insert)', 'help(L)', 'This nota</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">Out</span><span class="p">)[:</span><span class="mi">1000</span><span class="p">])</span>
</pre></div>
</div>
<pre class="literal-block">{29: 25, 30: 0.9092974268256817, 31: -0.4161468365471424, 32: -0.4161468365471424, 33: 0.9092974268256817, 49: False, 51: False, 61: ['images', 'introduction.ipynb', 'introduction.slides.html', 'jupyter-notebooks.ipynb', 'jupyter-notebooks.slides.html', 'Makefile', 'my-script.py', 'notebooks.ipynb'], 62: ['/home/mn/Developer/working-copies/pythons/on-python/UniFiCourseSpring2020'], 63: &lt;class 'IPython.utils.text.SList'&gt;, 71: '['', '__AUTHORS__ = {\'am\': (&quot;Andrea Marino&quot;, \n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),\n', 72: '['', '__AUTHORS__ = {\'am\': (&quot;Andrea Marino&quot;, \n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),\n               \'mn\': (&quot;Massimo Nocentini&quot;, \n                      &quot;<a class="reference external" href="mailto:massimo&#46;nocentini&#37;&#52;&#48;unifi&#46;it">massimo<span>&#46;</span>nocentini<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;, \n                      &quot;<a class="reference external" href="https://github.com/massimo-nocentini/">https://github.com/massimo-nocentini/</a>&quot;,)}\n\n__KEYWORDS__ = [\'Python\', \'Jupyter\', \'notebooks\', \'keynote\',]', &quot;outline = []\noutline.append('Hello!')\noutline.append('Python')\noutl</pre>
<p>The <code class="docutils literal notranslate"><span class="pre">In</span></code> object is a list, which keeps track of the commands in order
(the first item in the list is a place-holder so that <code class="docutils literal notranslate"><span class="pre">In[1]</span></code> can
refer to the first command):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="kn">import</span> <span class="nn">math</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;notebooks&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Out</span></code> object is not a list but a dictionary mapping input numbers
to their outputs (if any):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">Out</span><span class="p">[</span><span class="mi">29</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">25</span>
</pre></div>
</div>
<p>Note that not all operations have outputs: for example, <code class="docutils literal notranslate"><span class="pre">import</span></code>
statements and <code class="docutils literal notranslate"><span class="pre">print</span></code> statements don’t affect the output. The latter
may be surprising, but makes sense if you consider that <code class="docutils literal notranslate"><span class="pre">print</span></code> is a
function that returns <code class="docutils literal notranslate"><span class="pre">None</span></code>; for brevity, any command that returns
<code class="docutils literal notranslate"><span class="pre">None</span></code> is not added to <code class="docutils literal notranslate"><span class="pre">Out</span></code>.</p>
<p>Where this can be useful is if you want to interact with past results.
For example, let’s check the sum of <code class="docutils literal notranslate"><span class="pre">sin(2)</span> <span class="pre">**</span> <span class="pre">2</span></code> and <code class="docutils literal notranslate"><span class="pre">cos(2)</span> <span class="pre">**</span> <span class="pre">2</span></code>
using the previously-computed results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-131-26f5e7e673c2&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">Out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>


<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-131-26f5e7e673c2&gt;[0m(1)[0;36m&lt;module&gt;[0;34m()[0m
[0;32m----&gt; 1 [0;31m[0mOut[0m[0;34m[[0m[0;36m2[0m[0;34m][0m [0;34m**[0m [0;36m2[0m [0;34m+[0m [0mOut[0m[0;34m[[0m[0;36m3[0m[0;34m][0m [0;34m**[0m [0;36m2[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; quit
</pre></div>
</div>
<p>The result is <code class="docutils literal notranslate"><span class="pre">1.0</span></code> as we’d expect from the well-known trigonometric
identity. In this case, using these previous results probably is not
necessary, but it can become very handy if you execute a very expensive
computation and want to reuse the result!</p>
</div>
<div class="section" id="underscore-shortcuts-and-previous-outputs">
<h3>Underscore Shortcuts and Previous Outputs<a class="headerlink" href="#underscore-shortcuts-and-previous-outputs" title="Permalink to this headline">¶</a></h3>
<p>The standard Python shell contains just one simple shortcut for
accessing previous output; the variable <code class="docutils literal notranslate"><span class="pre">_</span></code> (i.e., a single
underscore) is kept updated with the previous output; this works in
IPython as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">{29: 25, 30: 0.9092974268256817, 31: -0.4161468365471424, 32: -0.4161468365471424, 33: 0.9092974268256817, 49: False, 51: False, 61: ['images', 'introduction.ipynb', 'introduction.slides.html', 'jupyter-notebooks.ipynb', 'jupyter-notebooks.slides.html', 'Makefile', 'my-script.py', 'notebooks.ipynb'], 62: ['/home/mn/Developer/working-copies/pythons/on-python/UniFiCourseSpring2020'], 63: &lt;class 'IPython.utils.text.SList'&gt;, 71: '['', '__AUTHORS__ = {\'am\': (&quot;Andrea Marino&quot;, \n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),\n', 72: '['', '__AUTHORS__ = {\'am\': (&quot;Andrea Marino&quot;, \n                      &quot;<a class="reference external" href="mailto:andrea&#46;marino&#37;&#52;&#48;unifi&#46;it">andrea<span>&#46;</span>marino<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;,),\n               \'mn\': (&quot;Massimo Nocentini&quot;, \n                      &quot;<a class="reference external" href="mailto:massimo&#46;nocentini&#37;&#52;&#48;unifi&#46;it">massimo<span>&#46;</span>nocentini<span>&#64;</span>unifi<span>&#46;</span>it</a>&quot;, \n                      &quot;<a class="reference external" href="https://github.com/massimo-nocentini/">https://github.com/massimo-nocentini/</a>&quot;,)}\n\n__KEYWORDS__ = [\'Python\', \'Jupyter\', \'notebooks\', \'keynote\',]', &quot;outline = []\noutline.append('Hello!')\noutline.append('Python')\noutl</pre>
<p>But IPython takes this a bit further—you can use a double underscore to
access the second-to-last output, and a triple underscore to access the
third-to-last output (skipping any commands with no output):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">__</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">___</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mf">0.4161468365471424</span>
<span class="mf">0.9092974268256817</span>
</pre></div>
</div>
<p>IPython stops there: more than three underscores starts to get a bit
hard to count, and at that point it’s easier to refer to the output by
line number.</p>
<p>There is one more shortcut we should mention, however–a shorthand for
<code class="docutils literal notranslate"><span class="pre">Out[X]</span></code> is <code class="docutils literal notranslate"><span class="pre">_X</span></code> (i.e., a single underscore followed by the line
number):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-134-32d637638f50&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">Out</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">_2</span>


<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-134-32d637638f50&gt;[0m(1)[0;36m&lt;module&gt;[0;34m()[0m
[0;32m----&gt; 1 [0;31m[0mOut[0m[0;34m[[0m[0;36m2[0m[0;34m][0m[0;34m,[0m [0m_2[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; quit
</pre></div>
</div>
</div>
<div class="section" id="suppressing-output">
<h3>Suppressing Output<a class="headerlink" href="#suppressing-output" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you might wish to suppress the output of a statement (this is
perhaps most common with the plotting commands that we’ll explore in
<a class="reference external" href="04.00-Introduction-To-Matplotlib.ipynb">Introduction to
Matplotlib</a>). Or maybe the
command you’re executing produces a result that you’d prefer not like to
store in your output history, perhaps so that it can be deallocated when
other references are removed. The easiest way to suppress the output of
a command is to add a semicolon to the end omf the line:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p>Note that the result is computed silently, and the output is neither
displayed on the screen or stored in the <code class="docutils literal notranslate"><span class="pre">Out</span></code> dictionary:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">14</span> <span class="ow">in</span> <span class="n">Out</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
</div>
<div class="section" id="related-magic-commands">
<h3>Related Magic Commands<a class="headerlink" href="#related-magic-commands" title="Permalink to this headline">¶</a></h3>
<p>For accessing a batch of previous inputs at once, the <code class="docutils literal notranslate"><span class="pre">%history</span></code> magic
command is very helpful. Here is how you can print the first four
inputs:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">history</span> -n 1-3
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="mi">1</span><span class="p">:</span>
<span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;notebooks&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
   <span class="mi">2</span><span class="p">:</span>
<span class="n">outline</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Hello!&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Python&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Whys and refs&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;On the shoulders of giants&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Set the env up&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Notebooks&#39;</span><span class="p">)</span>
<span class="n">outline</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Course agenda&#39;</span><span class="p">)</span>
   <span class="mi">3</span><span class="p">:</span> <span class="n">help</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
<p>As usual, you can type <code class="docutils literal notranslate"><span class="pre">%history?</span></code> for more information and a
description of options available. Other similar magic commands are
<code class="docutils literal notranslate"><span class="pre">%rerun</span></code> (which will re-execute some portion of the command history)
and <code class="docutils literal notranslate"><span class="pre">%save</span></code> (which saves some set of the command history to a file).
For more information, I suggest exploring these using the <code class="docutils literal notranslate"><span class="pre">?</span></code> help
functionality discussed in <a class="reference external" href="01.01-Help-And-Documentation.ipynb">Help and Documentation in
IPython</a>.</p>
</div>
</div>
<div class="section" id="ipython-and-shell-commands">
<h2>IPython and Shell Commands<a class="headerlink" href="#ipython-and-shell-commands" title="Permalink to this headline">¶</a></h2>
<p>When working interactively with the standard Python interpreter, one of
the frustrations is the need to switch between multiple windows to
access Python tools and system command-line tools. IPython bridges this
gap, and gives you a syntax for executing shell commands directly from
within the IPython terminal. The magic happens with the exclamation
point: anything appearing after <code class="docutils literal notranslate"><span class="pre">!</span></code> on a line will be executed not by
the Python kernel, but by the system command-line.</p>
<p>The following assumes you’re on a Unix-like system, such as Linux or Mac
OSX. Some of the examples that follow will fail on Windows, which uses a
different type of shell by default (though with the 2016 announcement of
native Bash shells on Windows, soon this may no longer be an issue!). If
you’re unfamiliar with shell commands, I’d suggest reviewing the <a class="reference external" href="http://swcarpentry.github.io/shell-novice/">Shell
Tutorial</a> put together by
the always excellent Software Carpentry Foundation.</p>
<div class="section" id="quick-introduction-to-the-shell">
<h3>Quick Introduction to the Shell<a class="headerlink" href="#quick-introduction-to-the-shell" title="Permalink to this headline">¶</a></h3>
<p>A full intro to using the shell/terminal/command-line is well beyond the
scope of this chapter, but for the uninitiated we will offer a quick
introduction here. The shell is a way to interact textually with your
computer. Ever since the mid 1980s, when Microsoft and Apple introduced
the first versions of their now ubiquitous graphical operating systems,
most computer users have interacted with their operating system through
familiar clicking of menus and drag-and-drop movements. But operating
systems existed long before these graphical user interfaces, and were
primarily controlled through sequences of text input: at the prompt, the
user would type a command, and the computer would do what the user told
it to. Those early prompt systems are the precursors of the shells and
terminals that most active data scientists still use today.</p>
<p>Someone unfamiliar with the shell might ask why you would bother with
this, when many results can be accomplished by simply clicking on icons
and menus. A shell user might reply with another question: why hunt
icons and click menus when you can accomplish things much more easily by
typing? While it might sound like a typical tech preference impasse,
when moving beyond basic tasks it quickly becomes clear that the shell
offers much more control of advanced tasks, though admittedly the
learning curve can intimidate the average computer user.</p>
<p>As an example, here is a sample of a Linux/OSX shell session where a
user explores, creates, and modifies directories and files on their
system (<code class="docutils literal notranslate"><span class="pre">osx:~</span> <span class="pre">$</span></code> is the prompt, and everything after the <code class="docutils literal notranslate"><span class="pre">$</span></code> sign
is the typed command; text that is preceded by a <code class="docutils literal notranslate"><span class="pre">#</span></code> is meant just as
description, rather than something you would actually type in):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>osx:~ $ <span class="nb">echo</span> <span class="s2">&quot;hello world&quot;</span>             <span class="c1"># echo is like Python&#39;s print function</span>
hello world

osx:~ $ <span class="nb">pwd</span>                            <span class="c1"># pwd = print working directory</span>
/home/jake                             <span class="c1"># this is the &quot;path&quot; that we&#39;re sitting in</span>

osx:~ $ ls                             <span class="c1"># ls = list working directory contents</span>
notebooks  projects

osx:~ $ <span class="nb">cd</span> projects/                   <span class="c1"># cd = change directory</span>

osx:projects $ <span class="nb">pwd</span>
/home/jake/projects
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>osx:projects $ ls
datasci_book   mpld3   myproject.txt

osx:projects $ mkdir myproject          <span class="c1"># mkdir = make new directory</span>

osx:projects $ <span class="nb">cd</span> myproject/

osx:myproject $ mv ../myproject.txt ./  <span class="c1"># mv = move file. Here we&#39;re moving the</span>
                                        <span class="c1"># file myproject.txt from one directory</span>
                                        <span class="c1"># up (../) to the current directory (./)</span>
osx:myproject $ ls
myproject.txt
</pre></div>
</div>
<p>Notice that all of this is just a compact way to do familiar operations
(navigating a directory structure, creating a directory, moving a file,
etc.) by typing commands rather than clicking icons and menus. Note that
with just a few commands (<code class="docutils literal notranslate"><span class="pre">pwd</span></code>, <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">cd</span></code>, <code class="docutils literal notranslate"><span class="pre">mkdir</span></code>, and
<code class="docutils literal notranslate"><span class="pre">cp</span></code>) you can do many of the most common file operations. It’s when
you go beyond these basics that the shell approach becomes really
powerful.</p>
</div>
<div class="section" id="shell-commands-in-ipython">
<h3>Shell Commands in IPython<a class="headerlink" href="#shell-commands-in-ipython" title="Permalink to this headline">¶</a></h3>
<p>Any command that works at the command-line can be used in IPython by
prefixing it with the <code class="docutils literal notranslate"><span class="pre">!</span></code> character. For example, the <code class="docutils literal notranslate"><span class="pre">ls</span></code>, <code class="docutils literal notranslate"><span class="pre">pwd</span></code>,
and <code class="docutils literal notranslate"><span class="pre">echo</span></code> commands can be run as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">images</span>                        <span class="n">jupyter</span><span class="o">-</span><span class="n">notebooks</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">html</span>  <span class="n">notebooks</span><span class="o">.</span><span class="n">ipynb</span>
<span class="n">introduction</span><span class="o">.</span><span class="n">ipynb</span>    <span class="n">Makefile</span>                       <span class="n">__pycache__</span>
<span class="n">introduction</span><span class="o">.</span><span class="n">slides</span><span class="o">.</span><span class="n">html</span>  <span class="n">mprun_demo</span><span class="o">.</span><span class="n">py</span>                      <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="n">jupyter</span><span class="o">-</span><span class="n">notebooks</span><span class="o">.</span><span class="n">ipynb</span>   <span class="n">my</span><span class="o">-</span><span class="n">script</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pwd
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mn</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">working</span><span class="o">-</span><span class="n">copies</span><span class="o">/</span><span class="n">pythons</span><span class="o">/</span><span class="n">on</span><span class="o">-</span><span class="n">python</span><span class="o">/</span><span class="n">UniFiCourseSpring2020</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="nb">echo</span> <span class="s2">&quot;printing from the shell&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">printing</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">shell</span>
</pre></div>
</div>
</div>
<div class="section" id="passing-values-to-and-from-the-shell">
<h3>Passing Values to and from the Shell<a class="headerlink" href="#passing-values-to-and-from-the-shell" title="Permalink to this headline">¶</a></h3>
<p>Shell commands can not only be called from IPython, but can also be made
to interact with the IPython namespace. For example, you can save the
output of any shell command to a Python list using the assignment
operator:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contents</span> <span class="o">=</span> <span class="o">!</span>ls
<span class="n">contents</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">,</span>
 <span class="s1">&#39;introduction.ipynb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;introduction.slides.html&#39;</span><span class="p">,</span>
 <span class="s1">&#39;jupyter-notebooks.ipynb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;jupyter-notebooks.slides.html&#39;</span><span class="p">,</span>
 <span class="s1">&#39;Makefile&#39;</span><span class="p">,</span>
 <span class="s1">&#39;mprun_demo.py&#39;</span><span class="p">,</span>
 <span class="s1">&#39;my-script.py&#39;</span><span class="p">,</span>
 <span class="s1">&#39;notebooks.ipynb&#39;</span><span class="p">,</span>
 <span class="s1">&#39;__pycache__&#39;</span><span class="p">,</span>
 <span class="s1">&#39;requirements.txt&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="o">!</span>pwd
<span class="n">directory</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;/home/mn/Developer/working-copies/pythons/on-python/UniFiCourseSpring2020&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that these results are not returned as lists, but as a special
shell return type defined in IPython:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">IPython</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">SList</span>
</pre></div>
</div>
<p>This looks and acts a lot like a Python list, but has additional
functionality, such as the <code class="docutils literal notranslate"><span class="pre">grep</span></code> and <code class="docutils literal notranslate"><span class="pre">fields</span></code> methods and the
<code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">n</span></code>, and <code class="docutils literal notranslate"><span class="pre">p</span></code> properties that allow you to search, filter, and
display the results in convenient ways. For more information on these,
you can use IPython’s built-in help features.</p>
<p>Communication in the other direction–passing Python variables into the
shell–is possible using the <code class="docutils literal notranslate"><span class="pre">{varname}</span></code> syntax:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;hello from Python&quot;</span>
<span class="o">!</span><span class="nb">echo</span> <span class="o">{</span>message<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hello</span> <span class="kn">from</span> <span class="nn">Python</span>
</pre></div>
</div>
<p>The curly braces contain the variable name, which is replaced by the
variable’s contents in the shell command.</p>
</div>
</div>
<div class="section" id="errors-and-debugging">
<h2>Errors and Debugging<a class="headerlink" href="#errors-and-debugging" title="Permalink to this headline">¶</a></h2>
<p>Code development and data analysis always require a bit of trial and
error, and IPython contains tools to streamline this process. This
section will briefly cover some options for controlling Python’s
exception reporting, followed by exploring tools for debugging errors in
code.</p>
<div class="section" id="controlling-exceptions-xmode">
<h3>Controlling Exceptions: <code class="docutils literal notranslate"><span class="pre">%xmode</span></code><a class="headerlink" href="#controlling-exceptions-xmode" title="Permalink to this headline">¶</a></h3>
<p>Most of the time when a Python script fails, it will raise an Exception.
When the interpreter hits one of these exceptions, information about the
cause of the error can be found in the <em>traceback</em>, which can be
accessed from within Python. With the <code class="docutils literal notranslate"><span class="pre">%xmode</span></code> magic function, IPython
allows you to control the amount of information printed when the
exception is raised. Consider the following code:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">x</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-147-7cb498ea7ed1&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-146-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">7</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func2</span>
    <span class="k">return</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-146-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func1</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>


<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-146-586ccabd0db3&gt;[0m(2)[0;36mfunc1[0;34m()[0m
[0;32m      1 [0;31m[0;32mdef[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 2 [0;31m    [0;32mreturn[0m [0ma[0m [0;34m/[0m [0mb[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; quit
</pre></div>
</div>
<p>Calling <code class="docutils literal notranslate"><span class="pre">func2</span></code> results in an error, and reading the printed trace
lets us see exactly what happened. By default, this trace includes
several lines showing the context of each step that led to the error.
Using the <code class="docutils literal notranslate"><span class="pre">%xmode</span></code> magic function (short for <em>Exception mode</em>), we can
change what information is printed.</p>
<p><code class="docutils literal notranslate"><span class="pre">%xmode</span></code> takes a single argument, the mode, and there are three
possibilities: <code class="docutils literal notranslate"><span class="pre">Plain</span></code>, <code class="docutils literal notranslate"><span class="pre">Context</span></code>, and <code class="docutils literal notranslate"><span class="pre">Verbose</span></code>. The default is
<code class="docutils literal notranslate"><span class="pre">Context</span></code>, and gives output like that just shown before. <code class="docutils literal notranslate"><span class="pre">Plain</span></code> is
more compact and gives less information:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">xmode</span> Plain
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="n">reporting</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Plain</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-80-7cb498ea7ed1&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-77-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">7</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func2</span>
    <span class="k">return</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-77-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func1</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>


<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Verbose</span></code> mode adds some extra information, including the
arguments to any functions that are called:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">xmode</span> Verbose
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="n">reporting</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Verbose</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">ZeroDivisionError</span>                         <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">82</span><span class="o">-</span><span class="mi">7</span><span class="n">cb498ea7ed1</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">func2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">func2</span> <span class="n">at</span> <span class="mh">0x7fd96a3ce048</span><span class="o">&gt;</span>


<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">77</span><span class="o">-</span><span class="mi">586</span><span class="n">ccabd0db3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">func2</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
      <span class="mi">5</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">x</span>
      <span class="mi">6</span>     <span class="n">b</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="o">----&gt;</span> <span class="mi">7</span>     <span class="k">return</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">func1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n">func1</span> <span class="n">at</span> <span class="mh">0x7fd96a3ce2f0</span><span class="o">&gt;</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>


<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">77</span><span class="o">-</span><span class="mi">586</span><span class="n">ccabd0db3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
      <span class="mi">1</span> <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">2</span>     <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
        <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="mi">3</span>
      <span class="mi">4</span> <span class="k">def</span> <span class="nf">func2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
      <span class="mi">5</span>     <span class="n">a</span> <span class="o">=</span> <span class="n">x</span>


<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<p>This extra information can help narrow-in on why the exception is being
raised. So why not use the <code class="docutils literal notranslate"><span class="pre">Verbose</span></code> mode all the time? As code gets
complicated, this kind of traceback can get extremely long. Depending on
the context, sometimes the brevity of <code class="docutils literal notranslate"><span class="pre">Default</span></code> mode is easier to work
with.</p>
</div>
<div class="section" id="debugging-when-reading-tracebacks-is-not-enough">
<h3>Debugging: When Reading Tracebacks Is Not Enough<a class="headerlink" href="#debugging-when-reading-tracebacks-is-not-enough" title="Permalink to this headline">¶</a></h3>
<p>The standard Python tool for interactive debugging is <code class="docutils literal notranslate"><span class="pre">pdb</span></code>, the
Python debugger. This debugger lets the user step through the code line
by line in order to see what might be causing a more difficult error.
The IPython-enhanced version of this is <code class="docutils literal notranslate"><span class="pre">ipdb</span></code>, the IPython debugger.</p>
<p>There are many ways to launch and use both these debuggers; we won’t
cover them fully here. Refer to the online documentation of these two
utilities to learn more.</p>
<p>In IPython, perhaps the most convenient interface to debugging is the
<code class="docutils literal notranslate"><span class="pre">%debug</span></code> magic command. If you call it after hitting an exception, it
will automatically open an interactive debugging prompt at the point of
the exception. The <code class="docutils literal notranslate"><span class="pre">ipdb</span></code> prompt lets you explore the current state of
the stack, explore the available variables, and even run Python
commands!</p>
<p>Let’s look at the most recent exception, then do some basic tasks–print
the values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>, and type <code class="docutils literal notranslate"><span class="pre">quit</span></code> to quit the debugging
session:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">debug</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-77-586ccabd0db3&gt;[0m(2)[0;36mfunc1[0;34m()[0m
[0;32m      1 [0;31m[0;32mdef[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 2 [0;31m    [0;32mreturn[0m [0ma[0m [0;34m/[0m [0mb[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; print(a)
1
ipdb&gt; print(b)
0
ipdb&gt; quit
</pre></div>
</div>
<p>The interactive debugger allows much more than this, though–we can even
step up and down through the stack and explore the values of variables
there:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">debug</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-77-586ccabd0db3&gt;[0m(2)[0;36mfunc1[0;34m()[0m
[0;32m      1 [0;31m[0;32mdef[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 2 [0;31m    [0;32mreturn[0m [0ma[0m [0;34m/[0m [0mb[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; up
&gt; [0;32m&lt;ipython-input-77-586ccabd0db3&gt;[0m(7)[0;36mfunc2[0;34m()[0m
[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      6 [0;31m    [0mb[0m [0;34m=[0m [0mx[0m [0;34m-[0m [0;36m1[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 7 [0;31m    [0;32mreturn[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; print(x)
1
ipdb&gt; up
&gt; [0;32m&lt;ipython-input-82-7cb498ea7ed1&gt;[0m(1)[0;36m&lt;module&gt;[0;34m()[0m
[0;32m----&gt; 1 [0;31m[0mfunc2[0m[0;34m([0m[0;36m1[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; down
&gt; [0;32m&lt;ipython-input-77-586ccabd0db3&gt;[0m(7)[0;36mfunc2[0;34m()[0m
[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      6 [0;31m    [0mb[0m [0;34m=[0m [0mx[0m [0;34m-[0m [0;36m1[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 7 [0;31m    [0;32mreturn[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; quit
</pre></div>
</div>
<p>This allows you to quickly find out not only what caused the error, but
what function calls led up to the error.</p>
<p>If you’d like the debugger to launch automatically whenever an exception
is raised, you can use the <code class="docutils literal notranslate"><span class="pre">%pdb</span></code> magic function to turn on this
automatic behavior:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">xmode</span> Plain
<span class="o">%</span><span class="k">pdb</span> on
<span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="n">reporting</span> <span class="n">mode</span><span class="p">:</span> <span class="n">Plain</span>
<span class="n">Automatic</span> <span class="n">pdb</span> <span class="n">calling</span> <span class="n">has</span> <span class="n">been</span> <span class="n">turned</span> <span class="n">ON</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-85-f80f6b5cecf3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">3</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
    <span class="n">func2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-77-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">7</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func2</span>
    <span class="k">return</span> <span class="n">func1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>


  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-77-586ccabd0db3&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="n">func1</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>


<span class="ne">ZeroDivisionError</span><span class="p">:</span> <span class="n">division</span> <span class="n">by</span> <span class="n">zero</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; [0;32m&lt;ipython-input-77-586ccabd0db3&gt;[0m(2)[0;36mfunc1[0;34m()[0m
[0;32m      1 [0;31m[0;32mdef[0m [0mfunc1[0m[0;34m([0m[0ma[0m[0;34m,[0m [0mb[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m----&gt; 2 [0;31m    [0;32mreturn[0m [0ma[0m [0;34m/[0m [0mb[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      3 [0;31m[0;34m[0m[0m
[0m[0;32m      4 [0;31m[0;32mdef[0m [0mfunc2[0m[0;34m([0m[0mx[0m[0;34m)[0m[0;34m:[0m[0;34m[0m[0;34m[0m[0m
[0m[0;32m      5 [0;31m    [0ma[0m [0;34m=[0m [0mx[0m[0;34m[0m[0;34m[0m[0m
[0m
ipdb&gt; print(b)
0
ipdb&gt; quit
</pre></div>
</div>
<p>Finally, if you have a script that you’d like to run from the beginning
in interactive mode, you can run it with the command <code class="docutils literal notranslate"><span class="pre">%run</span> <span class="pre">-d</span></code>, and
use the <code class="docutils literal notranslate"><span class="pre">next</span></code> command to step through the lines of code
interactively.</p>
<div class="section" id="partial-list-of-debugging-commands">
<h4>Partial list of debugging commands<a class="headerlink" href="#partial-list-of-debugging-commands" title="Permalink to this headline">¶</a></h4>
<p>There are many more available commands for interactive debugging than
we’ve listed here; the following table contains a description of some of
the more common and useful ones:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
<td><p>Show the current location in the file</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h(elp)</span></code></p></td>
<td><p>Show a list of commands, or find help on a
specific command</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">q(uit)</span></code></p></td>
<td><p>Quit the debugger and the program</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">c(ontinue)</span></code></p></td>
<td><p>Quit the debugger, continue in the program</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">n(ext)</span></code></p></td>
<td><p>Go to the next step of the program</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">&lt;enter&gt;</span></code></p></td>
<td><p>Repeat the previous command</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">p(rint)</span></code></p></td>
<td><p>Print variables</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">s(tep)</span></code></p></td>
<td><p>Step into a subroutine</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r(eturn)</span></code></p></td>
<td><p>Return out of a subroutine</p></td>
</tr>
</tbody>
</table>
<p>For more information, use the <code class="docutils literal notranslate"><span class="pre">help</span></code> command in the debugger, or take
a look at <code class="docutils literal notranslate"><span class="pre">ipdb</span></code>’s <a class="reference external" href="https://github.com/gotcha/ipdb">online
documentation</a>.</p>
</div>
</div>
</div>
<div class="section" id="profiling-and-timing-code">
<h2>Profiling and Timing Code<a class="headerlink" href="#profiling-and-timing-code" title="Permalink to this headline">¶</a></h2>
<p>In the process of developing code and creating data processing
pipelines, there are often trade-offs you can make between various
implementations. Early in developing your algorithm, it can be
counterproductive to worry about such things. As Donald Knuth famously
quipped, “We should forget about small efficiencies, say about 97% of
the time: premature optimization is the root of all evil.”</p>
<p>But once you have your code working, it can be useful to dig into its
efficiency a bit. Sometimes it’s useful to check the execution time of a
given command or set of commands; other times it’s useful to dig into a
multiline process and determine where the bottleneck lies in some
complicated series of operations. IPython provides access to a wide
array of functionality for this kind of timing and profiling of code.
Here we’ll discuss the following IPython magic commands:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%time</span></code>: Time the execution of a single statement</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%timeit</span></code>: Time repeated execution of a single statement for more
accuracy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%prun</span></code>: Run code with the profiler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%lprun</span></code>: Run code with the line-by-line profiler</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%memit</span></code>: Measure the memory use of a single statement</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%mprun</span></code>: Run code with the line-by-line memory profiler</p></li>
</ul>
<p>The last four commands are not bundled with IPython–you’ll need to get
the <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code> and <code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code> extensions, which we will
discuss in the following sections.</p>
<div class="section" id="timing-code-snippets-timeit-and-time">
<h3>Timing Code Snippets: <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> and <code class="docutils literal notranslate"><span class="pre">%time</span></code><a class="headerlink" href="#timing-code-snippets-timeit-and-time" title="Permalink to this headline">¶</a></h3>
<p>We saw the <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> line-magic and <code class="docutils literal notranslate"><span class="pre">%%timeit</span></code> cell-magic in the
introduction to magic functions in <a class="reference external" href="01.03-Magic-Commands.ipynb">IPython Magic
Commands</a>; it can be used to time the
repeated execution of snippets of code:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> sum(range(100))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.3 µs ± 7.05 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</pre></div>
</div>
<p>Note that because this operation is so fast, <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> automatically
does a large number of repetitions.</p>
<p>For slower commands, <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> will automatically adjust and perform
fewer repetitions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">j</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>368 ms ± 3.52 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
<p>Sometimes repeating an operation is not the best option. For example, if
we have a list that we’d like to sort, we might be misled by a repeated
operation. Sorting a pre-sorted list is much faster than sorting an
unsorted list, so the repetition will skew the result:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">)]</span>
<span class="o">%</span><span class="k">timeit</span> L.sort()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>693 µs ± 39.3 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>For this, the <code class="docutils literal notranslate"><span class="pre">%time</span></code> magic function may be a better choice. It also
is a good choice for longer-running commands, when short, system-related
delays are unlikely to affect the result. Let’s time the sorting of an
unsorted and a presorted list:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sorting an unsorted list:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> L.sort()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sorting</span> <span class="n">an</span> <span class="n">unsorted</span> <span class="nb">list</span><span class="p">:</span>
<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">24</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">0</span> <span class="n">ns</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">24</span> <span class="n">ms</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">23.7</span> <span class="n">ms</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sorting an already sorted list:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">time</span> L.sort()
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sorting</span> <span class="n">an</span> <span class="n">already</span> <span class="nb">sorted</span> <span class="nb">list</span><span class="p">:</span>
<span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mf">1.19</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">19</span> <span class="n">µs</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mf">1.21</span> <span class="n">ms</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mf">1.22</span> <span class="n">ms</span>
</pre></div>
</div>
<p>Notice how much faster the presorted list is to sort, but notice also
how much longer the timing takes with <code class="docutils literal notranslate"><span class="pre">%time</span></code> versus <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>, even
for the presorted list! This is a result of the fact that <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>
does some clever things under the hood to prevent system calls from
interfering with the timing. For example, it prevents cleanup of unused
Python objects (known as <em>garbage collection</em>) which might otherwise
affect the timing. For this reason, <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> results are usually
noticeably faster than <code class="docutils literal notranslate"><span class="pre">%time</span></code> results.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">%time</span></code> as with <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>, using the double-percent-sign cell
magic syntax allows timing of multiline scripts:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="n">j</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CPU</span> <span class="n">times</span><span class="p">:</span> <span class="n">user</span> <span class="mi">465</span> <span class="n">ms</span><span class="p">,</span> <span class="n">sys</span><span class="p">:</span> <span class="mi">0</span> <span class="n">ns</span><span class="p">,</span> <span class="n">total</span><span class="p">:</span> <span class="mi">465</span> <span class="n">ms</span>
<span class="n">Wall</span> <span class="n">time</span><span class="p">:</span> <span class="mi">464</span> <span class="n">ms</span>
</pre></div>
</div>
<p>For more information on <code class="docutils literal notranslate"><span class="pre">%time</span></code> and <code class="docutils literal notranslate"><span class="pre">%timeit</span></code>, as well as their
available options, use the IPython help functionality (i.e., type
<code class="docutils literal notranslate"><span class="pre">%time?</span></code> at the IPython prompt).</p>
</div>
<div class="section" id="profiling-full-scripts-prun">
<h3>Profiling Full Scripts: <code class="docutils literal notranslate"><span class="pre">%prun</span></code><a class="headerlink" href="#profiling-full-scripts-prun" title="Permalink to this headline">¶</a></h3>
<p>A program is made of many single statements, and sometimes timing these
statements in context is more important than timing them on their own.
Python contains a built-in code profiler (which you can read about in
the Python documentation), but IPython offers a much more convenient way
to use this profiler, in the form of the magic function <code class="docutils literal notranslate"><span class="pre">%prun</span></code>.</p>
<p>By way of example, we’ll define a simple function that does some
calculations:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sum_of_lists</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="o">^</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>
</div>
<p>Now we can call <code class="docutils literal notranslate"><span class="pre">%prun</span></code> with a function call to see the profiled
results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">prun</span> sum_of_lists(1000000)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">14</span> <span class="n">function</span> <span class="n">calls</span> <span class="ow">in</span> <span class="mf">0.705</span> <span class="n">seconds</span>

   <span class="n">Ordered</span> <span class="n">by</span><span class="p">:</span> <span class="n">internal</span> <span class="n">time</span>

   <span class="n">ncalls</span>  <span class="n">tottime</span>  <span class="n">percall</span>  <span class="n">cumtime</span>  <span class="n">percall</span> <span class="n">filename</span><span class="p">:</span><span class="n">lineno</span><span class="p">(</span><span class="n">function</span><span class="p">)</span>
        <span class="mi">5</span>    <span class="mf">0.614</span>    <span class="mf">0.123</span>    <span class="mf">0.614</span>    <span class="mf">0.123</span> <span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">95</span><span class="o">-</span><span class="n">f105717832a2</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">4</span><span class="p">(</span><span class="o">&lt;</span><span class="n">listcomp</span><span class="o">&gt;</span><span class="p">)</span>
        <span class="mi">5</span>    <span class="mf">0.043</span>    <span class="mf">0.009</span>    <span class="mf">0.043</span>    <span class="mf">0.009</span> <span class="p">{</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">method</span> <span class="n">builtins</span><span class="o">.</span><span class="n">sum</span><span class="p">}</span>
        <span class="mi">1</span>    <span class="mf">0.036</span>    <span class="mf">0.036</span>    <span class="mf">0.693</span>    <span class="mf">0.693</span> <span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">95</span><span class="o">-</span><span class="n">f105717832a2</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">(</span><span class="n">sum_of_lists</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.012</span>    <span class="mf">0.012</span>    <span class="mf">0.705</span>    <span class="mf">0.705</span> <span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">(</span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">)</span>
        <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.705</span>    <span class="mf">0.705</span> <span class="p">{</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">method</span> <span class="n">builtins</span><span class="o">.</span><span class="n">exec</span><span class="p">}</span>
        <span class="mi">1</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span>    <span class="mf">0.000</span> <span class="p">{</span><span class="n">method</span> <span class="s1">&#39;disable&#39;</span> <span class="n">of</span> <span class="s1">&#39;_lsprof.Profiler&#39;</span> <span class="n">objects</span><span class="p">}</span>
</pre></div>
</div>
<p>The result is a table that indicates, in order of total time on each
function call, where the execution is spending the most time. In this
case, the bulk of execution time is in the list comprehension inside
<code class="docutils literal notranslate"><span class="pre">sum_of_lists</span></code>. From here, we could start thinking about what changes
we might make to improve the performance in the algorithm.</p>
<p>For more information on <code class="docutils literal notranslate"><span class="pre">%prun</span></code>, as well as its available options, use
the IPython help functionality (i.e., type <code class="docutils literal notranslate"><span class="pre">%prun?</span></code> at the IPython
prompt).</p>
</div>
<div class="section" id="line-by-line-profiling-with-lprun">
<h3>Line-By-Line Profiling with <code class="docutils literal notranslate"><span class="pre">%lprun</span></code><a class="headerlink" href="#line-by-line-profiling-with-lprun" title="Permalink to this headline">¶</a></h3>
<p>The function-by-function profiling of <code class="docutils literal notranslate"><span class="pre">%prun</span></code> is useful, but sometimes
it’s more convenient to have a line-by-line profile report. This is not
built into Python or IPython, but there is a <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code> package
available for installation that can do this. Start by using Python’s
packaging tool, <code class="docutils literal notranslate"><span class="pre">pip</span></code>, to install the <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code> package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install line_profiler
</pre></div>
</div>
<p>Next, you can use IPython to load the <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code> IPython
extension, offered as part of this package:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> line_profiler
</pre></div>
</div>
<p>Now the <code class="docutils literal notranslate"><span class="pre">%lprun</span></code> command will do a line-by-line profiling of any
function–in this case, we need to tell it explicitly which functions
we’re interested in profiling:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">lprun</span> -f sum_of_lists sum_of_lists(5000)
</pre></div>
</div>
<p>``` Timer unit: 1e-06 s</p>
<p>Total time: 0.006239 s File:
/home/mn/Developer/working-copies/pythons/on-python/UniFiCourseSpring2020/mprun_demo.py
Function: sum_of_lists at line 1</p>
</div>
</div>
<div class="section" id="line-hits-time-per-hit-time-line-contents">
<h2>Line # Hits Time Per Hit % Time Line Contents<a class="headerlink" href="#line-hits-time-per-hit-time-line-contents" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1                                           def sum_of_lists(N):
2         1          2.0      2.0      0.0      total = 0
3         6          6.0      1.0      0.1      for i in range(5):
4         5       5869.0   1173.8     94.1          L = [j ^ (j &gt;&gt; i) for j in range(N)]
5         5        218.0     43.6      3.5          total += sum(L)
6         5        144.0     28.8      2.3          del L # remove reference to L
7         1          0.0      0.0      0.0      return total```
</pre></div>
</div>
<p>The result is a table that indicates, in order of total time on each
function call, where the execution is spending the most time. In this
case, the bulk of execution time is in the list comprehension inside
<code class="docutils literal notranslate"><span class="pre">sum_of_lists</span></code>. From here, we could start thinking about what changes
we might make to improve the performance in the algorithm.</p>
<p>For more information on <code class="docutils literal notranslate"><span class="pre">%prun</span></code>, as well as its available options, use
the IPython help functionality (i.e., type <code class="docutils literal notranslate"><span class="pre">%prun?</span></code> at the IPython
prompt).</p>
<div class="section" id="profiling-memory-use-memit-and-mprun">
<h3>Profiling Memory Use: <code class="docutils literal notranslate"><span class="pre">%memit</span></code> and <code class="docutils literal notranslate"><span class="pre">%mprun</span></code><a class="headerlink" href="#profiling-memory-use-memit-and-mprun" title="Permalink to this headline">¶</a></h3>
<p>Another aspect of profiling is the amount of memory an operation uses.
This can be evaluated with another IPython extension, the
<code class="docutils literal notranslate"><span class="pre">memory_profiler</span></code>. As with the <code class="docutils literal notranslate"><span class="pre">line_profiler</span></code>, we start by
<code class="docutils literal notranslate"><span class="pre">pip</span></code>-installing the extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install memory_profiler
</pre></div>
</div>
<p>Then we can use IPython to load the extension:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> memory_profiler
</pre></div>
</div>
<p>The memory profiler extension contains two useful magic functions: the
<code class="docutils literal notranslate"><span class="pre">%memit</span></code> magic (which offers a memory-measuring equivalent of
<code class="docutils literal notranslate"><span class="pre">%timeit</span></code>) and the <code class="docutils literal notranslate"><span class="pre">%mprun</span></code> function (which offers a
memory-measuring equivalent of <code class="docutils literal notranslate"><span class="pre">%lprun</span></code>). The <code class="docutils literal notranslate"><span class="pre">%memit</span></code> function can
be used rather simply:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">memit</span> sum_of_lists(1000000)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peak</span> <span class="n">memory</span><span class="p">:</span> <span class="mf">106.86</span> <span class="n">MiB</span><span class="p">,</span> <span class="n">increment</span><span class="p">:</span> <span class="mf">28.78</span> <span class="n">MiB</span>
</pre></div>
</div>
<p>We see that this function uses about 100 MB of memory.</p>
<p>For a line-by-line description of memory use, we can use the <code class="docutils literal notranslate"><span class="pre">%mprun</span></code>
magic. Unfortunately, this magic works only for functions defined in
separate modules rather than the notebook itself, so we’ll start by
using the <code class="docutils literal notranslate"><span class="pre">%%file</span></code> magic to create a simple module called
<code class="docutils literal notranslate"><span class="pre">mprun_demo.py</span></code>, which contains our <code class="docutils literal notranslate"><span class="pre">sum_of_lists</span></code> function, with
one addition that will make our memory profiling results more clear:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%file</span> mprun_demo.py
<span class="k">def</span> <span class="nf">sum_of_lists</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="o">^</span> <span class="p">(</span><span class="n">j</span> <span class="o">&gt;&gt;</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
        <span class="k">del</span> <span class="n">L</span> <span class="c1"># remove reference to L</span>
    <span class="k">return</span> <span class="n">total</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Overwriting</span> <span class="n">mprun_demo</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>We can now import the new version of this function and run the memory
line profiler:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mprun_demo</span> <span class="kn">import</span> <span class="n">sum_of_lists</span>
<span class="o">%</span><span class="k">mprun</span> -f sum_of_lists sum_of_lists(1000000)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">***</span> <span class="ne">KeyboardInterrupt</span> <span class="n">exception</span> <span class="n">caught</span> <span class="ow">in</span> <span class="n">code</span> <span class="n">being</span> <span class="n">profiled</span><span class="o">.</span>
</pre></div>
</div>
<p>``` Filename:
/home/mn/Developer/working-copies/pythons/on-python/UniFiCourseSpring2020/mprun_demo.py</p>
</div>
</div>
<div class="section" id="line-mem-usage-increment-line-contents">
<h2>Line # Mem usage Increment Line Contents<a class="headerlink" href="#line-mem-usage-increment-line-contents" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1     85.2 MiB     85.2 MiB   def sum_of_lists(N):
2     85.2 MiB      0.0 MiB       total = 0
3     85.2 MiB      0.0 MiB       for i in range(5):
4    112.2 MiB      0.2 MiB           L = [j ^ (j &gt;&gt; i) for j in range(N)]
5    112.2 MiB      0.0 MiB           total += sum(L)
6     85.2 MiB      0.0 MiB           del L # remove reference to L
7                                 return total```
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">Increment</span></code> column tells us how much each line affects the
total memory budget: observe that when we create and delete the list
<code class="docutils literal notranslate"><span class="pre">L</span></code>, we are adding about 25 MB of memory usage. This is on top of the
background memory usage from the Python interpreter itself.</p>
<p>For more information on <code class="docutils literal notranslate"><span class="pre">%memit</span></code> and <code class="docutils literal notranslate"><span class="pre">%mprun</span></code>, as well as their
available options, use the IPython help functionality (i.e., type
<code class="docutils literal notranslate"><span class="pre">%memit?</span></code> at the IPython prompt).</p>
</div>
</div>
<div class="section" id="numpy-module">
<h1><code class="docutils literal notranslate"><span class="pre">numpy</span></code> module<a class="headerlink" href="#numpy-module" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. February 26, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract These slides outline techniques for effectively loading,
storing, and manipulating in-memory data in Python.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;numerical&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="introduction-to-numpy">
<h2>Introduction to NumPy<a class="headerlink" href="#introduction-to-numpy" title="Permalink to this headline">¶</a></h2>
<p>The topic is very broad: datasets can come from a wide range of sources
and a wide range of formats, including be collections of documents,
collections of images, collections of sound clips, collections of
numerical measurements, or nearly anything else. Despite this apparent
heterogeneity, it will help us to think of all data fundamentally as
arrays of numbers.</p>
<p>For this reason, efficient storage and manipulation of numerical arrays
is absolutely fundamental to the process of doing data science.</p>
<p>NumPy (short for <em>Numerical Python</em>) provides an efficient interface to
store and operate on dense data buffers. In some ways, NumPy arrays are
like Python’s built-in <code class="docutils literal notranslate"><span class="pre">list</span></code> type, but NumPy arrays provide much more
efficient storage and data operations as the arrays grow larger in size.
NumPy arrays form the core of nearly the entire ecosystem of data
science tools in Python, so time spent learning to use NumPy effectively
will be valuable no matter what aspect of data science interests you.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;1.18.1&#39;</span>
</pre></div>
</div>
<p>By convention, you’ll find that most people in the SciPy/PyData world
will import NumPy using <code class="docutils literal notranslate"><span class="pre">np</span></code> as an alias:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Throughout this chapter, and indeed the rest of the book, you’ll find
that this is the way we will import and use NumPy.</p>
</div>
<div class="section" id="understanding-data-types-in-python">
<h2>Understanding Data Types in Python<a class="headerlink" href="#understanding-data-types-in-python" title="Permalink to this headline">¶</a></h2>
<p>Effective data-driven science and computation requires understanding how
data is stored and manipulated.</p>
<p>Here we outlines and contrasts how arrays of data are handled in the
Python language itself, and how NumPy improves on this.</p>
<p>Python offers several different options for storing data in efficient,
fixed-type data buffers. The built-in <code class="docutils literal notranslate"><span class="pre">array</span></code> module (available since
Python 3.3) can be used to create dense arrays of a uniform type:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">array</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>Here <code class="docutils literal notranslate"><span class="pre">'i'</span></code> is a type code indicating the contents are integers.</p>
<p>Much more useful, however, is the <code class="docutils literal notranslate"><span class="pre">ndarray</span></code> object of the NumPy
package. While Python’s <code class="docutils literal notranslate"><span class="pre">array</span></code> object provides efficient storage of
array-based data, NumPy adds to this efficient <em>operations</em> on that
data.</p>
<div class="section" id="creating-arrays-from-python-lists">
<h3>Creating Arrays from Python Lists<a class="headerlink" href="#creating-arrays-from-python-lists" title="Permalink to this headline">¶</a></h3>
<p>First, we can use <code class="docutils literal notranslate"><span class="pre">np.array</span></code> to create arrays from Python lists:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Remember that unlike Python lists, NumPy is constrained to arrays that
all contain the same type. If types do not match, NumPy will upcast if
possible (here, integers are up-cast to floating point):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">4.</span>  <span class="p">,</span> <span class="mf">2.</span>  <span class="p">,</span> <span class="mf">3.</span>  <span class="p">])</span>
</pre></div>
</div>
<p>If we want to explicitly set the data type of the resulting array, we
can use the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">4.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="creating-arrays-from-scratch">
<h3>Creating Arrays from Scratch<a class="headerlink" href="#creating-arrays-from-scratch" title="Permalink to this headline">¶</a></h3>
<p>Especially for larger arrays, it is more efficient to create arrays from
scratch using routines built into NumPy:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mf">3.14</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">,</span> <span class="mf">3.14</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span>  <span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span> <span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.</span>  <span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">0.49760049</span><span class="p">,</span> <span class="mf">0.67705904</span><span class="p">,</span> <span class="mf">0.59093804</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.99268699</span><span class="p">,</span> <span class="mf">0.42792808</span><span class="p">,</span> <span class="mf">0.8336333</span> <span class="p">],</span>
       <span class="p">[</span><span class="mf">0.44928886</span><span class="p">,</span> <span class="mf">0.70924885</span><span class="p">,</span> <span class="mf">0.1681015</span> <span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">0.84044642</span><span class="p">,</span>  <span class="mf">1.54753956</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.023514</span>  <span class="p">],</span>
       <span class="p">[</span> <span class="mf">1.09749938</span><span class="p">,</span>  <span class="mf">0.70455525</span><span class="p">,</span>  <span class="mf">0.57204258</span><span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.47691043</span><span class="p">,</span>  <span class="mf">0.89482679</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.07735954</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="numpy-standard-data-types">
<h3>NumPy Standard Data Types<a class="headerlink" href="#numpy-standard-data-types" title="Permalink to this headline">¶</a></h3>
<p>NumPy arrays contain values of a single type, so have a look at those
types and their bounds:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 54%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data type</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bool_</span></code></p></td>
<td><p>Boolean (True or False) stored
as a byte</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int_</span></code></p></td>
<td><p>Default integer type (same as
C <code class="docutils literal notranslate"><span class="pre">long</span></code>; normally either
<code class="docutils literal notranslate"><span class="pre">int64</span></code> or <code class="docutils literal notranslate"><span class="pre">int32</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">intc</span></code></p></td>
<td><p>Identical to C <code class="docutils literal notranslate"><span class="pre">int</span></code>
(normally <code class="docutils literal notranslate"><span class="pre">int32</span></code> or
<code class="docutils literal notranslate"><span class="pre">int64</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">intp</span></code></p></td>
<td><p>Integer used for indexing
(same as C <code class="docutils literal notranslate"><span class="pre">ssize_t</span></code>;
normally either <code class="docutils literal notranslate"><span class="pre">int32</span></code> or
<code class="docutils literal notranslate"><span class="pre">int64</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int8</span></code></p></td>
<td><p>Byte (-128 to 127)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int16</span></code></p></td>
<td><p>Integer (-32768 to 32767)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">int32</span></code></p></td>
<td><p>Integer (-2147483648 to
2147483647)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">int64</span></code></p></td>
<td><p>Integer (-9223372036854775808
to 9223372036854775807)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint8</span></code></p></td>
<td><p>Unsigned integer (0 to 255)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint16</span></code></p></td>
<td><p>Unsigned integer (0 to 65535)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">uint32</span></code></p></td>
<td><p>Unsigned integer (0 to
4294967295)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">uint64</span></code></p></td>
<td><p>Unsigned integer (0 to
18446744073709551615)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float_</span></code></p></td>
<td><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">float64</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float16</span></code></p></td>
<td><p>Half precision float: sign
bit, 5 bits exponent, 10 bits
mantissa</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">float32</span></code></p></td>
<td><p>Single precision float: sign
bit, 8 bits exponent, 23 bits
mantissa</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
<td><p>Double precision float: sign
bit, 11 bits exponent, 52 bits
mantissa</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex_</span></code></p></td>
<td><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">complex128</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">complex64</span></code></p></td>
<td><p>Complex number, represented by
two 32-bit floats</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">complex128</span></code></p></td>
<td><p>Complex number, represented by
two 64-bit floats</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="the-basics-of-numpy-arrays">
<h2>The Basics of NumPy Arrays<a class="headerlink" href="#the-basics-of-numpy-arrays" title="Permalink to this headline">¶</a></h2>
<p>Data manipulation in Python is nearly synonymous with NumPy array
manipulation: even newer tools like Pandas are built around the NumPy
array.</p>
<ul class="simple">
<li><p><em>Attributes of arrays</em>: Determining the size, shape, memory
consumption, and data types of arrays</p></li>
<li><p><em>Indexing of arrays</em>: Getting and setting the value of individual
array elements</p></li>
<li><p><em>Slicing of arrays</em>: Getting and setting smaller subarrays within a
larger array</p></li>
<li><p><em>Reshaping of arrays</em>: Changing the shape of a given array</p></li>
<li><p><em>Joining and splitting of arrays</em>: Combining multiple arrays into
one, and splitting one array into many</p></li>
</ul>
<div class="section" id="numpy-array-attributes">
<h3>NumPy Array Attributes<a class="headerlink" href="#numpy-array-attributes" title="Permalink to this headline">¶</a></h3>
<p>First let’s discuss some useful array attributes. We’ll start by
defining three random arrays, a one-dimensional, two-dimensional, and
three-dimensional array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># seed for reproducibility</span>

<span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># One-dimensional array</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>  <span class="c1"># Two-dimensional array</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>  <span class="c1"># Three-dimensional array</span>
</pre></div>
</div>
<p>Each array has attributes <code class="docutils literal notranslate"><span class="pre">ndim</span></code> (the number of dimensions), <code class="docutils literal notranslate"><span class="pre">shape</span></code>
(the size of each dimension), <code class="docutils literal notranslate"><span class="pre">size</span></code> (the total size of the array) and
<code class="docutils literal notranslate"><span class="pre">dtype</span></code> (the data type of the array):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x3 ndim: &quot;</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x3 shape:&quot;</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x3 size: &quot;</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dtype:&quot;</span><span class="p">,</span> <span class="n">x3</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x3</span> <span class="n">ndim</span><span class="p">:</span>  <span class="mi">3</span>
<span class="n">x3</span> <span class="n">shape</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">x3</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">60</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="array-indexing-accessing-single-elements">
<h3>Array Indexing: Accessing Single Elements<a class="headerlink" href="#array-indexing-accessing-single-elements" title="Permalink to this headline">¶</a></h3>
<p>In a one-dimensional array, the <span class="math notranslate nohighlight">\(i^{th}\)</span> value (counting from
zero) can be accessed by specifying the desired index in square
brackets, just as with Python lists:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># To index from the end of the array, you can use negative indices.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span>
</pre></div>
</div>
<p>In a multi-dimensional array, items can be accessed using a
comma-separated tuple of indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
<p>Values can also be modified using any of the above index notation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p>Keep in mind that, unlike Python lists, NumPy arrays have a fixed type.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.14159</span>  <span class="c1"># this will be truncated!</span>
<span class="n">x1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="array-slicing-accessing-subarrays">
<h3>Array Slicing: Accessing Subarrays<a class="headerlink" href="#array-slicing-accessing-subarrays" title="Permalink to this headline">¶</a></h3>
<p>Just as we can use square brackets to access individual array elements,
we can also use them to access subarrays with the <em>slice</em> notation,
marked by the colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) character.</p>
<p>The NumPy slicing syntax follows that of the standard Python list; to
access a slice of an array <code class="docutils literal notranslate"><span class="pre">x</span></code>, use this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">stop</span><span class="p">:</span><span class="n">step</span><span class="p">]</span>
</pre></div>
</div>
<p>If any of these are unspecified, they default to the values <code class="docutils literal notranslate"><span class="pre">start=0</span></code>,
<code class="docutils literal notranslate"><span class="pre">stop=</span></code><em>``size of dimension``</em>, <code class="docutils literal notranslate"><span class="pre">step=1</span></code>.</p>
<div class="section" id="one-dimensional-subarrays">
<h4>One-dimensional subarrays<a class="headerlink" href="#one-dimensional-subarrays" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>  <span class="c1"># first five elements</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>  <span class="c1"># elements after index 5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>  <span class="c1"># middle sub-array</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># every other element</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># every other element, starting at index 1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>A potentially confusing case is when the <code class="docutils literal notranslate"><span class="pre">step</span></code> value is negative. In
this case, the defaults for <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">stop</span></code> are swapped. This
becomes a convenient way to reverse an array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># all elements, reversed</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="mi">5</span><span class="p">::</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># reversed every other from index 5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-dimensional-subarrays">
<h4>Multi-dimensional subarrays<a class="headerlink" href="#multi-dimensional-subarrays" title="Permalink to this headline">¶</a></h4>
<p>Multi-dimensional slices work in the same way, with multiple slices
separated by commas:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># two rows, three columns</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># all rows, every other column</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="accessing-array-rows-and-columns">
<h5>Accessing array rows and columns<a class="headerlink" href="#accessing-array-rows-and-columns" title="Permalink to this headline">¶</a></h5>
<p>One commonly needed routine is accessing of single rows or columns of an
array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># first column of x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">7</span>  <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># first row of x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># equivalent to x2[0, :]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">12</span>  <span class="mi">5</span>  <span class="mi">2</span>  <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="subarrays-as-no-copy-views">
<h4>Subarrays as no-copy views<a class="headerlink" href="#subarrays-as-no-copy-views" title="Permalink to this headline">¶</a></h4>
<p>One important–and extremely useful–thing to know about array slices is
that they return <em>views</em> rather than <em>copies</em> of the array data.</p>
<p>This is one area in which NumPy array slicing differs from Python list
slicing: in lists, slices will be copies.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2_sub</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
<span class="n">x2_sub</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">12</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2_sub</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span> <span class="c1"># if we modify this subarray, the original array is changed too</span>
<span class="n">x2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">99</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">7</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">7</span><span class="p">]])</span>
</pre></div>
</div>
<p>It is sometimes useful to instead explicitly copy the data within an
array or a subarray. This can be most easily done with the <code class="docutils literal notranslate"><span class="pre">copy()</span></code>
method.</p>
</div>
</div>
<div class="section" id="reshaping-of-arrays">
<h3>Reshaping of Arrays<a class="headerlink" href="#reshaping-of-arrays" title="Permalink to this headline">¶</a></h3>
<p>If you want to put the numbers 1 through 9 in a <span class="math notranslate nohighlight">\(3 \times 3\)</span> grid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span> <span class="c1"># row vector via reshape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># row vector via newaxis</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="c1"># column vector via reshape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="c1"># column vector via newaxis</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">3</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="concatenation-of-arrays">
<h4>Concatenation of arrays<a class="headerlink" href="#concatenation-of-arrays" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> takes a tuple or list of arrays as its first
argument:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="p">[</span><span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">grid</span><span class="p">,</span> <span class="n">grid</span><span class="p">])</span> <span class="c1"># concatenate along the first axis</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">grid</span><span class="p">,</span> <span class="n">grid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># concatenate along the second axis (zero-indexed)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>For working with arrays of mixed dimensions, it can be clearer to use
the <code class="docutils literal notranslate"><span class="pre">np.vstack</span></code> (vertical stack) and <code class="docutils literal notranslate"><span class="pre">np.hstack</span></code> (horizontal stack)
functions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>

<span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">grid</span><span class="p">])</span> <span class="c1"># vertically stack the arrays</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">99</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">99</span><span class="p">]])</span>
<span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">grid</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span> <span class="c1"># horizontally stack the arrays</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">9</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="mi">99</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="splitting-of-arrays">
<h4>Splitting of arrays<a class="headerlink" href="#splitting-of-arrays" title="Permalink to this headline">¶</a></h4>
<p>The opposite of concatenation is splitting, we can pass a list of
indices giving the split points:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">99</span><span class="p">]</span> <span class="p">[</span><span class="mi">3</span> <span class="mi">2</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">grid</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">vsplit</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]),</span>
 <span class="n">array</span><span class="p">([[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">hsplit</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]]),</span>
 <span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
        <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="computation-on-numpy-arrays-universal-functions">
<h2>Computation on NumPy Arrays: Universal Functions<a class="headerlink" href="#computation-on-numpy-arrays-universal-functions" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Numpy</span></code> provides an easy and flexible interface to optimized
computation with arrays of data.</p>
<p>The key to making it fast is to use <em>vectorized</em> operations, generally
implemented through NumPy’s <em>universal functions</em> (ufuncs).</p>
<div class="section" id="the-slowness-of-loops">
<h3>The Slowness of Loops<a class="headerlink" href="#the-slowness-of-loops" title="Permalink to this headline">¶</a></h3>
<p>Python’s default implementation (known as CPython) does some operations
very slowly, this is in part due to the dynamic, interpreted nature of
the language.</p>
<p>The relative sluggishness of Python generally manifests itself in
situations where many small operations are being repeated – for instance
looping over arrays to operate on each element.</p>
<p>For example, pretend to compute the reciprocal of values contained in a
array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">compute_reciprocals</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
        <span class="n">output</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">output</span>

<span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">compute_reciprocals</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.16666667</span><span class="p">,</span> <span class="mf">1.</span>        <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">0.25</span>      <span class="p">,</span> <span class="mf">0.125</span>     <span class="p">])</span>
</pre></div>
</div>
<p>If we measure the execution time of this code for a large input, we see
that this operation is very slow, perhaps surprisingly so!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> compute_reciprocals(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.63 s ± 29.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
<p>It takes <span class="math notranslate nohighlight">\(2.63\)</span> seconds to compute these million operations and to
store the result.</p>
<p>It turns out that the bottleneck here is not the operations themselves,
but the type-checking and function dispatches that CPython must do at
each cycle of the loop.</p>
<p>If we were working in compiled code instead, this type specification
would be known before the code executes and the result could be computed
much more efficiently.</p>
</div>
<div class="section" id="introducing-ufuncs">
<h3>Introducing UFuncs<a class="headerlink" href="#introducing-ufuncs" title="Permalink to this headline">¶</a></h3>
<p>For many types of operations, NumPy provides a convenient interface into
just this kind of compiled routine.</p>
<p>This is known as a <em>vectorized</em> operation.</p>
<p>This can be accomplished by performing an operation on the array, which
will then be applied to each element.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> (1.0 / big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.97 ms ± 35.3 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>Vectorized operations in NumPy are implemented via <em>ufuncs</em>, whose main
purpose is to quickly execute repeated operations on values in NumPy
arrays.</p>
<p>Ufuncs are extremely flexible – before we saw an operation between a
scalar and an array, but we can also operate between two arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span>        <span class="p">,</span> <span class="mf">0.5</span>       <span class="p">,</span> <span class="mf">0.66666667</span><span class="p">,</span> <span class="mf">0.75</span>      <span class="p">,</span> <span class="mf">0.8</span>       <span class="p">])</span>
</pre></div>
</div>
<p>And ufunc operations are not limited to one-dimensional arrays–they can
also act on multi-dimensional arrays as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="mi">2</span> <span class="o">**</span> <span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>   <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">16</span><span class="p">,</span>  <span class="mi">32</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">256</span><span class="p">]])</span>
</pre></div>
</div>
<p><em>Any time you see such a loop in a Python script, you should consider
whether it can be replaced with a vectorized expression.</em></p>
<div class="section" id="array-arithmetic">
<h4>Array arithmetic<a class="headerlink" href="#array-arithmetic" title="Permalink to this headline">¶</a></h4>
<p>NumPy’s ufuncs feel very natural to use because they make use of
Python’s native arithmetic operators:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x     =&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x + 5 =&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x - 5 =&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x * 2 =&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x / 2 =&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x // 2 =&quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># floor division</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-x     = &quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x ** 2 = &quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x % 2  = &quot;</span><span class="p">,</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">x</span> <span class="o">-</span> <span class="mi">5</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="o">-</span><span class="mi">4</span> <span class="o">-</span><span class="mi">3</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">x</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>  <span class="mf">0.5</span> <span class="mf">1.</span>  <span class="mf">1.5</span><span class="p">]</span>
<span class="n">x</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="o">-</span><span class="n">x</span>     <span class="o">=</span>  <span class="p">[</span> <span class="mi">0</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="mi">3</span><span class="p">]</span>
<span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">4</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">x</span> <span class="o">%</span> <span class="mi">2</span>  <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="c1"># can be strung together also</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">2.25</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">6.25</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="trigonometric-functions">
<h4>Trigonometric functions<a class="headerlink" href="#trigonometric-functions" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code> provides a large number of useful ufuncs, we’ll start by
defining an array of angles:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;theta      = &quot;</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sin(theta) = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cos(theta) = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tan(theta) = &quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span>      <span class="o">=</span>  <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.57079633</span> <span class="mf">3.14159265</span><span class="p">]</span>
<span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">0.0000000e+00</span> <span class="mf">1.0000000e+00</span> <span class="mf">1.2246468e-16</span><span class="p">]</span>
<span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span> <span class="mf">1.000000e+00</span>  <span class="mf">6.123234e-17</span> <span class="o">-</span><span class="mf">1.000000e+00</span><span class="p">]</span>
<span class="n">tan</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">=</span>  <span class="p">[</span> <span class="mf">0.00000000e+00</span>  <span class="mf">1.63312394e+16</span> <span class="o">-</span><span class="mf">1.22464680e-16</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="exponents-and-logarithms">
<h4>Exponents and logarithms<a class="headerlink" href="#exponents-and-logarithms" title="Permalink to this headline">¶</a></h4>
<p>Another common <code class="docutils literal notranslate"><span class="pre">NumPy</span></code> ufunc are the exponentials (that are useful for
maintaining precision with very small inputs)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x     =&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;e^x   =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2^x   =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3^x   =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>     <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">e</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span> <span class="mf">2.71828183</span>  <span class="mf">7.3890561</span>  <span class="mf">20.08553692</span><span class="p">]</span>
<span class="mi">2</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span><span class="mf">2.</span> <span class="mf">4.</span> <span class="mf">8.</span><span class="p">]</span>
<span class="mi">3</span><span class="o">^</span><span class="n">x</span>   <span class="o">=</span> <span class="p">[</span> <span class="mi">3</span>  <span class="mi">9</span> <span class="mi">27</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x        =&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ln(x)    =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;log2(x)  =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;log10(x) =&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>        <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">ln</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>    <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">0.69314718</span> <span class="mf">1.38629436</span> <span class="mf">2.30258509</span><span class="p">]</span>
<span class="n">log2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">1.</span>         <span class="mf">2.</span>         <span class="mf">3.32192809</span><span class="p">]</span>
<span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.</span>         <span class="mf">0.30103</span>    <span class="mf">0.60205999</span> <span class="mf">1.</span>        <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="specifying-output">
<h4>Specifying output<a class="headerlink" href="#specifying-output" title="Permalink to this headline">¶</a></h4>
<p>For large calculations, it is sometimes useful to be able to specify the
array where the result of the calculation will be stored:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">0.</span> <span class="mf">10.</span> <span class="mf">20.</span> <span class="mf">30.</span> <span class="mf">40.</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">y</span><span class="p">[::</span><span class="mi">2</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">1.</span>  <span class="mf">0.</span>  <span class="mf">2.</span>  <span class="mf">0.</span>  <span class="mf">4.</span>  <span class="mf">0.</span>  <span class="mf">8.</span>  <span class="mf">0.</span> <span class="mf">16.</span>  <span class="mf">0.</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="outer-products">
<h4>Outer products<a class="headerlink" href="#outer-products" title="Permalink to this headline">¶</a></h4>
<p>Finally, any ufunc can compute the output of all pairs of two different
inputs using the <code class="docutils literal notranslate"><span class="pre">outer</span></code> method:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">25</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="aggregations-min-max-and-everything-in-between">
<h2>Aggregations: Min, Max, and Everything In Between<a class="headerlink" href="#aggregations-min-max-and-everything-in-between" title="Permalink to this headline">¶</a></h2>
<div class="section" id="summing-the-values-in-an-array">
<h3>Summing the Values in an Array<a class="headerlink" href="#summing-the-values-in-an-array" title="Permalink to this headline">¶</a></h3>
<p>As a quick example, consider computing the sum of all values in an
array. Python itself can do this using the built-in <code class="docutils literal notranslate"><span class="pre">sum</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">50.461758453195614</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">50.46175845319564</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> sum(big_array)
<span class="o">%</span><span class="k">timeit</span> np.sum(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>191 ms ± 5.67 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
554 µs ± 7.02 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
<div class="section" id="minimum-and-maximum">
<h3>Minimum and Maximum<a class="headerlink" href="#minimum-and-maximum" title="Permalink to this headline">¶</a></h3>
<p>Similarly, Python has built-in <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> functions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span><span class="p">(</span><span class="n">big_array</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">big_array</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">big_array</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">big_array</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> min(big_array)
<span class="o">%</span><span class="k">timeit</span> np.min(big_array)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>118 ms ± 1.78 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
656 µs ± 8 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_array</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">big_array</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">big_array</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">7.071203171893359e-07</span><span class="p">,</span> <span class="mf">0.9999997207656334</span><span class="p">,</span> <span class="mf">500216.8034810001</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="multi-dimensional-aggregates">
<h4>Multi dimensional aggregates<a class="headerlink" href="#multi-dimensional-aggregates" title="Permalink to this headline">¶</a></h4>
<p>One common type of aggregation operation is an aggregate along a row or
column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">M</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">0.07452786</span><span class="p">,</span> <span class="mf">0.41843762</span><span class="p">,</span> <span class="mf">0.99939192</span><span class="p">,</span> <span class="mf">0.66974416</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.54717434</span><span class="p">,</span> <span class="mf">0.82711104</span><span class="p">,</span> <span class="mf">0.23097044</span><span class="p">,</span> <span class="mf">0.16283152</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">0.27950484</span><span class="p">,</span> <span class="mf">0.58540569</span><span class="p">,</span> <span class="mf">0.90657413</span><span class="p">,</span> <span class="mf">0.18671025</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="c1"># By default, each NumPy aggregation function works on the whole array</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">5.888383818472106</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># specifying the axis along which the aggregate is computed</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.07452786</span><span class="p">,</span> <span class="mf">0.41843762</span><span class="p">,</span> <span class="mf">0.23097044</span><span class="p">,</span> <span class="mf">0.16283152</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># find the maximum value within each row</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.99939192</span><span class="p">,</span> <span class="mf">0.82711104</span><span class="p">,</span> <span class="mf">0.90657413</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="other-aggregation-functions">
<h4>Other aggregation functions<a class="headerlink" href="#other-aggregation-functions" title="Permalink to this headline">¶</a></h4>
<p>Additionally, most aggregates have a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>-safe counterpart that
computes the result while ignoring missing values, which are marked by
the special IEEE floating-point <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 34%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function Name</p></th>
<th class="head"><p>NaN-safe Version</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.sum</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nansum</span></code></p></td>
<td><p>Compute sum of
elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.prod</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanprod</span></code></p></td>
<td><p>Compute product of
elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.mean</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmean</span></code></p></td>
<td><p>Compute mean of
elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.std</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanstd</span></code></p></td>
<td><p>Compute standard
deviation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.var</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanvar</span></code></p></td>
<td><p>Compute variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.min</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmin</span></code></p></td>
<td><p>Find minimum value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.max</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmax</span></code></p></td>
<td><p>Find maximum value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.argmin</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanargmin</span></code></p></td>
<td><p>Find index of minimum
value</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.argmax</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanargmax</span></code></p></td>
<td><p>Find index of maximum
value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.median</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanmedian</span></code></p></td>
<td><p>Compute median of
elements</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.percentile</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nanpercentile</span></code></p></td>
<td><p>Compute rank-based
statistics of
elements</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">np.any</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Evaluate whether any
elements are true</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">np.all</span></code></p></td>
<td><p>N/A</p></td>
<td><p>Evaluate whether all
elements are true</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="computation-on-arrays-broadcasting">
<h2>Computation on Arrays: Broadcasting<a class="headerlink" href="#computation-on-arrays-broadcasting" title="Permalink to this headline">¶</a></h2>
<p>Another means of vectorizing operations is to use NumPy’s <em>broadcasting</em>
functionality.</p>
<p>Broadcasting is simply a set of rules for applying binary ufuncs (e.g.,
addition, subtraction, multiplication, etc.) on arrays of different
sizes.</p>
<div class="section" id="introducing-broadcasting">
<h3>Introducing Broadcasting<a class="headerlink" href="#introducing-broadcasting" title="Permalink to this headline">¶</a></h3>
<p>Recall that for arrays of the same size, binary operations are performed
on an element-by-element basis:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>Broadcasting allows these types of binary operations to be performed on
arrays of different sizes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>We can think of this as an operation that stretches or duplicates the
value <code class="docutils literal notranslate"><span class="pre">5</span></code> into the array <code class="docutils literal notranslate"><span class="pre">[5,</span> <span class="pre">5,</span> <span class="pre">5]</span></code>, and adds the results; the
advantage of NumPy’s broadcasting is that this duplication of values
does not actually take place.</p>
<p>We can similarly extend this to arrays of higher dimensions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">M</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">+</span> <span class="n">a</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]])</span>
</pre></div>
</div>
<p>Here the one-dimensional array <code class="docutils literal notranslate"><span class="pre">a</span></code> is stretched, or broadcast across
the second dimension in order to match the shape of <code class="docutils literal notranslate"><span class="pre">M</span></code>.</p>
<p>More complicated cases can involve broadcasting of both arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">2</span><span class="p">]]))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="rules-of-broadcasting">
<h3>Rules of Broadcasting<a class="headerlink" href="#rules-of-broadcasting" title="Permalink to this headline">¶</a></h3>
<p>Broadcasting in NumPy follows a strict set of rules to determine the
interaction between the two arrays:</p>
<ul class="simple">
<li><p>Rule 1: If the two arrays differ in their number of dimensions, the
shape of the one with fewer dimensions is <em>padded</em> with ones on its
leading (left) side.</p></li>
<li><p>Rule 2: If the shape of the two arrays does not match in any
dimension, the array with shape equal to 1 in that dimension is
stretched to match the other shape.</p></li>
<li><p>Rule 3: If in any dimension the sizes disagree and neither is equal
to 1, an error is raised.</p></li>
</ul>
<div class="section" id="centering-an-array">
<h4>Centering an array<a class="headerlink" href="#centering-an-array" title="Permalink to this headline">¶</a></h4>
<p>Imagine you have an array of 10 observations, each of which consists of
3 values, we’ll store this in a <span class="math notranslate nohighlight">\(10 \times 3\)</span> array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xmean</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Xmean</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.55965135</span><span class="p">,</span> <span class="mf">0.52179051</span><span class="p">,</span> <span class="mf">0.41008518</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_centered</span> <span class="o">=</span> <span class="n">X</span> <span class="o">-</span> <span class="n">Xmean</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_centered</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># To double-check, we can check that the centered array has near 0 means.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">6.66133815e-17</span><span class="p">,</span>  <span class="mf">3.33066907e-17</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.77156117e-17</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-a-two-dimensional-function">
<h4>Plotting a two-dimensional function<a class="headerlink" href="#plotting-a-two-dimensional-function" title="Permalink to this headline">¶</a></h4>
<p>One place that broadcasting is very useful is in displaying images based
on two-dimensional functions. If we want to define a function
<span class="math notranslate nohighlight">\(z = f(x, y)\)</span>, broadcasting can be used to compute the function
across the grid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">steps</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">steps</span><span class="p">)</span> <span class="c1"># # x and y have 500 steps from 0 to 5</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">steps</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/numpy_155_0.png" src="_images/numpy_155_0.png" />
</div>
</div>
</div>
<div class="section" id="comparisons-masks-and-boolean-logic">
<h2>Comparisons, Masks, and Boolean Logic<a class="headerlink" href="#comparisons-masks-and-boolean-logic" title="Permalink to this headline">¶</a></h2>
<p>Masking comes up when you want to extract, modify, count, or otherwise
manipulate values in an array based on some criterion: for example, you
might wish to count all values greater than a certain value, or perhaps
remove all outliers that are above some threshold. In NumPy, Boolean
masking is often the most efficient way to accomplish these types of
tasks.</p>
<div class="section" id="comparison-operators-as-ufuncs">
<h3>Comparison Operators as ufuncs<a class="headerlink" href="#comparison-operators-as-ufuncs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">3</span>  <span class="c1"># less than</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">3</span>  <span class="c1"># greater than</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">!=</span> <span class="mi">3</span>  <span class="c1"># not equal</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
</pre></div>
</div>
<p>Just as in the case of arithmetic ufuncs, these will work on arrays of
any size and shape:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">6</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
</pre></div>
</div>
<div class="section" id="counting-entries">
<h4>Counting entries<a class="headerlink" href="#counting-entries" title="Permalink to this headline">¶</a></h4>
<p>To count the number of <code class="docutils literal notranslate"><span class="pre">True</span></code> entries in a Boolean array,
<code class="docutils literal notranslate"><span class="pre">np.count_nonzero</span></code> is useful:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="c1"># how many values less than 6?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># how many values less than 6 in each row?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># are there any values greater than 8?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># are there any values less than zero?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># are all values less than 10?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">8</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># are all values in each row less than 8?</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="boolean-arrays-as-masks">
<h3>Boolean Arrays as Masks<a class="headerlink" href="#boolean-arrays-as-masks" title="Permalink to this headline">¶</a></h3>
<p>A more powerful pattern is to use Boolean arrays as masks, to select
particular subsets of the data themselves:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">],</span>
       <span class="p">[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span>
       <span class="p">[</span> <span class="kc">True</span><span class="p">,</span>  <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>What is returned is a one-dimensional array filled with all the values
that meet this condition; in other words, all the values in positions at
which the mask array is <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
</div>
<div class="section" id="fancy-indexing">
<h2>Fancy Indexing<a class="headerlink" href="#fancy-indexing" title="Permalink to this headline">¶</a></h2>
<p>We saw how to access and modify portions of arrays using simple indices
(e.g., <code class="docutils literal notranslate"><span class="pre">arr[0]</span></code>), slices (e.g., <code class="docutils literal notranslate"><span class="pre">arr[:5]</span></code>), and Boolean masks (e.g.,
<code class="docutils literal notranslate"><span class="pre">arr[arr</span> <span class="pre">&gt;</span> <span class="pre">0]</span></code>).</p>
<p>We’ll look at another style of array indexing, known as <em>fancy
indexing</em>, that is like the simple indexing we’ve already seen, but we
pass arrays of indices in place of single scalars.</p>
<p>Fancy indexing is conceptually simple: it means passing an array of
indices to access multiple array elements at once:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">51</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">74</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># Suppose we want to access three different elements.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="c1"># Alternatively, we can pass a single list or array of indices</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
</pre></div>
</div>
<p>When using fancy indexing, the shape of the result reflects the shape of
the index arrays rather than the shape of the array being indexed:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">71</span><span class="p">,</span> <span class="mi">86</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">20</span><span class="p">]])</span>
</pre></div>
</div>
<p>Fancy indexing also works in multiple dimensions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">X</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>Like with standard indexing, the first index refers to the row, and the
second to the column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">X</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
<p>The pairing of indices in fancy indexing follows all the broadcasting
rules that we’ve already seen:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="n">row</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">col</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<p>each row value is matched with each column vector, exactly as we saw in
broadcasting of arithmetic operations</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">*</span> <span class="n">col</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
</pre></div>
</div>
<p>Remember: <em>with fancy indexing that the return value reflects
the</em><strong>broadcasted shape of the indices</strong><em>, rather than the shape of
the array being indexed</em>.</p>
<div class="section" id="combined-indexing">
<h3>Combined Indexing<a class="headerlink" href="#combined-indexing" title="Permalink to this headline">¶</a></h3>
<p>For even more powerful operations, fancy indexing can be combined with
the other indexing schemes we’ve seen:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="c1"># combine fancy and simple indices</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span> <span class="c1"># combine fancy indexing with slicing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">6</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">10</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">X</span><span class="p">[</span><span class="n">row</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="n">mask</span><span class="p">]</span> <span class="c1"># combine fancy indexing with masking</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">4</span><span class="p">,</span>  <span class="mi">6</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="section" id="example-selecting-random-points">
<h3>Example: Selecting Random Points<a class="headerlink" href="#example-selecting-random-points" title="Permalink to this headline">¶</a></h3>
<p>One common use of fancy indexing is the selection of subsets of rows
from a matrix.</p>
<p>For example, we might have an <span class="math notranslate nohighlight">\(N\)</span> by <span class="math notranslate nohighlight">\(D\)</span> matrix representing
<span class="math notranslate nohighlight">\(N\)</span> points in <span class="math notranslate nohighlight">\(D\)</span> dimensions, such as the following points
drawn from a two-dimensional normal distribution:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/numpy_202_0.png" src="_images/numpy_202_0.png" />
<p>Let’s use fancy indexing to select 20 random points. We’ll do this by
first choosing 20 random indices with no repeats, and use these indices
to select a portion of the original array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">20</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">indices</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span>
       <span class="mi">92</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">34</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selection</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>  <span class="c1"># fancy indexing here</span>
<span class="n">selection</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Now to see which points were selected, let’s over-plot large circles at
the locations of the selected points:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/numpy_207_0.png" src="_images/numpy_207_0.png" />
</div>
<div class="section" id="modifying-values-with-fancy-indexing">
<h3>Modifying Values with Fancy Indexing<a class="headerlink" href="#modifying-values-with-fancy-indexing" title="Permalink to this headline">¶</a></h3>
<p>Fancy indexing it can also be used to modify parts of an array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">10</span> <span class="c1"># use any assignment-type operator for this</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>  <span class="mi">9</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice, though, that repeated indices with these operations can cause
some potentially unexpected results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>Where did the 4 go? The result of this operation is to first assign
<code class="docutils literal notranslate"><span class="pre">x[0]</span> <span class="pre">=</span> <span class="pre">4</span></code>, followed by <code class="docutils literal notranslate"><span class="pre">x[0]</span> <span class="pre">=</span> <span class="pre">6</span></code>. The result, of course, is that
<code class="docutils literal notranslate"><span class="pre">x[0]</span></code> contains the value 6.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">6.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>You might expect that <code class="docutils literal notranslate"><span class="pre">x[3]</span></code> would contain the value 2, and <code class="docutils literal notranslate"><span class="pre">x[4]</span></code>
would contain the value 3, as this is how many times each index is
repeated. Why is this not the case?</p>
<p>Conceptually, this is because <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">+=</span> <span class="pre">1</span></code> is meant as a shorthand of
<code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">=</span> <span class="pre">x[i]</span> <span class="pre">+</span> <span class="pre">1</span></code>. <code class="docutils literal notranslate"><span class="pre">x[i]</span> <span class="pre">+</span> <span class="pre">1</span></code> is evaluated, and then the result is
assigned to the indices in x.</p>
<p>With this in mind, it is not the augmentation that happens multiple
times, but the assignment, which leads to the rather nonintuitive
results.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">at()</span></code> method does an in-place application of the given operator
at the specified indices (here, <code class="docutils literal notranslate"><span class="pre">i</span></code>) with the specified value (here,
1). Another method that is similar in spirit is the <code class="docutils literal notranslate"><span class="pre">reduceat()</span></code>
method of ufuncs, which you can read about in the NumPy documentation.</p>
</div>
<div class="section" id="example-binning-data">
<h3>Example: Binning Data<a class="headerlink" href="#example-binning-data" title="Permalink to this headline">¶</a></h3>
<p>You can use these ideas to efficiently bin data to create a histogram by
hand. For example, imagine we have 1,000 values and would like to
quickly find where they fall within an array of bins. We could compute
it using <code class="docutils literal notranslate"><span class="pre">ufunc.at</span></code> like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># compute a histogram by hand</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>

<span class="c1"># find the appropriate bin for each x</span>
<span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># add 1 to each of these bins</span>
<span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The counts now reflect the number of points</span>
<span class="c1"># within each bin–in other words, a histogram:</span>
<span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">counts</span><span class="p">);</span>
<span class="n">line</span><span class="o">.</span><span class="n">set_drawstyle</span><span class="p">(</span><span class="s2">&quot;steps&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/numpy_220_0.png" src="_images/numpy_220_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NumPy routine:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> counts, edges = np.histogram(x, bins)

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom routine:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> np.add.at(counts, np.searchsorted(bins, x), 1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NumPy routine:
35.1 µs ± 209 ns per loop (mean ± std. dev. of 7 runs, 10000 loops each)
Custom routine:
18.5 µs ± 405 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)
</pre></div>
</div>
<p>Our own one-line algorithm is several times faster than the optimized
algorithm in NumPy! How can this be? If you dig into the
<code class="docutils literal notranslate"><span class="pre">np.histogram</span></code> source code (you can do this in IPython by typing
<code class="docutils literal notranslate"><span class="pre">np.histogram??</span></code>), you’ll see that it’s quite a bit more involved than
the simple search-and-count that we’ve done; this is because NumPy’s
algorithm is more flexible, and particularly is designed for better
performance when the number of data points becomes large…</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NumPy routine:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> counts, edges = np.histogram(x, bins)

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom routine:&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="k">timeit</span> np.add.at(counts, np.searchsorted(bins, x), 1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NumPy routine:
95.9 ms ± 1.17 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
Custom routine:
142 ms ± 115 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>What this comparison shows is that algorithmic efficiency is almost
never a simple question. An algorithm efficient for large datasets will
not always be the best choice for small datasets, and vice versa.</p>
<p>The key to efficiently using Python in data-intensive applications is
knowing about general convenience routines like <code class="docutils literal notranslate"><span class="pre">np.histogram</span></code> and
when they’re appropriate, but also knowing how to make use of
lower-level functionality when you need more pointed behavior.</p>
</div>
</div>
<div class="section" id="sorting-arrays">
<h2>Sorting Arrays<a class="headerlink" href="#sorting-arrays" title="Permalink to this headline">¶</a></h2>
<p>Up to this point we have been concerned mainly with tools to access and
operate on array data with NumPy. This section covers algorithms related
to sorting values in NumPy arrays.</p>
<div class="section" id="fast-sorting-in-numpy-np-sort-and-np-argsort">
<h3>Fast Sorting in NumPy: <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code><a class="headerlink" href="#fast-sorting-in-numpy-np-sort-and-np-argsort" title="Permalink to this headline">¶</a></h3>
<p>Although Python has built-in <code class="docutils literal notranslate"><span class="pre">sort</span></code> and <code class="docutils literal notranslate"><span class="pre">sorted</span></code> functions to work
with lists, NumPy’s <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> function turns out to be much more
efficient and useful.</p>
<p>To return a sorted version of the array <em>without modifying the input</em>,
you can use <code class="docutils literal notranslate"><span class="pre">np.sort</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<p>A related function is <code class="docutils literal notranslate"><span class="pre">argsort</span></code>, which instead returns the <em>indices</em>
of the sorted elements:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">i</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
<p>The first element of this result gives the index of the smallest
element, the second value gives the index of the second smallest, and so
on.</p>
<p>These indices can then be used (via fancy indexing) to construct the
sorted array if desired:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
<div class="section" id="sorting-along-rows-or-columns">
<h4>Sorting along rows or columns<a class="headerlink" href="#sorting-along-rows-or-columns" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">X</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># sort each column of X</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># sort each row of X</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]])</span>
</pre></div>
</div>
<p>Keep in mind that this treats each row or column as an independent
array, and any relationships between the row or column values will be
lost!</p>
</div>
</div>
<div class="section" id="partial-sorts-partitioning">
<h3>Partial Sorts: Partitioning<a class="headerlink" href="#partial-sorts-partitioning" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we’re not interested in sorting the entire array, but simply
want to find the <em>k</em> smallest values in the array. <code class="docutils literal notranslate"><span class="pre">np.partition</span></code>
takes an array and a number <em>K</em>; the result is a new array with the
smallest <em>K</em> values to the left of the partition, and the remaining
values to the right, in arbitrary order:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that the first three values in the resulting array are the three
smallest in the array, and the remaining array positions contain the
remaining values.</p>
<p><em>Within the two partitions, the elements have arbitrary order.</em></p>
<p>Similarly to sorting, we can partition along an arbitrary axis of a
multidimensional array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">partition</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
<p>The result is an array where the first two slots in each row contain the
smallest values from that row, with the remaining values filling the
remaining slots.</p>
<p>Finally, just as there is a <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code> that computes indices of the
sort, there is a <code class="docutils literal notranslate"><span class="pre">np.argpartition</span></code> that computes indices of the
partition.</p>
</div>
<div class="section" id="example-k-nearest-neighbors">
<h3>Example: k-Nearest Neighbors<a class="headerlink" href="#example-k-nearest-neighbors" title="Permalink to this headline">¶</a></h3>
<p>Let’s quickly see how we might use this <code class="docutils literal notranslate"><span class="pre">argsort</span></code> function along
multiple axes to find the nearest neighbors of each point in a set.</p>
<p>We’ll start by creating a random set of 10 points on a two-dimensional
plane:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">rand</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/numpy_246_0.png" src="_images/numpy_246_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute the distance between each pair of points</span>
<span class="n">dist_sq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">X</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">dist_sq</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">dist_sq</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>With the pairwise square-distances converted, we can now use
<code class="docutils literal notranslate"><span class="pre">np.argsort</span></code> to sort along each row.</p>
<p>The leftmost columns will then give the indices of the nearest
neighbors:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">dist_sq</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">nearest</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span>  <span class="mi">8</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
       <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>
       <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">])</span>
</pre></div>
</div>
<p>Notice that the first column is order because each point’s closest
neighbor is itself.</p>
<p>If we’re simply interested in the nearest <span class="math notranslate nohighlight">\(k\)</span> neighbors, all we
need is to partition each row so that the smallest <span class="math notranslate nohighlight">\(k + 1\)</span> squared
distances come first, with larger distances filling the remaining
positions of the array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">nearest_partition</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argpartition</span><span class="p">(</span><span class="n">dist_sq</span><span class="p">,</span> <span class="n">K</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># draw lines from each point to its two nearest neighbors</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nearest_partition</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="nb">zip</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/numpy_253_0.png" src="_images/numpy_253_0.png" />
<p>At first glance, it might seem strange that some of the points have more
than two lines coming out of them: this is due to the fact that if point
A is one of the two nearest neighbors of point B, this does not
necessarily imply that point B is one of the two nearest neighbors of
point A.</p>
<p>You might be tempted to do the same type of operation by manually
looping through the data and sorting each set of neighbors individually.
The beauty of our approach is that <em>it’s written in a way that’s
agnostic to the size of the input data</em>: we could just as easily compute
the neighbors among 100 or 1,000,000 points in any number of dimensions,
and the code would look the same.</p>
</div>
</div>
</div>
<div class="section" id="pandas-module">
<h1><code class="docutils literal notranslate"><span class="pre">pandas</span></code> module<a class="headerlink" href="#pandas-module" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. February 26, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract These slides outline techniques for effectively loading,
storing, and manipulating in-memory data in Python.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">,</span> <span class="s1">&#39;numerical&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="introducing-pandas-objects">
<h2>Introducing Pandas Objects<a class="headerlink" href="#introducing-pandas-objects" title="Permalink to this headline">¶</a></h2>
<p>Pandas objects can be thought of as enhanced versions of NumPy
structured arrays in which the rows and columns are identified with
labels rather than simple integer indices.</p>
<p>Let’s introduce these three fundamental Pandas data structures: the
<code class="docutils literal notranslate"><span class="pre">Series</span></code>, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and <code class="docutils literal notranslate"><span class="pre">Index</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="section" id="the-pandas-series-object">
<h3>The Pandas Series Object<a class="headerlink" href="#the-pandas-series-object" title="Permalink to this headline">¶</a></h3>
<p>A Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> is a one-dimensional array of indexed data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mf">0.25</span>
<span class="mi">1</span>    <span class="mf">0.50</span>
<span class="mi">2</span>    <span class="mf">0.75</span>
<span class="mi">3</span>    <span class="mf">1.00</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> objects wrap both a sequence of values and a sequence of
indices, which we can access with the <code class="docutils literal notranslate"><span class="pre">values</span></code> and <code class="docutils literal notranslate"><span class="pre">index</span></code>
attributes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">values</span></code> are simply a familiar NumPy array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span> <span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.</span>  <span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">index</span></code> is an array-like object of type <code class="docutils literal notranslate"><span class="pre">pd.Index</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RangeIndex</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Like with a NumPy array, data can be accessed by the associated index
via the familiar Python square-bracket notation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>    <span class="mf">0.50</span>
<span class="mi">2</span>    <span class="mf">0.75</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="section" id="series-as-generalized-numpy-array">
<h4><code class="docutils literal notranslate"><span class="pre">Series</span></code> as generalized NumPy array<a class="headerlink" href="#series-as-generalized-numpy-array" title="Permalink to this headline">¶</a></h4>
<p>It may look like the <code class="docutils literal notranslate"><span class="pre">Series</span></code> object is basically interchangeable with
a one-dimensional NumPy array. The essential difference is the presence
of the index: while the Numpy Array has an <em>implicitly defined</em> integer
index used to access the values, the Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> has an
<em>explicitly defined</em> index associated with the values.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">c</span>    <span class="mf">0.75</span>
<span class="n">d</span>    <span class="mf">1.00</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="c1"># item access works as expected</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span>
</pre></div>
</div>
<p>We can even use non-contiguous or non-sequential indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>    <span class="mf">0.25</span>
<span class="mi">5</span>    <span class="mf">0.50</span>
<span class="mi">3</span>    <span class="mf">0.75</span>
<span class="mi">7</span>    <span class="mf">1.00</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="section" id="series-as-specialized-dictionary">
<h4>Series as specialized dictionary<a class="headerlink" href="#series-as-specialized-dictionary" title="Permalink to this headline">¶</a></h4>
<p>You can think of a Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> a bit like a specialization of a
Python dictionary. A dictionary is a structure that maps arbitrary keys
to a set of arbitrary values, and a <code class="docutils literal notranslate"><span class="pre">Series</span></code> is a structure which maps
typed keys to a set of typed values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">38332521</span><span class="p">,</span>
                   <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">26448193</span><span class="p">,</span>
                   <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="mi">19651127</span><span class="p">,</span>
                   <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="mi">19552860</span><span class="p">,</span>
                   <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="mi">12882135</span><span class="p">}</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">population_dict</span><span class="p">)</span>
<span class="n">population</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">38332521</span>
<span class="n">Texas</span>         <span class="mi">26448193</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">19651127</span>
<span class="n">Florida</span>       <span class="mi">19552860</span>
<span class="n">Illinois</span>      <span class="mi">12882135</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="p">[</span><span class="s1">&#39;California&#39;</span><span class="p">]</span> <span class="c1"># typical dictionary-style item access</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">38332521</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="p">[</span><span class="s1">&#39;California&#39;</span><span class="p">:</span><span class="s1">&#39;Illinois&#39;</span><span class="p">]</span> <span class="c1"># array-like slicing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">38332521</span>
<span class="n">Texas</span>         <span class="mi">26448193</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">19651127</span>
<span class="n">Florida</span>       <span class="mi">19552860</span>
<span class="n">Illinois</span>      <span class="mi">12882135</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-pandas-dataframe-object">
<h3>The Pandas DataFrame Object<a class="headerlink" href="#the-pandas-dataframe-object" title="Permalink to this headline">¶</a></h3>
<p>The next fundamental structure in Pandas is the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> which can
be thought of either as a generalization of a NumPy array, or as a
specialization of a Python dictionary.</p>
<div class="section" id="dataframe-as-a-generalized-numpy-array">
<h4>DataFrame as a generalized NumPy array<a class="headerlink" href="#dataframe-as-a-generalized-numpy-array" title="Permalink to this headline">¶</a></h4>
<p>If a <code class="docutils literal notranslate"><span class="pre">Series</span></code> is an analog of a one-dimensional array with flexible
indices, a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is an analog of a two-dimensional array with
both flexible row indices and flexible column names.</p>
<p>You can think of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as a sequence of <em>aligned</em> <code class="docutils literal notranslate"><span class="pre">Series</span></code>
objects. Here, by <em>aligned</em> we mean that they share the same index:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">423967</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">695662</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="mi">141297</span><span class="p">,</span>
             <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="mi">170312</span><span class="p">,</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="mi">149995</span><span class="p">}</span>
<span class="n">area</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">area_dict</span><span class="p">)</span>
<span class="n">area</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">423967</span>
<span class="n">Texas</span>         <span class="mi">695662</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">141297</span>
<span class="n">Florida</span>       <span class="mi">170312</span>
<span class="n">Illinois</span>      <span class="mi">149995</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;population&#39;</span><span class="p">:</span> <span class="n">population</span><span class="p">,</span>
                       <span class="s1">&#39;area&#39;</span><span class="p">:</span> <span class="n">area</span><span class="p">})</span>
<span class="n">states</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
      <th>area</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>38332521</td>
      <td>423967</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>26448193</td>
      <td>695662</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>19651127</td>
      <td>141297</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>19552860</td>
      <td>170312</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>12882135</td>
      <td>149995</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">,</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Additionally, the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has a <code class="docutils literal notranslate"><span class="pre">columns</span></code> attribute, which is an
<code class="docutils literal notranslate"><span class="pre">Index</span></code> object holding the column labels:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Thus the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be thought of as a generalization of a
two-dimensional NumPy array, where both the rows and columns have a
generalized index for accessing the data.</p>
</div>
<div class="section" id="dataframe-as-specialized-dictionary">
<h4>DataFrame as specialized dictionary<a class="headerlink" href="#dataframe-as-specialized-dictionary" title="Permalink to this headline">¶</a></h4>
<p>Similarly, we can also think of a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> as a specialization of a
dictionary.</p>
<p>Where a dictionary maps a key to a value, a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> maps a column
name to a <code class="docutils literal notranslate"><span class="pre">Series</span></code> of column data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">states</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">423967</span>
<span class="n">Texas</span>         <span class="mi">695662</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">141297</span>
<span class="n">Florida</span>       <span class="mi">170312</span>
<span class="n">Illinois</span>      <span class="mi">149995</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="constructing-dataframe-objects">
<h4>Constructing DataFrame objects<a class="headerlink" href="#constructing-dataframe-objects" title="Permalink to this headline">¶</a></h4>
<div class="section" id="from-a-single-series-object">
<h5>From a single Series object<a class="headerlink" href="#from-a-single-series-object" title="Permalink to this headline">¶</a></h5>
<p>A <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is a collection of <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects, and a
single-column <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can be constructed from a single <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>38332521</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>26448193</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>19651127</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>19552860</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>12882135</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="from-a-list-of-dicts">
<h5>From a list of dicts<a class="headerlink" href="#from-a-list-of-dicts" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}])</span> <span class="c1">#  Pandas will fill missing keys with ``NaN``</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>a</th>
      <th>b</th>
      <th>c</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>3</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="from-a-two-dimensional-numpy-array">
<h5>From a two-dimensional NumPy array<a class="headerlink" href="#from-a-two-dimensional-numpy-array" title="Permalink to this headline">¶</a></h5>
<p>Given a two-dimensional array of data, we can create a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
with any specified column and index names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">],</span>
             <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>foo</th>
      <th>bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>0.187477</td>
      <td>0.661156</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.743879</td>
      <td>0.815803</td>
    </tr>
    <tr>
      <th>c</th>
      <td>0.925166</td>
      <td>0.630165</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="from-a-numpy-structured-array">
<h5>From a NumPy structured array<a class="headerlink" href="#from-a-numpy-structured-array" title="Permalink to this headline">¶</a></h5>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;i8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;f8&#39;</span><span class="p">)])</span>
<span class="n">A</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;i8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;f8&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="the-pandas-index-object">
<h3>The Pandas Index Object<a class="headerlink" href="#the-pandas-index-object" title="Permalink to this headline">¶</a></h3>
<p>This <code class="docutils literal notranslate"><span class="pre">Index</span></code> object is an interesting structure in itself, and it can
be thought of either as an <em>immutable array</em> or as an <em>ordered set</em>
(technically a multi-set, as <code class="docutils literal notranslate"><span class="pre">Index</span></code> objects may contain repeated
values).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="n">ind</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="index-as-immutable-array">
<h4>Index as immutable array<a class="headerlink" href="#index-as-immutable-array" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Index</span></code> in many ways operates like an array.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Index</span></code> objects also have many of the attributes familiar from NumPy
arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ind</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">ind</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ind</span><span class="o">.</span><span class="n">ndim</span><span class="p">,</span> <span class="n">ind</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span> <span class="p">(</span><span class="mi">5</span><span class="p">,)</span> <span class="mi">1</span> <span class="n">int64</span>
</pre></div>
</div>
<p>One difference is that indices are immutable–that is, they cannot be
modified via the normal means:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">35</span><span class="o">-</span><span class="mi">906</span><span class="n">a9fa1424c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>


<span class="o">~/</span><span class="n">Developer</span><span class="o">/</span><span class="n">working</span><span class="o">-</span><span class="n">copies</span><span class="o">/</span><span class="n">pythons</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">pandas</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">indexes</span><span class="o">/</span><span class="n">base</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
   <span class="mi">3908</span>
   <span class="mi">3909</span>     <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="o">-&gt;</span> <span class="mi">3910</span>         <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Index does not support mutable operations&quot;</span><span class="p">)</span>
   <span class="mi">3911</span>
   <span class="mi">3912</span>     <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="n">Index</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">support</span> <span class="n">mutable</span> <span class="n">operations</span>
</pre></div>
</div>
</div>
<div class="section" id="index-as-ordered-set">
<h4>Index as ordered set<a class="headerlink" href="#index-as-ordered-set" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">Index</span></code> object follows many of the conventions used by Python’s
built-in <code class="docutils literal notranslate"><span class="pre">set</span></code> data structure, so that unions, intersections,
differences, and other combinations can be computed in a familiar way:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indA</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="n">indB</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indA</span> <span class="o">&amp;</span> <span class="n">indB</span>  <span class="c1"># intersection</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indA</span> <span class="o">|</span> <span class="n">indB</span>  <span class="c1"># union</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indA</span> <span class="o">^</span> <span class="n">indB</span>  <span class="c1"># symmetric difference</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Int64Index</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="data-indexing-and-selection">
<h2>Data Indexing and Selection<a class="headerlink" href="#data-indexing-and-selection" title="Permalink to this headline">¶</a></h2>
<p>To modify values in NumPy arrays we use indexing (e.g., <code class="docutils literal notranslate"><span class="pre">arr[2,</span> <span class="pre">1]</span></code>),
slicing (e.g., <code class="docutils literal notranslate"><span class="pre">arr[:,</span> <span class="pre">1:5]</span></code>), masking (e.g., <code class="docutils literal notranslate"><span class="pre">arr[arr</span> <span class="pre">&gt;</span> <span class="pre">0]</span></code>), fancy
indexing (e.g., <code class="docutils literal notranslate"><span class="pre">arr[0,</span> <span class="pre">[1,</span> <span class="pre">5]]</span></code>), and combinations thereof (e.g.,
<code class="docutils literal notranslate"><span class="pre">arr[:,</span> <span class="pre">[1,</span> <span class="pre">5]]</span></code>).</p>
<p>Here we’ll look at similar means of accessing and modifying values in
Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects. If you have used the NumPy
patterns, the corresponding patterns in Pandas will feel very familiar,
though there are a few quirks to be aware of.</p>
<div class="section" id="data-selection-in-series">
<h3>Data Selection in Series<a class="headerlink" href="#data-selection-in-series" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">Series</span></code> object acts in many ways like a one-dimensional NumPy
array, and in many ways like a standard Python dictionary.</p>
<div class="section" id="series-as-dictionary">
<h4>Series as dictionary<a class="headerlink" href="#series-as-dictionary" title="Permalink to this headline">¶</a></h4>
<p>Like a dictionary, the <code class="docutils literal notranslate"><span class="pre">Series</span></code> object provides a mapping from a
collection of keys to a collection of values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
                 <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">c</span>    <span class="mf">0.75</span>
<span class="n">d</span>    <span class="mf">1.00</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a&#39;</span> <span class="ow">in</span> <span class="n">data</span> <span class="c1"># dictionary-like Python expressions...</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="c1"># ...and methods.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Series</span></code> objects can even be modified with a dictionary-like syntax:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">c</span>    <span class="mf">0.75</span>
<span class="n">d</span>    <span class="mf">1.00</span>
<span class="n">e</span>    <span class="mf">1.25</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>This easy mutability of the objects is a convenient feature: under the
hood, Pandas is making decisions about memory layout and data copying
that might need to take place.</p>
</div>
<div class="section" id="series-as-one-dimensional-array">
<h4>Series as one-dimensional array<a class="headerlink" href="#series-as-one-dimensional-array" title="Permalink to this headline">¶</a></h4>
<p>A <code class="docutils literal notranslate"><span class="pre">Series</span></code> builds on this dictionary-like interface and provides
array-style item selection via the same basic mechanisms as NumPy arrays
– that is, <em>slices</em>, <em>masking</em>, and <em>fancy indexing</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;c&#39;</span><span class="p">]</span> <span class="c1"># slicing by explicit index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">c</span>    <span class="mf">0.75</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="c1"># slicing by implicit integer index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[(</span><span class="n">data</span> <span class="o">&gt;</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data</span> <span class="o">&lt;</span> <span class="mf">0.8</span><span class="p">)]</span> <span class="c1"># masking</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">b</span>    <span class="mf">0.50</span>
<span class="n">c</span>    <span class="mf">0.75</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]]</span> <span class="c1"># fancy indexing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">0.25</span>
<span class="n">e</span>    <span class="mf">1.25</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Notice that when slicing with an explicit index (i.e.,
<code class="docutils literal notranslate"><span class="pre">data['a':'c']</span></code>), the final index is <em>included</em> in the slice, while
when slicing with an implicit index (i.e., <code class="docutils literal notranslate"><span class="pre">data[0:2]</span></code>), the final
index is <em>excluded</em> from the slice.</p>
</div>
<div class="section" id="indexers-loc-iloc-and-ix">
<h4>Indexers: loc, iloc, and ix<a class="headerlink" href="#indexers-loc-iloc-and-ix" title="Permalink to this headline">¶</a></h4>
<p>If your <code class="docutils literal notranslate"><span class="pre">Series</span></code> has an explicit integer index, an indexing operation
such as <code class="docutils literal notranslate"><span class="pre">data[1]</span></code> will use the explicit indices, while a slicing
operation like <code class="docutils literal notranslate"><span class="pre">data[1:3]</span></code> will use the implicit Python-style index.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>    <span class="n">a</span>
<span class="mi">3</span>    <span class="n">b</span>
<span class="mi">5</span>    <span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># explicit index when indexing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># implicit index when slicing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>    <span class="n">b</span>
<span class="mi">5</span>    <span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>Because of this potential confusion in the case of integer indexes,
Pandas provides some special <em>indexer</em> attributes that explicitly expose
certain indexing schemes.</p>
<p>These are not functional methods, but attributes that expose a
particular slicing interface to the data in the <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<p>First, the <code class="docutils literal notranslate"><span class="pre">loc</span></code> attribute allows indexing and slicing that always
references the explicit index:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;a&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>    <span class="n">a</span>
<span class="mi">3</span>    <span class="n">b</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">iloc</span></code> attribute allows indexing and slicing that always
references the implicit Python-style index:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>    <span class="n">b</span>
<span class="mi">5</span>    <span class="n">c</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>A third indexing attribute, <code class="docutils literal notranslate"><span class="pre">ix</span></code>, is a hybrid of the two, and for
<code class="docutils literal notranslate"><span class="pre">Series</span></code> objects is equivalent to standard <code class="docutils literal notranslate"><span class="pre">[]</span></code>-based indexing.</p>
<p>The purpose of the <code class="docutils literal notranslate"><span class="pre">ix</span></code> indexer will become more apparent in the
context of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects.</p>
</div>
</div>
<div class="section" id="data-selection-in-dataframe">
<h3>Data Selection in DataFrame<a class="headerlink" href="#data-selection-in-dataframe" title="Permalink to this headline">¶</a></h3>
<p>Recall that a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> acts in many ways like a two-dimensional or
structured array, and in other ways like a dictionary of <code class="docutils literal notranslate"><span class="pre">Series</span></code>
structures sharing the same index.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">423967</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">695662</span><span class="p">,</span>
                  <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="mi">141297</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="mi">170312</span><span class="p">,</span>
                  <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="mi">149995</span><span class="p">})</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">38332521</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">26448193</span><span class="p">,</span>
                 <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="mi">19651127</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="mi">19552860</span><span class="p">,</span>
                 <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="mi">12882135</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;area&#39;</span><span class="p">:</span><span class="n">area</span><span class="p">,</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span><span class="n">pop</span><span class="p">})</span>
<span class="n">data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>423967</td>
      <td>38332521</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>695662</td>
      <td>26448193</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>149995</td>
      <td>12882135</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="c1"># columns can be accessed via dict-style indexing</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">423967</span>
<span class="n">Texas</span>         <span class="mi">695662</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">141297</span>
<span class="n">Florida</span>       <span class="mi">170312</span>
<span class="n">Illinois</span>      <span class="mi">149995</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">area</span> <span class="c1"># alternatively, use attribute-style access with column names</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">423967</span>
<span class="n">Texas</span>         <span class="mi">695662</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">141297</span>
<span class="n">Florida</span>       <span class="mi">170312</span>
<span class="n">Illinois</span>      <span class="mi">149995</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>this dictionary-style syntax can also be used to modify the object, in
this case adding a new column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>423967</td>
      <td>38332521</td>
      <td>90.413926</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>695662</td>
      <td>26448193</td>
      <td>38.018740</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
      <td>139.076746</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
      <td>114.806121</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>149995</td>
      <td>12882135</td>
      <td>85.883763</td>
    </tr>
  </tbody>
</table>
</div><div class="section" id="dataframe-as-two-dimensional-array">
<h4>DataFrame as two-dimensional array<a class="headerlink" href="#dataframe-as-two-dimensional-array" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> can also be viewed as an enhanced two-dimensional array:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">values</span> <span class="c1"># examine the raw underlying data array</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mf">4.23967000e+05</span><span class="p">,</span> <span class="mf">3.83325210e+07</span><span class="p">,</span> <span class="mf">9.04139261e+01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">6.95662000e+05</span><span class="p">,</span> <span class="mf">2.64481930e+07</span><span class="p">,</span> <span class="mf">3.80187404e+01</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.41297000e+05</span><span class="p">,</span> <span class="mf">1.96511270e+07</span><span class="p">,</span> <span class="mf">1.39076746e+02</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.70312000e+05</span><span class="p">,</span> <span class="mf">1.95528600e+07</span><span class="p">,</span> <span class="mf">1.14806121e+02</span><span class="p">],</span>
       <span class="p">[</span><span class="mf">1.49995000e+05</span><span class="p">,</span> <span class="mf">1.28821350e+07</span><span class="p">,</span> <span class="mf">8.58837628e+01</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">T</span> <span class="c1"># transpose the full DataFrame object</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>California</th>
      <th>Texas</th>
      <th>New York</th>
      <th>Florida</th>
      <th>Illinois</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>area</th>
      <td>4.239670e+05</td>
      <td>6.956620e+05</td>
      <td>1.412970e+05</td>
      <td>1.703120e+05</td>
      <td>1.499950e+05</td>
    </tr>
    <tr>
      <th>pop</th>
      <td>3.833252e+07</td>
      <td>2.644819e+07</td>
      <td>1.965113e+07</td>
      <td>1.955286e+07</td>
      <td>1.288214e+07</td>
    </tr>
    <tr>
      <th>density</th>
      <td>9.041393e+01</td>
      <td>3.801874e+01</td>
      <td>1.390767e+02</td>
      <td>1.148061e+02</td>
      <td>8.588376e+01</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># passing a single index to an array accesses a row</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mf">4.23967000e+05</span><span class="p">,</span> <span class="mf">3.83325210e+07</span><span class="p">,</span> <span class="mf">9.04139261e+01</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;area&#39;</span><span class="p">]</span> <span class="c1"># assing a single &quot;index&quot; to access a column</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">423967</span>
<span class="n">Texas</span>         <span class="mi">695662</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">141297</span>
<span class="n">Florida</span>       <span class="mi">170312</span>
<span class="n">Illinois</span>      <span class="mi">149995</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">area</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Using the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> indexer, we can index the underlying array as if it
is a simple NumPy array (using the implicit Python-style index)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>423967</td>
      <td>38332521</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>695662</td>
      <td>26448193</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
    </tr>
  </tbody>
</table>
</div><p>Similarly, using the <code class="docutils literal notranslate"><span class="pre">loc</span></code> indexer we can index the underlying data in
an array-like style but using the explicit index and column names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:</span><span class="s1">&#39;Illinois&#39;</span><span class="p">,</span> <span class="p">:</span><span class="s1">&#39;pop&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>423967</td>
      <td>38332521</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>695662</td>
      <td>26448193</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>149995</td>
      <td>12882135</td>
    </tr>
  </tbody>
</table>
</div><p>Any of the familiar NumPy-style data access patterns can be used within
these indexers.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">density</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="s1">&#39;density&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>New York</th>
      <td>19651127</td>
      <td>139.076746</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>19552860</td>
      <td>114.806121</td>
    </tr>
  </tbody>
</table>
</div><p>Any of these indexing conventions may also be used to set or modify
values; this is done in the standard way that you might be accustomed to
from working with NumPy:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">90</span>
<span class="n">data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>423967</td>
      <td>38332521</td>
      <td>90.000000</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>695662</td>
      <td>26448193</td>
      <td>38.018740</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
      <td>139.076746</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
      <td>114.806121</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>149995</td>
      <td>12882135</td>
      <td>85.883763</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="additional-indexing-conventions">
<h4>Additional indexing conventions<a class="headerlink" href="#additional-indexing-conventions" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Florida&#39;</span><span class="p">:</span><span class="s1">&#39;Illinois&#39;</span><span class="p">]</span> <span class="c1"># *slicing* refers to rows</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
      <td>114.806121</td>
    </tr>
    <tr>
      <th>Illinois</th>
      <td>149995</td>
      <td>12882135</td>
      <td>85.883763</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">density</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">]</span> <span class="c1"># direct masking operations are also interpreted row-wise</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>area</th>
      <th>pop</th>
      <th>density</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>New York</th>
      <td>141297</td>
      <td>19651127</td>
      <td>139.076746</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>170312</td>
      <td>19552860</td>
      <td>114.806121</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="operating-on-data-in-pandas">
<h2>Operating on Data in Pandas<a class="headerlink" href="#operating-on-data-in-pandas" title="Permalink to this headline">¶</a></h2>
<p>One of the essential pieces of NumPy is the ability to perform quick
element-wise operations, both with basic arithmetic (addition,
subtraction, multiplication, etc.) and with more sophisticated
operations (trigonometric functions, exponential and logarithmic
functions, etc.).</p>
<p>Pandas inherits much of this functionality from NumPy.</p>
<p>Pandas includes a couple useful twists, however: for unary operations
like negation and trigonometric functions, these ufuncs will <em>preserve
index and column labels</em> in the output, and for binary operations such
as addition and multiplication, Pandas will automatically <em>align
indices</em> when passing the objects to the ufunc.</p>
<div class="section" id="ufuncs-index-preservation">
<h3>Ufuncs: Index Preservation<a class="headerlink" href="#ufuncs-index-preservation" title="Permalink to this headline">¶</a></h3>
<p>Because Pandas is designed to work with NumPy, any NumPy ufunc will work
on Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ser</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mi">6</span>
<span class="mi">1</span>    <span class="mi">3</span>
<span class="mi">2</span>    <span class="mi">7</span>
<span class="mi">3</span>    <span class="mi">4</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6</td>
      <td>9</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7</td>
      <td>4</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7</td>
      <td>2</td>
      <td>5</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div><p>If we apply a NumPy ufunc on either of these objects, the result will be
another Pandas object <em>with the indices preserved:</em></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">ser</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>     <span class="mf">403.428793</span>
<span class="mi">1</span>      <span class="mf">20.085537</span>
<span class="mi">2</span>    <span class="mf">1096.633158</span>
<span class="mi">3</span>      <span class="mf">54.598150</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">df</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># a slightly more complex calculation</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.000000</td>
      <td>7.071068e-01</td>
      <td>1.000000</td>
      <td>-1.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.707107</td>
      <td>1.224647e-16</td>
      <td>0.707107</td>
      <td>-7.071068e-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.707107</td>
      <td>1.000000e+00</td>
      <td>-0.707107</td>
      <td>1.224647e-16</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="ufuncs-index-alignment">
<h3>UFuncs: Index Alignment<a class="headerlink" href="#ufuncs-index-alignment" title="Permalink to this headline">¶</a></h3>
<p>For binary operations on two <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, Pandas
will align indices in the process of performing the operation.</p>
<div class="section" id="index-alignment-in-series">
<h4>Index alignment in Series<a class="headerlink" href="#index-alignment-in-series" title="Permalink to this headline">¶</a></h4>
<p>Suppose we are combining two different data sources, and find only the
top three US states by <em>area</em> and the top three US states by
<em>population</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;Alaska&#39;</span><span class="p">:</span> <span class="mi">1723337</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">695662</span><span class="p">,</span>
                  <span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">423967</span><span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;area&#39;</span><span class="p">)</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">({</span><span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="mi">38332521</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="mi">26448193</span><span class="p">,</span>
                        <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="mi">19651127</span><span class="p">},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;population&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span> <span class="o">/</span> <span class="n">area</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Alaska</span>              <span class="n">NaN</span>
<span class="n">California</span>    <span class="mf">90.413926</span>
<span class="n">New</span> <span class="n">York</span>            <span class="n">NaN</span>
<span class="n">Texas</span>         <span class="mf">38.018740</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>The resulting array contains the <em>union</em> of indices of the two input
arrays, which could be determined using standard Python set arithmetic
on these indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">area</span><span class="o">.</span><span class="n">index</span> <span class="o">|</span> <span class="n">population</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Index</span><span class="p">([</span><span class="s1">&#39;Alaska&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Any item for which one or the other does not have an entry is marked
with <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, or “Not a Number,” which is how Pandas marks missing data
. This index matching is implemented this way for any of Python’s
built-in arithmetic expressions; any missing values are filled in with
NaN by default:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="n">NaN</span>
<span class="mi">1</span>    <span class="mf">5.0</span>
<span class="mi">2</span>    <span class="mf">9.0</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>If using NaN values is not the desired behavior, the fill value can be
modified using appropriate object methods in place of the operators:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mf">2.0</span>
<span class="mi">1</span>    <span class="mf">5.0</span>
<span class="mi">2</span>    <span class="mf">9.0</span>
<span class="mi">3</span>    <span class="mf">5.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
</div>
<div class="section" id="index-alignment-in-dataframe">
<h4>Index alignment in DataFrame<a class="headerlink" href="#index-alignment-in-dataframe" title="Permalink to this headline">¶</a></h4>
<p>A similar type of alignment takes place for <em>both</em> columns and indices
when performing operations on <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span>
                 <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>11</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span>
                 <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;BAC&#39;</span><span class="p">))</span>
<span class="n">B</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>A</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4</td>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>8</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>9</td>
      <td>2</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>15.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.0</td>
      <td>6.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fill</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">A</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">fill</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>15.0</td>
      <td>13.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.0</td>
      <td>6.0</td>
      <td>4.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6.5</td>
      <td>13.5</td>
      <td>10.5</td>
    </tr>
  </tbody>
</table>
</div><p>The following table lists Python operators and their equivalent Pandas
object methods:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 28%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Python Operator</p></th>
<th class="head"><p>Pandas Method(s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">add()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sub()</span></code>, <code class="docutils literal notranslate"><span class="pre">subtract()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">*</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mul()</span></code>, <code class="docutils literal notranslate"><span class="pre">multiply()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">/</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">truediv()</span></code>, <code class="docutils literal notranslate"><span class="pre">div()</span></code>, <code class="docutils literal notranslate"><span class="pre">divide()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">//</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">floordiv()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">%</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mod()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">**</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">pow()</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="ufuncs-operations-between-dataframe-and-series">
<h3>Ufuncs: Operations Between DataFrame and Series<a class="headerlink" href="#ufuncs-operations-between-dataframe-and-series" title="Permalink to this headline">¶</a></h3>
<p>When performing operations between a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, the
index and column alignment is similarly maintained. Operations between a
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and a <code class="docutils literal notranslate"><span class="pre">Series</span></code> are similar to operations between a
two-dimensional and one-dimensional NumPy array.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">A</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
       <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">-</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([[</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
       <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
       <span class="p">[</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">4</span><span class="p">]])</span>
</pre></div>
</div>
<p>According to NumPy’s broadcasting rules , subtraction between a
two-dimensional array and one of its rows is applied row-wise.</p>
<p>In Pandas, the convention similarly operates row-wise by default:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;QRST&#39;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">-</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1</td>
      <td>-2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>-7</td>
      <td>1</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div><p>If you would instead like to operate column-wise you have to specify the
<code class="docutils literal notranslate"><span class="pre">axis</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Q</th>
      <th>R</th>
      <th>S</th>
      <th>T</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-5</td>
      <td>0</td>
      <td>-6</td>
      <td>-4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-4</td>
      <td>0</td>
      <td>-2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>0</td>
      <td>2</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="handling-missing-data">
<h2>Handling Missing Data<a class="headerlink" href="#handling-missing-data" title="Permalink to this headline">¶</a></h2>
<p>The difference between data found in many tutorials and data in the real
world is that real-world data is rarely clean and homogeneous. In
particular, many interesting datasets will have some amount of data
missing.</p>
<p>To make matters even more complicated, different data sources may
indicate missing data in different ways.</p>
<div class="section" id="trade-offs-in-missing-data-conventions">
<h3>Trade-Offs in Missing Data Conventions<a class="headerlink" href="#trade-offs-in-missing-data-conventions" title="Permalink to this headline">¶</a></h3>
<p>To indicate the presence of missing data in a table or DataFrame we can
use two strategies: using a <em>mask</em> that globally indicates missing
values, or choosing a <em>sentinel value</em> that indicates a missing entry.</p>
<p>In the masking approach, the mask might be an entirely separate Boolean
array, or it may involve appropriation of one bit in the data
representation to locally indicate the null status of a value.</p>
<p>In the sentinel approach, the sentinel value could be some data-specific
convention, such as indicating a missing integer value with -9999 or
some rare bit pattern, or it could be a more global convention, such as
indicating a missing floating-point value with NaN (Not a Number).</p>
<p>None of these approaches is without trade-offs: use of a separate mask
array requires allocation of an additional Boolean array. A sentinel
value reduces the range of valid values that can be represented, and may
require extra (often non-optimized) logic in CPU and GPU arithmetic.</p>
</div>
<div class="section" id="missing-data-in-pandas">
<h3>Missing Data in Pandas<a class="headerlink" href="#missing-data-in-pandas" title="Permalink to this headline">¶</a></h3>
<p>The way in which Pandas handles missing values is constrained by its
reliance on the NumPy package, which does <strong>not have</strong> a built-in notion
of NA values for non-floating-point data types.</p>
<p>NumPy does have support for masked arrays – that is, arrays that have a
separate Boolean mask array attached for marking data as “good” or
“bad.” Pandas could have derived from this, but the overhead in both
storage, computation, and code maintenance makes that an unattractive
choice.</p>
<p>With these constraints in mind, Pandas chose to use sentinels for
missing data, and further chose to use two already-existing Python null
values: the special floating-point <code class="docutils literal notranslate"><span class="pre">NaN</span></code> value, and the Python
<code class="docutils literal notranslate"><span class="pre">None</span></code> object.</p>
<div class="section" id="none-pythonic-missing-data">
<h4><code class="docutils literal notranslate"><span class="pre">None</span></code>: Pythonic missing data<a class="headerlink" href="#none-pythonic-missing-data" title="Permalink to this headline">¶</a></h4>
<p>The first sentinel value used by Pandas is <code class="docutils literal notranslate"><span class="pre">None</span></code>, a Python singleton
object that is often used for missing data in Python code.</p>
<p>Because it is a Python object, <code class="docutils literal notranslate"><span class="pre">None</span></code> cannot be used in any arbitrary
NumPy/Pandas array, but only in arrays with data type <code class="docutils literal notranslate"><span class="pre">'object'</span></code>
(i.e., arrays of Python objects):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">vals1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p>Any operations on the data will be done at the Python level, with much
more overhead than the typically fast operations seen for arrays with
native types:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">dtype</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dtype =&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="o">%</span><span class="k">timeit</span> np.arange(1E6, dtype=dtype).sum()
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>dtype = object
77.8 ms ± 133 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)

dtype = int
2 ms ± 42.1 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<p>The use of Python objects in an array also means that if you perform
aggregations like <code class="docutils literal notranslate"><span class="pre">sum()</span></code> or <code class="docutils literal notranslate"><span class="pre">min()</span></code> across an array with a <code class="docutils literal notranslate"><span class="pre">None</span></code>
value, you will generally get an error:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">109</span><span class="o">-</span><span class="mi">30</span><span class="n">a3fc8c6726</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">vals1</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


<span class="o">~/</span><span class="n">Developer</span><span class="o">/</span><span class="n">working</span><span class="o">-</span><span class="n">copies</span><span class="o">/</span><span class="n">pythons</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">numpy</span><span class="o">/</span><span class="n">core</span><span class="o">/</span><span class="n">_methods</span><span class="o">.</span><span class="n">py</span> <span class="ow">in</span> <span class="n">_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
     <span class="mi">36</span> <span class="k">def</span> <span class="nf">_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="mi">37</span>          <span class="n">initial</span><span class="o">=</span><span class="n">_NoValue</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="o">---&gt;</span> <span class="mi">38</span>     <span class="k">return</span> <span class="n">umr_sum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">dtype</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">keepdims</span><span class="p">,</span> <span class="n">initial</span><span class="p">,</span> <span class="n">where</span><span class="p">)</span>
     <span class="mi">39</span>
     <span class="mi">40</span> <span class="k">def</span> <span class="nf">_prod</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">+</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="ow">and</span> <span class="s1">&#39;NoneType&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="nan-missing-numerical-data">
<h4><code class="docutils literal notranslate"><span class="pre">NaN</span></code>: Missing numerical data<a class="headerlink" href="#nan-missing-numerical-data" title="Permalink to this headline">¶</a></h4>
<p>The other missing data representation, <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (acronym for <em>Not a
Number</em>), is different; it is a special floating-point value recognized
by all systems that use the standard IEEE floating-point representation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">vals2</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">0</span> <span class="o">*</span>  <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vals2</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">vals2</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vals2</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">,</span> <span class="n">nan</span><span class="p">)</span>
</pre></div>
</div>
<p>NumPy does provide some special aggregations that will ignore these
missing values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">nansum</span><span class="p">(</span><span class="n">vals2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">vals2</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">vals2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">8.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="nan-and-none-in-pandas">
<h4>NaN and None in Pandas<a class="headerlink" href="#nan-and-none-in-pandas" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">NaN</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code> both have their place, and Pandas is built to
handle the two of them nearly interchangeably, converting between them
where appropriate:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mf">1.0</span>
<span class="mi">1</span>    <span class="n">NaN</span>
<span class="mi">2</span>    <span class="mf">2.0</span>
<span class="mi">3</span>    <span class="n">NaN</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>The following table lists the upcasting conventions in Pandas when NA
values are introduced:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 20%" />
<col style="width: 44%" />
<col style="width: 36%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Typeclass</p></th>
<th class="head"><p>Conversion When Storing NAs</p></th>
<th class="head"><p>NA Sentinel Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">floating</span></code></p></td>
<td><p>No change</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">object</span></code></p></td>
<td><p>No change</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">integer</span></code></p></td>
<td><p>Cast to <code class="docutils literal notranslate"><span class="pre">float64</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">boolean</span></code></p></td>
<td><p>Cast to <code class="docutils literal notranslate"><span class="pre">object</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code> or <code class="docutils literal notranslate"><span class="pre">np.nan</span></code></p></td>
</tr>
</tbody>
</table>
<p>Keep in mind that in Pandas, string data is always stored with an
<code class="docutils literal notranslate"><span class="pre">object</span></code> dtype.</p>
</div>
</div>
<div class="section" id="operating-on-null-values">
<h3>Operating on Null Values<a class="headerlink" href="#operating-on-null-values" title="Permalink to this headline">¶</a></h3>
<p>As we have seen, Pandas treats <code class="docutils literal notranslate"><span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">NaN</span></code> as essentially
interchangeable for indicating missing or null values. To facilitate
this convention, there are several useful methods for detecting,
removing, and replacing null values in Pandas data structures. They are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">isnull()</span></code>: Generate a boolean mask indicating missing values</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notnull()</span></code>: Opposite of <code class="docutils literal notranslate"><span class="pre">isnull()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dropna()</span></code>: Return a filtered version of the data</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fillna()</span></code>: Return a copy of the data with missing values filled or
imputed</p></li>
</ul>
<div class="section" id="detecting-null-values">
<h4>Detecting null values<a class="headerlink" href="#detecting-null-values" title="Permalink to this headline">¶</a></h4>
<p>Pandas data structures have two useful methods for detecting null data:
<code class="docutils literal notranslate"><span class="pre">isnull()</span></code> and <code class="docutils literal notranslate"><span class="pre">notnull()</span></code>. Either one will return a Boolean mask
over the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="kc">False</span>
<span class="mi">1</span>     <span class="kc">True</span>
<span class="mi">2</span>    <span class="kc">False</span>
<span class="mi">3</span>     <span class="kc">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
</div>
<div class="section" id="dropping-null-values">
<h4>Dropping null values<a class="headerlink" href="#dropping-null-values" title="Permalink to this headline">¶</a></h4>
<p>In addition to the masking used before, there are the convenience
methods, <code class="docutils literal notranslate"><span class="pre">dropna()</span></code> (which removes NA values) and <code class="docutils literal notranslate"><span class="pre">fillna()</span></code> (which
fills in NA values):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>        <span class="mi">1</span>
<span class="mi">2</span>    <span class="n">hello</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>For a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, there are more options:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span>      <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">2</span><span class="p">,</span>      <span class="mi">3</span><span class="p">,</span>      <span class="mi">5</span><span class="p">],</span>
                   <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>      <span class="mi">6</span><span class="p">]])</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span> <span class="c1"># drop all rows in which *any* null value is present</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span> <span class="c1"># drop NA values from all columns containing a null value</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div><p>The default is <code class="docutils literal notranslate"><span class="pre">how='any'</span></code>, such that any row or column (depending on
the <code class="docutils literal notranslate"><span class="pre">axis</span></code> keyword) containing a null value will be dropped.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div><p>You can also specify <code class="docutils literal notranslate"><span class="pre">how='all'</span></code>, which will only drop rows/columns
that are <em>all</em> null values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div><p>The <code class="docutils literal notranslate"><span class="pre">thresh</span></code> parameter lets you specify a minimum number of non-null
values for the row/column to be kept:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;rows&#39;</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="filling-null-values">
<h4>Filling null values<a class="headerlink" href="#filling-null-values" title="Permalink to this headline">¶</a></h4>
<p>Sometimes rather than dropping NA values, you’d rather replace them with
a valid value. This value might be a single number like zero, or it
might be some sort of imputation or interpolation from the good values.
You could do this in-place using the <code class="docutils literal notranslate"><span class="pre">isnull()</span></code> method as a mask, but
because it is such a common operation Pandas provides the <code class="docutils literal notranslate"><span class="pre">fillna()</span></code>
method, which returns a copy of the array with the null values replaced.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">))</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">1.0</span>
<span class="n">b</span>    <span class="n">NaN</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="n">NaN</span>
<span class="n">e</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># fill NA entries with a single value</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">1.0</span>
<span class="n">b</span>    <span class="mf">0.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">0.0</span>
<span class="n">e</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span> <span class="c1"># specify a forward-fill to propagate the previous value forward</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">1.0</span>
<span class="n">b</span>    <span class="mf">1.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">2.0</span>
<span class="n">e</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span> <span class="c1"># specify a back-fill to propagate the next values backward</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span>    <span class="mf">1.0</span>
<span class="n">b</span>    <span class="mf">2.0</span>
<span class="n">c</span>    <span class="mf">2.0</span>
<span class="n">d</span>    <span class="mf">3.0</span>
<span class="n">e</span>    <span class="mf">3.0</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, the options are similar, but we can also specify
an <code class="docutils literal notranslate"><span class="pre">axis</span></code> along which the fills take place:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>6</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="hierarchical-indexing">
<h2>Hierarchical Indexing<a class="headerlink" href="#hierarchical-indexing" title="Permalink to this headline">¶</a></h2>
<p>Up to this point we’ve been focused primarily on one-dimensional and
two-dimensional data, stored in Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
objects, respectively. Often it is useful to go beyond this and store
higher-dimensional data–that is, data indexed by more than one or two
keys.</p>
<p>A far more common pattern in practice is to make use of <em>hierarchical
indexing</em> (also known as <em>multi-indexing</em>) to incorporate multiple index
<em>levels</em> within a single index. In this way, higher-dimensional data can
be compactly represented within the familiar one-dimensional <code class="docutils literal notranslate"><span class="pre">Series</span></code>
and two-dimensional <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects.</p>
<div class="section" id="a-multiply-indexed-series">
<h3>A Multiply Indexed Series<a class="headerlink" href="#a-multiply-indexed-series" title="Permalink to this headline">¶</a></h3>
<p>Let’s start by considering how we might represent two-dimensional data
within a one-dimensional <code class="docutils literal notranslate"><span class="pre">Series</span></code>.</p>
<div class="section" id="the-bad-way">
<h4>The bad way<a class="headerlink" href="#the-bad-way" title="Permalink to this headline">¶</a></h4>
<p>Suppose you would like to track data about states from two different
years. Using the Pandas tools we’ve already covered, you might be
tempted to simply use Python tuples as keys:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">),</span>
         <span class="p">(</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">),</span>
         <span class="p">(</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)]</span>
<span class="n">populations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">33871648</span><span class="p">,</span> <span class="mi">37253956</span><span class="p">,</span>
               <span class="mi">18976457</span><span class="p">,</span> <span class="mi">19378102</span><span class="p">,</span>
               <span class="mi">20851820</span><span class="p">,</span> <span class="mi">25145561</span><span class="p">]</span>
<span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">populations</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">pop</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">California</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>    <span class="mi">33871648</span>
<span class="p">(</span><span class="n">California</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>    <span class="mi">37253956</span>
<span class="p">(</span><span class="n">New</span> <span class="n">York</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>      <span class="mi">18976457</span>
<span class="p">(</span><span class="n">New</span> <span class="n">York</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>      <span class="mi">19378102</span>
<span class="p">(</span><span class="n">Texas</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>         <span class="mi">20851820</span>
<span class="p">(</span><span class="n">Texas</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>         <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>If you need to select all values from 2010, you’ll need to do some messy
(and potentially slow) munging to make it happen:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">index</span> <span class="k">if</span> <span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2010</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">California</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>    <span class="mi">37253956</span>
<span class="p">(</span><span class="n">New</span> <span class="n">York</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>      <span class="mi">19378102</span>
<span class="p">(</span><span class="n">Texas</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)</span>         <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="the-better-way-pandas-multiindex">
<h4>The Better Way: Pandas MultiIndex<a class="headerlink" href="#the-better-way-pandas-multiindex" title="Permalink to this headline">¶</a></h4>
<p>Our tuple-based indexing is essentially a rudimentary multi-index, and
the Pandas <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> type gives us the type of operations we wish
to have:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_tuples</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">index</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">),</span>
            <span class="p">(</span>  <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
            <span class="p">(</span>  <span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">),</span>
            <span class="p">(</span>     <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span>
            <span class="p">(</span>     <span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">)],</span>
           <span class="p">)</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> contains multiple <em>levels</em> of indexing–in this case,
the state names and the years, as well as multiple <em>labels</em> for each
data point which encode these levels.</p>
<p>If we re-index our series with this <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>, we see the
hierarchical representation of the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">pop</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Here the first two columns of the <code class="docutils literal notranslate"><span class="pre">Series</span></code> representation show the
multiple index values, while the third column shows the data.</p>
<p>Notice that some entries are missing in the first column: in this
multi-index representation, any blank entry indicates the same value as
the line above it.</p>
<p>Now to access all data for which the second index is 2010, we can simply
use the Pandas slicing notation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[:,</span> <span class="mi">2010</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>      <span class="mi">19378102</span>
<span class="n">Texas</span>         <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>The result is a singly indexed array with just the keys we’re interested
in. This syntax is much more convenient (and the operation is much more
efficient!) than the home-spun tuple-based multi-indexing solution that
we started with.</p>
</div>
<div class="section" id="multiindex-as-extra-dimension">
<h4>MultiIndex as extra dimension<a class="headerlink" href="#multiindex-as-extra-dimension" title="Permalink to this headline">¶</a></h4>
<p>We could have stored the same data using a simple <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> with
index and column labels; in fact, Pandas is built with this equivalence
in mind.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">unstack()</span></code> method will quickly convert a multiply indexed
<code class="docutils literal notranslate"><span class="pre">Series</span></code> into a conventionally indexed <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_df</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
<span class="n">pop_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2000</th>
      <th>2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>33871648</td>
      <td>37253956</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>18976457</td>
      <td>19378102</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>20851820</td>
      <td>25145561</td>
    </tr>
  </tbody>
</table>
</div><p>Naturally, the <code class="docutils literal notranslate"><span class="pre">stack()</span></code> method provides the opposite operation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_df</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Seeing this, you might wonder why would we would bother with
hierarchical indexing at all.</p>
<p>The reason is simple: just as we were able to use multi-indexing to
represent two-dimensional data within a one-dimensional <code class="docutils literal notranslate"><span class="pre">Series</span></code>, we
can also use it to represent data of three or more dimensions in a
<code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<p>Each extra level in a multi-index represents an extra dimension of data;
taking advantage of this property gives us much more flexibility in the
types of data we can represent.</p>
<p>Concretely, we might want to add another column of demographic data for
each state at each year (say, population under 18) ; with a
<code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> this is as easy as adding another column to the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="n">pop</span><span class="p">,</span>
                       <span class="s1">&#39;under18&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">9267089</span><span class="p">,</span> <span class="mi">9284094</span><span class="p">,</span>
                                   <span class="mi">4687374</span><span class="p">,</span> <span class="mi">4318033</span><span class="p">,</span>
                                   <span class="mi">5906301</span><span class="p">,</span> <span class="mi">6879014</span><span class="p">]})</span>
<span class="n">pop_df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>total</th>
      <th>under18</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">California</th>
      <th>2000</th>
      <td>33871648</td>
      <td>9267089</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>37253956</td>
      <td>9284094</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>2000</th>
      <td>18976457</td>
      <td>4687374</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>19378102</td>
      <td>4318033</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Texas</th>
      <th>2000</th>
      <td>20851820</td>
      <td>5906301</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>25145561</td>
      <td>6879014</td>
    </tr>
  </tbody>
</table>
</div><p>In addition, all the ufuncs work with hierarchical indices as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f_u18</span> <span class="o">=</span> <span class="n">pop_df</span><span class="p">[</span><span class="s1">&#39;under18&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">pop_df</span><span class="p">[</span><span class="s1">&#39;total&#39;</span><span class="p">]</span>
<span class="n">f_u18</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2000</th>
      <th>2010</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>0.273594</td>
      <td>0.249211</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>0.247010</td>
      <td>0.222831</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>0.283251</td>
      <td>0.273568</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="methods-of-multiindex-creation">
<h3>Methods of MultiIndex Creation<a class="headerlink" href="#methods-of-multiindex-creation" title="Permalink to this headline">¶</a></h3>
<p>The most straightforward way to construct a multiply indexed <code class="docutils literal notranslate"><span class="pre">Series</span></code>
or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> is to simply pass a list of two or more index arrays to
the constructor:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                  <span class="n">index</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                  <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">a</th>
      <th>1</th>
      <td>0.815709</td>
      <td>0.590718</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.373124</td>
      <td>0.688444</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">b</th>
      <th>1</th>
      <td>0.482064</td>
      <td>0.362575</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.881879</td>
      <td>0.346904</td>
    </tr>
  </tbody>
</table>
</div><p>Similarly, if you pass a dictionary with appropriate tuples as keys,
Pandas will automatically recognize this and use a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> by
default:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">{(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">):</span> <span class="mi">33871648</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">):</span> <span class="mi">37253956</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">):</span> <span class="mi">20851820</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;Texas&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">):</span> <span class="mi">25145561</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">):</span> <span class="mi">18976457</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;New York&#39;</span><span class="p">,</span> <span class="mi">2010</span><span class="p">):</span> <span class="mi">19378102</span><span class="p">}</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="section" id="explicit-multiindex-constructors">
<h4>Explicit MultiIndex constructors<a class="headerlink" href="#explicit-multiindex-constructors" title="Permalink to this headline">¶</a></h4>
<p>For more flexibility in how the index is constructed, you can instead
use the class method constructors available in the <code class="docutils literal notranslate"><span class="pre">pd.MultiIndex</span></code>.</p>
<p>You can construct the <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> from a simple list of arrays giving
the index values within each level:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_arrays</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
           <span class="p">)</span>
</pre></div>
</div>
<p>You can even construct it from a Cartesian product of single indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MultiIndex</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
           <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="multiindex-level-names">
<h4>MultiIndex level names<a class="headerlink" href="#multiindex-level-names" title="Permalink to this headline">¶</a></h4>
<p>Sometimes it is convenient to name the levels of the <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code>.
This can be accomplished by passing the <code class="docutils literal notranslate"><span class="pre">names</span></code> argument to any of the
above <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> constructors, or by setting the <code class="docutils literal notranslate"><span class="pre">names</span></code> attribute
of the index after the fact:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]</span>
<span class="n">pop</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>       <span class="n">year</span>
<span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="multiindex-for-columns">
<h4>MultiIndex for columns<a class="headerlink" href="#multiindex-for-columns" title="Permalink to this headline">¶</a></h4>
<p>In a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, the rows and columns are completely symmetric, and
just as the rows can have multiple levels of indices, the columns can
have multiple levels as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">2014</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;visit&#39;</span><span class="p">])</span>
<span class="n">columns</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;Temp&#39;</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># mock some data</span>
<span class="n">data</span><span class="p">[:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">+=</span> <span class="mi">37</span>

<span class="n">health_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
<span class="n">health_data</span> <span class="c1"># create the DataFrame</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>45.0</td>
      <td>37.2</td>
      <td>33.0</td>
      <td>38.8</td>
      <td>37.0</td>
      <td>37.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41.0</td>
      <td>37.6</td>
      <td>36.0</td>
      <td>37.4</td>
      <td>51.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>27.0</td>
      <td>37.0</td>
      <td>56.0</td>
      <td>37.5</td>
      <td>47.0</td>
      <td>38.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31.0</td>
      <td>36.8</td>
      <td>39.0</td>
      <td>36.4</td>
      <td>27.0</td>
      <td>35.2</td>
    </tr>
  </tbody>
</table>
</div><p>This is fundamentally four-dimensional data, where the dimensions are
the subject, the measurement type, the year, and the visit number; we
can index the top-level column by the person’s name and get a full
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> containing just that person’s information:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span><span class="p">[</span><span class="s1">&#39;Guido&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>33.0</td>
      <td>38.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>36.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>56.0</td>
      <td>37.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39.0</td>
      <td>36.4</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="indexing-and-slicing-a-multiindex">
<h3>Indexing and Slicing a MultiIndex<a class="headerlink" href="#indexing-and-slicing-a-multiindex" title="Permalink to this headline">¶</a></h3>
<p>Indexing and slicing on a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> is designed to be intuitive,
and it helps if you think about the indices as added dimensions.</p>
<div class="section" id="multiply-indexed-series">
<h4>Multiply indexed Series<a class="headerlink" href="#multiply-indexed-series" title="Permalink to this headline">¶</a></h4>
<p>Consider the multiply indexed <code class="docutils literal notranslate"><span class="pre">Series</span></code> of state populations we saw
earlier:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>       <span class="n">year</span>
<span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">]</span> <span class="c1"># access single elements by indexing with multiple terms</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">33871648</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> also supports <em>partial indexing</em>, or indexing just
one of the levels in the index. The result is another <code class="docutils literal notranslate"><span class="pre">Series</span></code>, with
the lower-level indices maintained:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[</span><span class="s1">&#39;California&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year</span>
<span class="mi">2000</span>    <span class="mi">33871648</span>
<span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Other types of indexing and selection could be based either on Boolean
masks:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[</span><span class="n">pop</span> <span class="o">&gt;</span> <span class="mi">22000000</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>       <span class="n">year</span>
<span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">Texas</span>       <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>or on fancy indexing:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="p">[[</span><span class="s1">&#39;California&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>       <span class="n">year</span>
<span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="multiply-indexed-dataframes">
<h4>Multiply indexed DataFrames<a class="headerlink" href="#multiply-indexed-dataframes" title="Permalink to this headline">¶</a></h4>
<p>A multiply indexed <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> behaves in a similar manner:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>45.0</td>
      <td>37.2</td>
      <td>33.0</td>
      <td>38.8</td>
      <td>37.0</td>
      <td>37.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41.0</td>
      <td>37.6</td>
      <td>36.0</td>
      <td>37.4</td>
      <td>51.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>27.0</td>
      <td>37.0</td>
      <td>56.0</td>
      <td>37.5</td>
      <td>47.0</td>
      <td>38.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31.0</td>
      <td>36.8</td>
      <td>39.0</td>
      <td>36.4</td>
      <td>27.0</td>
      <td>35.2</td>
    </tr>
  </tbody>
</table>
</div><p>Remember that columns are primary in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and the syntax
used for multiply indexed <code class="docutils literal notranslate"><span class="pre">Series</span></code> applies to the columns.</p>
<p>We can recover Guido’s heart rate data with a simple operation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span><span class="p">[</span><span class="s1">&#39;Guido&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year</span>  <span class="n">visit</span>
<span class="mi">2013</span>  <span class="mi">1</span>        <span class="mf">33.0</span>
      <span class="mi">2</span>        <span class="mf">36.0</span>
<span class="mi">2014</span>  <span class="mi">1</span>        <span class="mf">56.0</span>
      <span class="mi">2</span>        <span class="mf">39.0</span>
<span class="n">Name</span><span class="p">:</span> <span class="p">(</span><span class="n">Guido</span><span class="p">,</span> <span class="n">HR</span><span class="p">),</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Also, as with the single-index case, we can use the <code class="docutils literal notranslate"><span class="pre">loc</span></code>, <code class="docutils literal notranslate"><span class="pre">iloc</span></code>,
and <code class="docutils literal notranslate"><span class="pre">ix</span></code> indexers:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>45.0</td>
      <td>37.2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41.0</td>
      <td>37.6</td>
    </tr>
  </tbody>
</table>
</div><p>These indexers provide an array-like view of the underlying
two-dimensional data, but each individual index in <code class="docutils literal notranslate"><span class="pre">loc</span></code> or <code class="docutils literal notranslate"><span class="pre">iloc</span></code>
can be passed a tuple of multiple indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">year</span>  <span class="n">visit</span>
<span class="mi">2013</span>  <span class="mi">1</span>        <span class="mf">45.0</span>
      <span class="mi">2</span>        <span class="mf">41.0</span>
<span class="mi">2014</span>  <span class="mi">1</span>        <span class="mf">27.0</span>
      <span class="mi">2</span>        <span class="mf">31.0</span>
<span class="n">Name</span><span class="p">:</span> <span class="p">(</span><span class="n">Bob</span><span class="p">,</span> <span class="n">HR</span><span class="p">),</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="rearranging-multi-indices">
<h3>Rearranging Multi-Indices<a class="headerlink" href="#rearranging-multi-indices" title="Permalink to this headline">¶</a></h3>
<p>One of the keys to working with multiply indexed data is knowing how to
effectively transform the data.</p>
<p>There are a number of operations that will preserve all the information
in the dataset, but rearrange it for the purposes of various
computations.</p>
<p>We saw a brief example of this in the <code class="docutils literal notranslate"><span class="pre">stack()</span></code> and <code class="docutils literal notranslate"><span class="pre">unstack()</span></code>
methods, but there are many more ways to finely control the
rearrangement of data between hierarchical indices and columns.</p>
<div class="section" id="sorted-and-unsorted-indices">
<h4>Sorted and unsorted indices<a class="headerlink" href="#sorted-and-unsorted-indices" title="Permalink to this headline">¶</a></h4>
<p>Earlier, we briefly mentioned a caveat, but we should emphasize it more
here.</p>
<p><em>Many of the ``MultiIndex`` slicing operations will fail if the index is
not sorted.</em></p>
<p>We’ll start by creating some simple multiply indexed data where the
indices are <em>not lexographically sorted</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">MultiIndex</span><span class="o">.</span><span class="n">from_product</span><span class="p">([[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;char&#39;</span><span class="p">,</span> <span class="s1">&#39;int&#39;</span><span class="p">]</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span>  <span class="nb">int</span>
<span class="n">a</span>     <span class="mi">1</span>      <span class="mf">0.416187</span>
      <span class="mi">2</span>      <span class="mf">0.523686</span>
<span class="n">c</span>     <span class="mi">1</span>      <span class="mf">0.678899</span>
      <span class="mi">2</span>      <span class="mf">0.990513</span>
<span class="n">b</span>     <span class="mi">1</span>      <span class="mf">0.048998</span>
      <span class="mi">2</span>      <span class="mf">0.149826</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="c1"># try to take a partial slice of this index</span>
<span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.errors.UnsortedIndexError&#39;&gt;
&#39;Key length (1) was greater than MultiIndex lexsort depth (0)&#39;
</pre></div>
</div>
<p>This is the result of the MultiIndex not being sorted; in general,
partial slices and other similar operations require the levels in the
<code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> to be in sorted (i.e., lexographical) order.</p>
<p>Pandas provides a number of convenience routines to perform this type of
sorting; examples are the <code class="docutils literal notranslate"><span class="pre">sort_index()</span></code> and <code class="docutils literal notranslate"><span class="pre">sortlevel()</span></code> methods
of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span>  <span class="nb">int</span>
<span class="n">a</span>     <span class="mi">1</span>      <span class="mf">0.416187</span>
      <span class="mi">2</span>      <span class="mf">0.523686</span>
<span class="n">b</span>     <span class="mi">1</span>      <span class="mf">0.048998</span>
      <span class="mi">2</span>      <span class="mf">0.149826</span>
<span class="n">c</span>     <span class="mi">1</span>      <span class="mf">0.678899</span>
      <span class="mi">2</span>      <span class="mf">0.990513</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>With the index sorted in this way, partial slicing will work as
expected:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;b&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">char</span>  <span class="nb">int</span>
<span class="n">a</span>     <span class="mi">1</span>      <span class="mf">0.416187</span>
      <span class="mi">2</span>      <span class="mf">0.523686</span>
<span class="n">b</span>     <span class="mi">1</span>      <span class="mf">0.048998</span>
      <span class="mi">2</span>      <span class="mf">0.149826</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
</div>
<div class="section" id="stacking-and-unstacking-indices">
<h4>Stacking and unstacking indices<a class="headerlink" href="#stacking-and-unstacking-indices" title="Permalink to this headline">¶</a></h4>
<p>As we saw briefly before, it is possible to convert a dataset from a
stacked multi-index to a simple two-dimensional representation,
optionally specifying the level to use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>state</th>
      <th>California</th>
      <th>New York</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000</th>
      <td>33871648</td>
      <td>18976457</td>
      <td>20851820</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>37253956</td>
      <td>19378102</td>
      <td>25145561</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">unstack</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>year</th>
      <th>2000</th>
      <th>2010</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>California</th>
      <td>33871648</td>
      <td>37253956</td>
    </tr>
    <tr>
      <th>New York</th>
      <td>18976457</td>
      <td>19378102</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>20851820</td>
      <td>25145561</td>
    </tr>
  </tbody>
</table>
</div><p>The opposite of <code class="docutils literal notranslate"><span class="pre">unstack()</span></code> is <code class="docutils literal notranslate"><span class="pre">stack()</span></code>, which here can be used to
recover the original series:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>       <span class="n">year</span>
<span class="n">California</span>  <span class="mi">2000</span>    <span class="mi">33871648</span>
            <span class="mi">2010</span>    <span class="mi">37253956</span>
<span class="n">New</span> <span class="n">York</span>    <span class="mi">2000</span>    <span class="mi">18976457</span>
            <span class="mi">2010</span>    <span class="mi">19378102</span>
<span class="n">Texas</span>       <span class="mi">2000</span>    <span class="mi">20851820</span>
            <span class="mi">2010</span>    <span class="mi">25145561</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="index-setting-and-resetting">
<h4>Index setting and resetting<a class="headerlink" href="#index-setting-and-resetting" title="Permalink to this headline">¶</a></h4>
<p>Another way to rearrange hierarchical data is to turn the index labels
into columns; this can be accomplished with the <code class="docutils literal notranslate"><span class="pre">reset_index</span></code> method.</p>
<p>Calling this on the population dictionary will result in a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
with a <em>state</em> and <em>year</em> column holding the information that was
formerly in the index.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_flat</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;population&#39;</span><span class="p">)</span> <span class="c1"># specify the name of the data for the column</span>
<span class="n">pop_flat</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>year</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>California</td>
      <td>2000</td>
      <td>33871648</td>
    </tr>
    <tr>
      <th>1</th>
      <td>California</td>
      <td>2010</td>
      <td>37253956</td>
    </tr>
    <tr>
      <th>2</th>
      <td>New York</td>
      <td>2000</td>
      <td>18976457</td>
    </tr>
    <tr>
      <th>3</th>
      <td>New York</td>
      <td>2010</td>
      <td>19378102</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Texas</td>
      <td>2000</td>
      <td>20851820</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Texas</td>
      <td>2010</td>
      <td>25145561</td>
    </tr>
  </tbody>
</table>
</div><p>Often when working with data in the real world, the raw input data looks
like this and it’s useful to build a <code class="docutils literal notranslate"><span class="pre">MultiIndex</span></code> from the column
values. This can be done with the <code class="docutils literal notranslate"><span class="pre">set_index</span></code> method of the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, which returns a multiply indexed <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop_flat</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>population</th>
    </tr>
    <tr>
      <th>state</th>
      <th>year</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">California</th>
      <th>2000</th>
      <td>33871648</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>37253956</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">New York</th>
      <th>2000</th>
      <td>18976457</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>19378102</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Texas</th>
      <th>2000</th>
      <td>20851820</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>25145561</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="data-aggregations-on-multi-indices">
<h3>Data Aggregations on Multi-Indices<a class="headerlink" href="#data-aggregations-on-multi-indices" title="Permalink to this headline">¶</a></h3>
<p>We’ve previously seen that Pandas has built-in data aggregation methods,
such as <code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">sum()</span></code>, and <code class="docutils literal notranslate"><span class="pre">max()</span></code>. For hierarchically indexed
data, these can be passed a <code class="docutils literal notranslate"><span class="pre">level</span></code> parameter that controls which
subset of the data the aggregate is computed on.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">health_data</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th></th>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th>visit</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">2013</th>
      <th>1</th>
      <td>45.0</td>
      <td>37.2</td>
      <td>33.0</td>
      <td>38.8</td>
      <td>37.0</td>
      <td>37.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41.0</td>
      <td>37.6</td>
      <td>36.0</td>
      <td>37.4</td>
      <td>51.0</td>
      <td>37.4</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2014</th>
      <th>1</th>
      <td>27.0</td>
      <td>37.0</td>
      <td>56.0</td>
      <td>37.5</td>
      <td>47.0</td>
      <td>38.9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31.0</td>
      <td>36.8</td>
      <td>39.0</td>
      <td>36.4</td>
      <td>27.0</td>
      <td>35.2</td>
    </tr>
  </tbody>
</table>
</div><p>Perhaps we’d like to average-out the measurements in the two visits each
year. We can do this by naming the index level we’d like to explore, in
this case the year:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_mean</span> <span class="o">=</span> <span class="n">health_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">data_mean</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>subject</th>
      <th colspan="2" halign="left">Bob</th>
      <th colspan="2" halign="left">Guido</th>
      <th colspan="2" halign="left">Sue</th>
    </tr>
    <tr>
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>43.0</td>
      <td>37.4</td>
      <td>34.5</td>
      <td>38.10</td>
      <td>44.0</td>
      <td>37.60</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>29.0</td>
      <td>36.9</td>
      <td>47.5</td>
      <td>36.95</td>
      <td>37.0</td>
      <td>37.05</td>
    </tr>
  </tbody>
</table>
</div><p>By further making use of the <code class="docutils literal notranslate"><span class="pre">axis</span></code> keyword, we can take the mean
among levels on the columns as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_mean</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>type</th>
      <th>HR</th>
      <th>Temp</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2013</th>
      <td>40.500000</td>
      <td>37.700000</td>
    </tr>
    <tr>
      <th>2014</th>
      <td>37.833333</td>
      <td>36.966667</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="combining-datasets-concat-and-append">
<h2>Combining Datasets: Concat and Append<a class="headerlink" href="#combining-datasets-concat-and-append" title="Permalink to this headline">¶</a></h2>
<p>Some of the most interesting studies of data come from combining
different data sources. These operations can involve anything from very
straightforward concatenation of two different datasets, to more
complicated database-style joins and merges that correctly handle any
overlaps between the datasets. <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s are built
with this type of operation in mind, and Pandas includes functions and
methods that make this sort of data wrangling fast and straightforward.</p>
<p>Here we’ll take a look at simple concatenation of <code class="docutils literal notranslate"><span class="pre">Series</span></code> and
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s with the <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> function; later we’ll dive into
more sophisticated in-memory merges and joins implemented in Pandas.</p>
<p>For convenience, we’ll define this function which creates a
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> of a particular form that will be useful below:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_df</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Quickly make a DataFrame&quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ind</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ind</span><span class="p">)</span>

<span class="c1"># example DataFrame</span>
<span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div><p>In addition, we’ll create a quick class that allows us to display
multiple <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s side by side. The code makes use of the
special <code class="docutils literal notranslate"><span class="pre">_repr_html_</span></code> method, which IPython uses to implement its rich
object display:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">display</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display HTML representation of multiple objects&quot;&quot;&quot;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;div style=&quot;float: left; padding: 10px;&quot;&gt;</span>
<span class="s2">    &lt;p style=&#39;font-family:&quot;Courier New&quot;, Courier, monospace&#39;&gt;</span><span class="si">{0}</span><span class="s2">&lt;/p&gt;</span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">    &lt;/div&gt;&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">())</span>
                         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                           <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="simple-concatenation-with-pd-concat">
<h3>Simple Concatenation with <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code><a class="headerlink" href="#simple-concatenation-with-pd-concat" title="Permalink to this headline">¶</a></h3>
<p>Pandas has a function, <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>, which has a similar syntax to
<code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> but contains a number of options that we’ll discuss
momentarily:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Signature in Pandas v0.18</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span> <span class="n">join_axes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">keys</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code> can be used for a simple concatenation of <code class="docutils literal notranslate"><span class="pre">Series</span></code> or
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, just as <code class="docutils literal notranslate"><span class="pre">np.concatenate()</span></code> can be used for
simple concatenations of arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">ser2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ser1</span><span class="p">,</span> <span class="n">ser2</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>    <span class="n">A</span>
<span class="mi">2</span>    <span class="n">B</span>
<span class="mi">3</span>    <span class="n">C</span>
<span class="mi">4</span>    <span class="n">D</span>
<span class="mi">5</span>    <span class="n">E</span>
<span class="mi">6</span>    <span class="n">F</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df2&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.concat([df1, df2])&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([df1, df2])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>By default, the concatenation takes place row-wise within the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> (i.e., <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>). Like <code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code>, <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code>
allows specification of an axis along which concatenation will take
place:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;CD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df3&#39;</span><span class="p">,</span> <span class="s1">&#39;df4&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.concat([df3, df4], axis=1)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df3</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df4</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([df3, df4], axis=1)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
      <td>C0</td>
      <td>D0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>D1</td>
    </tr>
  </tbody>
</table>
</div>
    </div><div class="section" id="duplicate-indices">
<h4>Duplicate indices<a class="headerlink" href="#duplicate-indices" title="Permalink to this headline">¶</a></h4>
<p>One important difference between <code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> and <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> is
that Pandas concatenation <em>preserves indices</em>, even if the result will
have duplicate indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">y</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">index</span>  <span class="c1"># make duplicate indices!</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.concat([x, y])&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>x</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>y</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([x, y])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Notice the repeated indices in the result. While this is valid within
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, the outcome is often undesirable. <code class="docutils literal notranslate"><span class="pre">pd.concat()</span></code>
gives us a few ways to handle it.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">verify_integrity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ValueError:&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ValueError</span><span class="p">:</span> <span class="n">Indexes</span> <span class="n">have</span> <span class="n">overlapping</span> <span class="n">values</span><span class="p">:</span> <span class="n">Int64Index</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="ignoring-the-index">
<h5>Ignoring the index<a class="headerlink" href="#ignoring-the-index" title="Permalink to this headline">¶</a></h5>
<p>Sometimes the index itself does not matter, and you would prefer it to
simply be ignored. This option can be specified using the
<code class="docutils literal notranslate"><span class="pre">ignore_index</span></code> flag. With this set to true, the concatenation will
create a new integer index for the resulting <code class="docutils literal notranslate"><span class="pre">Series</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.concat([x, y], ignore_index=True)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>x</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>y</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([x, y], ignore_index=True)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="adding-multiindex-keys">
<h5>Adding MultiIndex keys<a class="headerlink" href="#adding-multiindex-keys" title="Permalink to this headline">¶</a></h5>
<p>Another option is to use the <code class="docutils literal notranslate"><span class="pre">keys</span></code> option to specify a label for the
data sources; the result will be a hierarchically indexed series
containing the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.concat([x, y], keys=[&#39;x&#39;, &#39;y&#39;])&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>x</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>y</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([x, y], keys=['x', 'y'])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">x</th>
      <th>0</th>
      <td>A0</td>
      <td>B0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">y</th>
      <th>0</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
</div>
<div class="section" id="concatenation-with-joins">
<h4>Concatenation with joins<a class="headerlink" href="#concatenation-with-joins" title="Permalink to this headline">¶</a></h4>
<p>In practice, data from different sources might have different sets of
column names, and <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code> offers several options in this case.
Consider the concatenation of the following two <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, which
have some (but not all!) columns in common:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;ABC&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">df6</span> <span class="o">=</span> <span class="n">make_df</span><span class="p">(</span><span class="s1">&#39;BCD&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df5&#39;</span><span class="p">,</span> <span class="s1">&#39;df6&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.concat([df5, df6])&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df5</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df6</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([df5, df6])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>By default, the join is a union of the input column|s
(<code class="docutils literal notranslate"><span class="pre">join='outer'</span></code>), but we can change this to an intersection of the
columns using <code class="docutils literal notranslate"><span class="pre">join='inner'</span></code>:</p>
<p>Another option is to directly specify the index of the remaininig colums
using the <code class="docutils literal notranslate"><span class="pre">join_axes</span></code> argument, which takes a list of index objects.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df5&#39;</span><span class="p">,</span> <span class="s1">&#39;df6&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.concat([df5, df6])&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df5</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df6</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.concat([df5, df6])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
      <th>C</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
      <td>C1</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
      <td>C2</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>B3</td>
      <td>C3</td>
      <td>D3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>B4</td>
      <td>C4</td>
      <td>D4</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="the-append-method">
<h4>The <code class="docutils literal notranslate"><span class="pre">append()</span></code> method<a class="headerlink" href="#the-append-method" title="Permalink to this headline">¶</a></h4>
<p>Because direct array concatenation is so common, <code class="docutils literal notranslate"><span class="pre">Series</span></code> and
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects have an <code class="docutils literal notranslate"><span class="pre">append</span></code> method that can accomplish the
same thing in fewer keystrokes. For example, rather than calling
<code class="docutils literal notranslate"><span class="pre">pd.concat([df1,</span> <span class="pre">df2])</span></code>, you can simply call <code class="docutils literal notranslate"><span class="pre">df1.append(df2)</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df2&#39;</span><span class="p">,</span> <span class="s1">&#39;df1.append(df2)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1.append(df2)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>A1</td>
      <td>B1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A2</td>
      <td>B2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A3</td>
      <td>B3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A4</td>
      <td>B4</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Keep in mind that unlike the <code class="docutils literal notranslate"><span class="pre">append()</span></code> and <code class="docutils literal notranslate"><span class="pre">extend()</span></code> methods of
Python lists, the <code class="docutils literal notranslate"><span class="pre">append()</span></code> method in Pandas does not modify the
original object–instead it creates a new object with the combined data.</p>
<p>It also is not a very efficient method, because it involves creation of
a new index <em>and</em> data buffer. Thus, if you plan to do multiple
<code class="docutils literal notranslate"><span class="pre">append</span></code> operations, it is generally better to build a list of
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s and pass them all at once to the <code class="docutils literal notranslate"><span class="pre">concat()</span></code> function.</p>
</div>
</div>
</div>
<div class="section" id="combining-datasets-merge-and-join">
<h2>Combining Datasets: Merge and Join<a class="headerlink" href="#combining-datasets-merge-and-join" title="Permalink to this headline">¶</a></h2>
<p>One essential feature offered by Pandas is its high-performance,
in-memory join and merge operations. If you have ever worked with
databases, you should be familiar with this type of data interaction.
The main interface for this is the <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> function, and we’ll see
few examples of how this can work in practice.</p>
<p>For convenience, we will start by redefining the <code class="docutils literal notranslate"><span class="pre">display()</span></code>
functionality:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">display</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display HTML representation of multiple objects&quot;&quot;&quot;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;div style=&quot;float: left; padding: 10px;&quot;&gt;</span>
<span class="s2">    &lt;p style=&#39;font-family:&quot;Courier New&quot;, Courier, monospace&#39;&gt;</span><span class="si">{0}</span><span class="s2">&lt;/p&gt;</span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">    &lt;/div&gt;&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">())</span>
                         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                           <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="relational-algebra">
<h3>Relational Algebra<a class="headerlink" href="#relational-algebra" title="Permalink to this headline">¶</a></h3>
<p>The behavior implemented in <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> is a subset of what is known
as <em>relational algebra</em>, which is a formal set of rules for manipulating
relational data, and forms the conceptual foundation of operations
available in most databases. The strength of the relational algebra
approach is that it proposes several primitive operations, which become
the building blocks of more complicated operations on any dataset. With
this lexicon of fundamental operations implemented efficiently in a
database or other program, a wide range of fairly complicated composite
operations can be performed.</p>
<p>Pandas implements several of these fundamental building-blocks in the
<code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function and the related <code class="docutils literal notranslate"><span class="pre">join()</span></code> method of <code class="docutils literal notranslate"><span class="pre">Series</span></code>
and <code class="docutils literal notranslate"><span class="pre">Dataframe</span></code>s.</p>
</div>
<div class="section" id="categories-of-joins">
<h3>Categories of Joins<a class="headerlink" href="#categories-of-joins" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function implements a number of types of joins: the
<em>one-to-one</em>, <em>many-to-one</em>, and <em>many-to-many</em> joins. All three types
of joins are accessed via an identical call to the <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>
interface; the type of join performed depends on the form of the input
data.</p>
<div class="section" id="one-to-one-joins">
<h4>One-to-one joins<a class="headerlink" href="#one-to-one-joins" title="Permalink to this headline">¶</a></h4>
<p>Perhaps the simplest type of merge expresion is the one-to-one join,
which is in many ways very similar to the column-wise concatenation that
we have already seen. As a concrete example, consider the following two
<code class="docutils literal notranslate"><span class="pre">DataFrames</span></code> which contain information on several employees in a
company:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;employee&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Lisa&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Accounting&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;employee&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lisa&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;hire_date&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2004</span><span class="p">,</span> <span class="mi">2008</span><span class="p">,</span> <span class="mi">2012</span><span class="p">,</span> <span class="mi">2014</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>hire_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lisa</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jake</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>To combine this information into a single <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, we can use the
<code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
<span class="n">df3</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>hire_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div><p>The <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function recognizes that each <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> has an
“employee” column, and automatically joins using this column as a key.
The result of the merge is a new <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> that combines the
information from the two inputs. Notice that the order of entries in
each column is not necessarily maintained: in this case, the order of
the “employee” column differs between <code class="docutils literal notranslate"><span class="pre">df1</span></code> and <code class="docutils literal notranslate"><span class="pre">df2</span></code>, and the
<code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> function correctly accounts for this. Additionally, keep
in mind that the merge in general discards the index, except in the
special case of merges by index (see the <code class="docutils literal notranslate"><span class="pre">left_index</span></code> and
<code class="docutils literal notranslate"><span class="pre">right_index</span></code> keywords, discussed momentarily).</p>
</div>
<div class="section" id="many-to-one-joins">
<h4>Many-to-one joins<a class="headerlink" href="#many-to-one-joins" title="Permalink to this headline">¶</a></h4>
<p>Many-to-one joins are joins in which one of the two key columns contains
duplicate entries. For the many-to-one case, the resulting <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
will preserve those duplicate entries as appropriate:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Accounting&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;supervisor&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Carly&#39;</span><span class="p">,</span> <span class="s1">&#39;Guido&#39;</span><span class="p">,</span> <span class="s1">&#39;Steve&#39;</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df3&#39;</span><span class="p">,</span> <span class="s1">&#39;df4&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.merge(df3, df4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df3</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>hire_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df4</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>supervisor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Accounting</td>
      <td>Carly</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Engineering</td>
      <td>Guido</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HR</td>
      <td>Steve</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df3, df4)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>hire_date</th>
      <th>supervisor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>2008</td>
      <td>Carly</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>2012</td>
      <td>Guido</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>2004</td>
      <td>Guido</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>2014</td>
      <td>Steve</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="many-to-many-joins">
<h4>Many-to-many joins<a class="headerlink" href="#many-to-many-joins" title="Permalink to this headline">¶</a></h4>
<p>Many-to-many joins are a bit confusing conceptually, but are
nevertheless well defined. If the key column in both the left and right
array contains duplicates, then the result is a many-to-many merge.
Consider the following, where we have a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> showing one or
more skills associated with a particular group. By performing a
many-to-many join, we can recover the skills associated with any
individual person:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;group&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Accounting&#39;</span><span class="p">,</span> <span class="s1">&#39;Accounting&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;Engineering&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">,</span> <span class="s1">&#39;HR&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;skills&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;math&#39;</span><span class="p">,</span> <span class="s1">&#39;spreadsheets&#39;</span><span class="p">,</span> <span class="s1">&#39;coding&#39;</span><span class="p">,</span> <span class="s1">&#39;linux&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;spreadsheets&#39;</span><span class="p">,</span> <span class="s1">&#39;organization&#39;</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df5&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.merge(df1, df5)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df5</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Accounting</td>
      <td>math</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Accounting</td>
      <td>spreadsheets</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Engineering</td>
      <td>coding</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Engineering</td>
      <td>linux</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HR</td>
      <td>spreadsheets</td>
    </tr>
    <tr>
      <th>5</th>
      <td>HR</td>
      <td>organization</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df1, df5)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>skills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>math</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>spreadsheets</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>coding</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>linux</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>coding</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>linux</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sue</td>
      <td>HR</td>
      <td>spreadsheets</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Sue</td>
      <td>HR</td>
      <td>organization</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
</div>
<div class="section" id="specification-of-the-merge-key">
<h3>Specification of the Merge Key<a class="headerlink" href="#specification-of-the-merge-key" title="Permalink to this headline">¶</a></h3>
<p>We’ve already seen the default behavior of <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>: it looks for
one or more matching column names between the two inputs, and uses this
as the key. However, often the column names will not match so nicely,
and <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code> provides a variety of options for handling this.</p>
<div class="section" id="the-on-keyword">
<h4>The <code class="docutils literal notranslate"><span class="pre">on</span></code> keyword<a class="headerlink" href="#the-on-keyword" title="Permalink to this headline">¶</a></h4>
<p>Most simply, you can explicitly specify the name of the key column using
the <code class="docutils literal notranslate"><span class="pre">on</span></code> keyword, which takes a column name or a list of column names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df2&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.merge(df1, df2, on=&#39;employee&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>hire_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Lisa</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jake</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df1, df2, on='employee')</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>hire_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="the-left-on-and-right-on-keywords">
<h4>The <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> keywords<a class="headerlink" href="#the-left-on-and-right-on-keywords" title="Permalink to this headline">¶</a></h4>
<p>At times you may wish to merge two datasets with different column names;
for example, we may have a dataset in which the employee name is labeled
as “name” rather than “employee”. In this case, we can use the
<code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> keywords to specify the two column names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Lisa&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;salary&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">70000</span><span class="p">,</span> <span class="mi">80000</span><span class="p">,</span> <span class="mi">120000</span><span class="p">,</span> <span class="mi">90000</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1&#39;</span><span class="p">,</span> <span class="s1">&#39;df3&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.merge(df1, df3, left_on=&quot;employee&quot;, right_on=&quot;name&quot;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df3</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>120000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df1, df3, left_on="employee", right_on="name")</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>name</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>Bob</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>Jake</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>Lisa</td>
      <td>120000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>Sue</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>The result has a redundant column that we can drop if desired–for
example, by using the <code class="docutils literal notranslate"><span class="pre">drop()</span></code> method of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df3</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;employee&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>employee</th>
      <th>group</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>Accounting</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>Engineering</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>Engineering</td>
      <td>120000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>HR</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="the-left-index-and-right-index-keywords">
<h4>The <code class="docutils literal notranslate"><span class="pre">left_index</span></code> and <code class="docutils literal notranslate"><span class="pre">right_index</span></code> keywords<a class="headerlink" href="#the-left-index-and-right-index-keywords" title="Permalink to this headline">¶</a></h4>
<p>Sometimes, rather than merging on a column, you would instead like to
merge on an index. For example, your data might look like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1a</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">)</span>
<span class="n">df2a</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;employee&#39;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1a&#39;</span><span class="p">,</span> <span class="s1">&#39;df2a&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hire_date</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lisa</th>
      <td>2004</td>
    </tr>
    <tr>
      <th>Bob</th>
      <td>2008</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>2012</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>You can use the index as the key for merging by specifying the
<code class="docutils literal notranslate"><span class="pre">left_index</span></code> and/or <code class="docutils literal notranslate"><span class="pre">right_index</span></code> flags in <code class="docutils literal notranslate"><span class="pre">pd.merge()</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1a&#39;</span><span class="p">,</span> <span class="s1">&#39;df2a&#39;</span><span class="p">,</span>
        <span class="s2">&quot;pd.merge(df1a, df2a, left_index=True, right_index=True)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hire_date</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lisa</th>
      <td>2004</td>
    </tr>
    <tr>
      <th>Bob</th>
      <td>2008</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>2012</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df1a, df2a, left_index=True, right_index=True)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>hire_date</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>For convenience, <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s implement the <code class="docutils literal notranslate"><span class="pre">join()</span></code> method, which
performs a merge that defaults to joining on indices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1a&#39;</span><span class="p">,</span> <span class="s1">&#39;df2a&#39;</span><span class="p">,</span> <span class="s1">&#39;df1a.join(df2a)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hire_date</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Lisa</th>
      <td>2004</td>
    </tr>
    <tr>
      <th>Bob</th>
      <td>2008</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>2012</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1a.join(df2a)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>hire_date</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
      <td>2012</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
      <td>2004</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
      <td>2014</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>If you’d like to mix indices and columns, you can combine <code class="docutils literal notranslate"><span class="pre">left_index</span></code>
with <code class="docutils literal notranslate"><span class="pre">right_on</span></code> or <code class="docutils literal notranslate"><span class="pre">left_on</span></code> with <code class="docutils literal notranslate"><span class="pre">right_index</span></code> to get the desired
behavior:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df1a&#39;</span><span class="p">,</span> <span class="s1">&#39;df3&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.merge(df1a, df3, left_index=True, right_on=&#39;name&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df1a</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
    </tr>
    <tr>
      <th>employee</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bob</th>
      <td>Accounting</td>
    </tr>
    <tr>
      <th>Jake</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Lisa</th>
      <td>Engineering</td>
    </tr>
    <tr>
      <th>Sue</th>
      <td>HR</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df3</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>120000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df1a, df3, left_index=True, right_on='name')</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>group</th>
      <th>name</th>
      <th>salary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Accounting</td>
      <td>Bob</td>
      <td>70000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Engineering</td>
      <td>Jake</td>
      <td>80000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Engineering</td>
      <td>Lisa</td>
      <td>120000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HR</td>
      <td>Sue</td>
      <td>90000</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
</div>
<div class="section" id="specifying-set-arithmetic-for-joins">
<h3>Specifying Set Arithmetic for Joins<a class="headerlink" href="#specifying-set-arithmetic-for-joins" title="Permalink to this headline">¶</a></h3>
<p>We have glossed over one important consideration in performing a join:
the type of set arithmetic used in the join. This comes up when a value
appears in one key column but not the other:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Peter&#39;</span><span class="p">,</span> <span class="s1">&#39;Paul&#39;</span><span class="p">,</span> <span class="s1">&#39;Mary&#39;</span><span class="p">],</span> <span class="s1">&#39;food&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;fish&#39;</span><span class="p">,</span> <span class="s1">&#39;beans&#39;</span><span class="p">,</span> <span class="s1">&#39;bread&#39;</span><span class="p">]},</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;food&#39;</span><span class="p">])</span>
<span class="n">df7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Mary&#39;</span><span class="p">,</span> <span class="s1">&#39;Joseph&#39;</span><span class="p">],</span> <span class="s1">&#39;drink&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;wine&#39;</span><span class="p">,</span> <span class="s1">&#39;beer&#39;</span><span class="p">]},</span>
                   <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;drink&#39;</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df6&#39;</span><span class="p">,</span> <span class="s1">&#39;df7&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.merge(df6, df7)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df6</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Peter</td>
      <td>fish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paul</td>
      <td>beans</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary</td>
      <td>bread</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df7</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>wine</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joseph</td>
      <td>beer</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df6, df7)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>bread</td>
      <td>wine</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Here we have merged two datasets that have only a single “name” entry in
common: Mary. By default, the result contains the <em>intersection</em> of the
two sets of inputs; this is what is known as an <em>inner join</em>. We can
specify this explicitly using the <code class="docutils literal notranslate"><span class="pre">how</span></code> keyword, which defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;inner&quot;</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df6</span><span class="p">,</span> <span class="n">df7</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>bread</td>
      <td>wine</td>
    </tr>
  </tbody>
</table>
</div><p>Other options for the <code class="docutils literal notranslate"><span class="pre">how</span></code> keyword are <code class="docutils literal notranslate"><span class="pre">'outer'</span></code>, <code class="docutils literal notranslate"><span class="pre">'left'</span></code>, and
<code class="docutils literal notranslate"><span class="pre">'right'</span></code>. An <em>outer join</em> returns a join over the union of the input
columns, and fills in all missing values with NAs:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df6&#39;</span><span class="p">,</span> <span class="s1">&#39;df7&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.merge(df6, df7, how=&#39;outer&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df6</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Peter</td>
      <td>fish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paul</td>
      <td>beans</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary</td>
      <td>bread</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df7</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>wine</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joseph</td>
      <td>beer</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df6, df7, how='outer')</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Peter</td>
      <td>fish</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paul</td>
      <td>beans</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary</td>
      <td>bread</td>
      <td>wine</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Joseph</td>
      <td>NaN</td>
      <td>beer</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>The <em>left join</em> and <em>right join</em> return joins over the left entries and
right entries, respectively:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df6&#39;</span><span class="p">,</span> <span class="s1">&#39;df7&#39;</span><span class="p">,</span> <span class="s2">&quot;pd.merge(df6, df7, how=&#39;left&#39;)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df6</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Peter</td>
      <td>fish</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paul</td>
      <td>beans</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary</td>
      <td>bread</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df7</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mary</td>
      <td>wine</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Joseph</td>
      <td>beer</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df6, df7, how='left')</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>food</th>
      <th>drink</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Peter</td>
      <td>fish</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paul</td>
      <td>beans</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mary</td>
      <td>bread</td>
      <td>wine</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="overlapping-column-names-the-suffixes-keyword">
<h3>Overlapping Column Names: The <code class="docutils literal notranslate"><span class="pre">suffixes</span></code> Keyword<a class="headerlink" href="#overlapping-column-names-the-suffixes-keyword" title="Permalink to this headline">¶</a></h3>
<p>Finally, you may end up in a case where your two input <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s
have conflicting column names:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Lisa&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="n">df9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Jake&#39;</span><span class="p">,</span> <span class="s1">&#39;Lisa&#39;</span><span class="p">,</span> <span class="s1">&#39;Sue&#39;</span><span class="p">],</span>
                    <span class="s1">&#39;rank&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df8&#39;</span><span class="p">,</span> <span class="s1">&#39;df9&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.merge(df8, df9, on=&quot;name&quot;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df8</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df9</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df8, df9, on="name")</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank_x</th>
      <th>rank_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Because the output would have two conflicting column names, the merge
function automatically appends a suffix <code class="docutils literal notranslate"><span class="pre">_x</span></code> or <code class="docutils literal notranslate"><span class="pre">_y</span></code> to make the
output columns unique. If these defaults are inappropriate, it is
possible to specify a custom suffix using the <code class="docutils literal notranslate"><span class="pre">suffixes</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df8&#39;</span><span class="p">,</span> <span class="s1">&#39;df9&#39;</span><span class="p">,</span> <span class="s1">&#39;pd.merge(df8, df9, on=&quot;name&quot;, suffixes=[&quot;_L&quot;, &quot;_R&quot;])&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df8</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df9</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pd.merge(df8, df9, on="name", suffixes=["_L", "_R"])</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>rank_L</th>
      <th>rank_R</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob</td>
      <td>1</td>
      <td>3</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jake</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa</td>
      <td>3</td>
      <td>4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sue</td>
      <td>4</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="example-us-states-data">
<h3>Example: US States Data<a class="headerlink" href="#example-us-states-data" title="Permalink to this headline">¶</a></h3>
<p>Merge and join operations come up most often when combining data from
different sources. Here we will consider an example of some data about
US states and their populations. The data files can be found at
<a class="reference external" href="http://github.com/jakevdp/data-USstates/">http://github.com/jakevdp/data-USstates/</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pop</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/state-population.csv&#39;</span><span class="p">)</span>
<span class="n">areas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/state-areas.csv&#39;</span><span class="p">)</span>
<span class="n">abbrevs</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/state-abbrevs.csv&#39;</span><span class="p">)</span>

<span class="n">display</span><span class="p">(</span><span class="s1">&#39;pop.head()&#39;</span><span class="p">,</span> <span class="s1">&#39;areas.head()&#39;</span><span class="p">,</span> <span class="s1">&#39;abbrevs.head()&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>pop.head()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>areas.head()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>52423</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alaska</td>
      <td>656425</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arizona</td>
      <td>114006</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arkansas</td>
      <td>53182</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>163707</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>abbrevs.head()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>abbreviation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alaska</td>
      <td>AK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arizona</td>
      <td>AZ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arkansas</td>
      <td>AR</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Given this information, say we want to compute a relatively
straightforward result: rank US states and territories by their 2010
population density. We clearly have the data here to find this result,
but we’ll have to combine the datasets to find the result.</p>
<p>We’ll start with a many-to-one merge that will give us the full state
name within the population <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. We want to merge based on the
<code class="docutils literal notranslate"><span class="pre">state/region</span></code> column of <code class="docutils literal notranslate"><span class="pre">pop</span></code>, and the <code class="docutils literal notranslate"><span class="pre">abbreviation</span></code> column of
<code class="docutils literal notranslate"><span class="pre">abbrevs</span></code>. We’ll use <code class="docutils literal notranslate"><span class="pre">how='outer'</span></code> to make sure no data is thrown
away due to mismatched labels.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">abbrevs</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;outer&#39;</span><span class="p">,</span>
                  <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;state/region&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;abbreviation&#39;</span><span class="p">)</span>
<span class="n">merged</span> <span class="o">=</span> <span class="n">merged</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;abbreviation&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># drop duplicate info</span>
<span class="n">merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
    </tr>
  </tbody>
</table>
</div><p>Let’s double-check whether there were any mismatches here, which we can
do by looking for rows with nulls:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="o">/</span><span class="n">region</span>    <span class="kc">False</span>
<span class="n">ages</span>            <span class="kc">False</span>
<span class="n">year</span>            <span class="kc">False</span>
<span class="n">population</span>       <span class="kc">True</span>
<span class="n">state</span>            <span class="kc">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<p>Some of the <code class="docutils literal notranslate"><span class="pre">population</span></code> info is null:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2448</th>
      <td>PR</td>
      <td>under18</td>
      <td>1990</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2449</th>
      <td>PR</td>
      <td>total</td>
      <td>1990</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2450</th>
      <td>PR</td>
      <td>total</td>
      <td>1991</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2451</th>
      <td>PR</td>
      <td>under18</td>
      <td>1991</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2452</th>
      <td>PR</td>
      <td>total</td>
      <td>1993</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div><p>It appears that all the null population values are from Puerto Rico
prior to the year 2000; this is likely due to this data not being
available from the original source.</p>
<p>More importantly, we see also that some of the new <code class="docutils literal notranslate"><span class="pre">state</span></code> entries are
also null, which means that there was no corresponding entry in the
<code class="docutils literal notranslate"><span class="pre">abbrevs</span></code> key! Let’s figure out which regions lack this match:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">(),</span> <span class="s1">&#39;state/region&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;PR&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p>We can quickly infer the issue: our population data includes entries for
Puerto Rico (PR) and the United States as a whole (USA), while these
entries do not appear in the state abbreviation key. We can fix these
quickly by filling in appropriate entries:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;state/region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;PR&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Puerto Rico&#39;</span>
<span class="n">merged</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">merged</span><span class="p">[</span><span class="s1">&#39;state/region&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;state&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;United States&#39;</span>
<span class="n">merged</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="o">/</span><span class="n">region</span>    <span class="kc">False</span>
<span class="n">ages</span>            <span class="kc">False</span>
<span class="n">year</span>            <span class="kc">False</span>
<span class="n">population</span>       <span class="kc">True</span>
<span class="n">state</span>           <span class="kc">False</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<p>No more nulls in the <code class="docutils literal notranslate"><span class="pre">state</span></code> column: we’re all set!</p>
<p>Now we can merge the result with the area data using a similar
procedure. Examining our results, we will want to join on the <code class="docutils literal notranslate"><span class="pre">state</span></code>
column in both:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">merged</span><span class="p">,</span> <span class="n">areas</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div><p>Again, let’s check for nulls to see if there were any mismatches:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span><span class="o">/</span><span class="n">region</span>     <span class="kc">False</span>
<span class="n">ages</span>             <span class="kc">False</span>
<span class="n">year</span>             <span class="kc">False</span>
<span class="n">population</span>        <span class="kc">True</span>
<span class="n">state</span>            <span class="kc">False</span>
<span class="n">area</span> <span class="p">(</span><span class="n">sq</span><span class="o">.</span> <span class="n">mi</span><span class="p">)</span>     <span class="kc">True</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
<p>There are nulls in the <code class="docutils literal notranslate"><span class="pre">area</span></code> column; we can take a look to see which
regions were ignored here:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;state&#39;</span><span class="p">][</span><span class="n">final</span><span class="p">[</span><span class="s1">&#39;area (sq. mi)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;United States&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span>
</pre></div>
</div>
<p>We see that our <code class="docutils literal notranslate"><span class="pre">areas</span></code> <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> does not contain the area of the
United States as a whole. We could insert the appropriate value (using
the sum of all state areas, for instance), but in this case we’ll just
drop the null values because the population density of the entire United
States is not relevant to our current discussion:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AL</td>
      <td>under18</td>
      <td>2012</td>
      <td>1117489.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AL</td>
      <td>total</td>
      <td>2012</td>
      <td>4817528.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AL</td>
      <td>under18</td>
      <td>2010</td>
      <td>1130966.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AL</td>
      <td>under18</td>
      <td>2011</td>
      <td>1125763.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
  </tbody>
</table>
</div><p>Now we have all the data we need. To answer the question of interest,
let’s first select the portion of the data corresponding with the year
2000, and the total population. We’ll use the <code class="docutils literal notranslate"><span class="pre">query()</span></code> function to do
this quickly:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2010</span> <span class="o">=</span> <span class="n">final</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;year == 2010 &amp; ages == &#39;total&#39;&quot;</span><span class="p">)</span>
<span class="n">data2010</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state/region</th>
      <th>ages</th>
      <th>year</th>
      <th>population</th>
      <th>state</th>
      <th>area (sq. mi)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>AL</td>
      <td>total</td>
      <td>2010</td>
      <td>4785570.0</td>
      <td>Alabama</td>
      <td>52423.0</td>
    </tr>
    <tr>
      <th>91</th>
      <td>AK</td>
      <td>total</td>
      <td>2010</td>
      <td>713868.0</td>
      <td>Alaska</td>
      <td>656425.0</td>
    </tr>
    <tr>
      <th>101</th>
      <td>AZ</td>
      <td>total</td>
      <td>2010</td>
      <td>6408790.0</td>
      <td>Arizona</td>
      <td>114006.0</td>
    </tr>
    <tr>
      <th>189</th>
      <td>AR</td>
      <td>total</td>
      <td>2010</td>
      <td>2922280.0</td>
      <td>Arkansas</td>
      <td>53182.0</td>
    </tr>
    <tr>
      <th>197</th>
      <td>CA</td>
      <td>total</td>
      <td>2010</td>
      <td>37333601.0</td>
      <td>California</td>
      <td>163707.0</td>
    </tr>
  </tbody>
</table>
</div><p>Now let’s compute the population density and display it in order. We’ll
start by re-indexing our data on the state, and then compute the result:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data2010</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">data2010</span><span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data2010</span><span class="p">[</span><span class="s1">&#39;area (sq. mi)&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">density</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">density</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>
<span class="n">District</span> <span class="n">of</span> <span class="n">Columbia</span>    <span class="mf">8898.897059</span>
<span class="n">Puerto</span> <span class="n">Rico</span>             <span class="mf">1058.665149</span>
<span class="n">New</span> <span class="n">Jersey</span>              <span class="mf">1009.253268</span>
<span class="n">Rhode</span> <span class="n">Island</span>             <span class="mf">681.339159</span>
<span class="n">Connecticut</span>              <span class="mf">645.600649</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>The result is a ranking of US states plus Washington, DC, and Puerto
Rico in order of their 2010 population density, in residents per square
mile. We can see that by far the densest region in this dataset is
Washington, DC (i.e., the District of Columbia); among states, the
densest is New Jersey.</p>
<p>We can also check the end of the list:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">density</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state</span>
<span class="n">South</span> <span class="n">Dakota</span>    <span class="mf">10.583512</span>
<span class="n">North</span> <span class="n">Dakota</span>     <span class="mf">9.537565</span>
<span class="n">Montana</span>          <span class="mf">6.736171</span>
<span class="n">Wyoming</span>          <span class="mf">5.768079</span>
<span class="n">Alaska</span>           <span class="mf">1.087509</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>We see that the least dense state, by far, is Alaska, averaging slightly
over one resident per square mile.</p>
<p>This type of messy data merging is a common task when trying to answer
questions using real-world data sources.</p>
</div>
</div>
<div class="section" id="aggregation-and-grouping">
<h2>Aggregation and Grouping<a class="headerlink" href="#aggregation-and-grouping" title="Permalink to this headline">¶</a></h2>
<p>An essential piece of analysis of large data is efficient summarization:
computing aggregations like <code class="docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">median()</span></code>,
<code class="docutils literal notranslate"><span class="pre">min()</span></code>, and <code class="docutils literal notranslate"><span class="pre">max()</span></code>, in which a single number gives insight into
the nature of a potentially large dataset.</p>
<p>we’ll use the same <code class="docutils literal notranslate"><span class="pre">display</span></code> magic function as usual:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">display</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Display HTML representation of multiple objects&quot;&quot;&quot;</span>
    <span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;&lt;div style=&quot;float: left; padding: 10px;&quot;&gt;</span>
<span class="s2">    &lt;p style=&#39;font-family:&quot;Courier New&quot;, Courier, monospace&#39;&gt;</span><span class="si">{0}</span><span class="s2">&lt;/p&gt;</span><span class="si">{1}</span><span class="s2"></span>
<span class="s2">    &lt;/div&gt;&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>

    <span class="k">def</span> <span class="nf">_repr_html_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">())</span>
                         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">repr</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
                           <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="planets-data">
<h3>Planets Data<a class="headerlink" href="#planets-data" title="Permalink to this headline">¶</a></h3>
<p>Here we will use the Planets dataset, available via the <a class="reference external" href="http://seaborn.pydata.org/">Seaborn
package</a>. It gives information on planets
that astronomers have discovered around other stars (known as
<em>extrasolar planets</em> or <em>exoplanets</em> for short). It can be downloaded
with a simple Seaborn command:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">planets</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;planets&#39;</span><span class="p">)</span>
<span class="n">planets</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 1,000+ extrasolar planets discovered up to 2014.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1035</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="simple-aggregation-in-pandas">
<h3>Simple Aggregation in Pandas<a class="headerlink" href="#simple-aggregation-in-pandas" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">ser</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ser</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mf">0.374540</span>
<span class="mi">1</span>    <span class="mf">0.950714</span>
<span class="mi">2</span>    <span class="mf">0.731994</span>
<span class="mi">3</span>    <span class="mf">0.598658</span>
<span class="mi">4</span>    <span class="mf">0.156019</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">ser</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">2.811925491708157</span><span class="p">,</span> <span class="mf">0.5623850983416314</span><span class="p">)</span>
</pre></div>
</div>
<p>For a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, by default the aggregates return results within
each column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">)})</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.183405</td>
      <td>0.611853</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.304242</td>
      <td>0.139494</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.524756</td>
      <td>0.292145</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.431945</td>
      <td>0.366362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.291229</td>
      <td>0.456070</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span>    <span class="mf">0.347115</span>
<span class="n">B</span>    <span class="mf">0.373185</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>By specifying the <code class="docutils literal notranslate"><span class="pre">axis</span></code> argument, you can instead aggregate within
each row:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>    <span class="mf">0.397629</span>
<span class="mi">1</span>    <span class="mf">0.221868</span>
<span class="mi">2</span>    <span class="mf">0.408451</span>
<span class="mi">3</span>    <span class="mf">0.399153</span>
<span class="mi">4</span>    <span class="mf">0.373650</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<p>Pandas <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s provide a convenience method
<code class="docutils literal notranslate"><span class="pre">describe()</span></code> that computes several common aggregates for each column
and returns the result:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1"># dropping rows with missing values</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>498.00000</td>
      <td>498.000000</td>
      <td>498.000000</td>
      <td>498.000000</td>
      <td>498.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.73494</td>
      <td>835.778671</td>
      <td>2.509320</td>
      <td>52.068213</td>
      <td>2007.377510</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.17572</td>
      <td>1469.128259</td>
      <td>3.636274</td>
      <td>46.596041</td>
      <td>4.167284</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1.00000</td>
      <td>1.328300</td>
      <td>0.003600</td>
      <td>1.350000</td>
      <td>1989.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.00000</td>
      <td>38.272250</td>
      <td>0.212500</td>
      <td>24.497500</td>
      <td>2005.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.00000</td>
      <td>357.000000</td>
      <td>1.245000</td>
      <td>39.940000</td>
      <td>2009.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.00000</td>
      <td>999.600000</td>
      <td>2.867500</td>
      <td>59.332500</td>
      <td>2011.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.00000</td>
      <td>17337.500000</td>
      <td>25.000000</td>
      <td>354.000000</td>
      <td>2014.000000</td>
    </tr>
  </tbody>
</table>
</div><p>This can be a useful way to begin understanding the overall properties
of a dataset. For example, we see in the <code class="docutils literal notranslate"><span class="pre">year</span></code> column that although
exoplanets were discovered as far back as 1989, half of all known
expolanets were not discovered until 2010 or after. This is largely
thanks to the <em>Kepler</em> mission, which is a space-based telescope
specifically designed for finding eclipsing planets around other stars.</p>
<p>The following table summarizes some other built-in Pandas aggregations:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 44%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Aggregation</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">count()</span></code></p></td>
<td><p>Total number of items</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">first()</span></code>, <code class="docutils literal notranslate"><span class="pre">last()</span></code></p></td>
<td><p>First and last item</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="docutils literal notranslate"><span class="pre">median()</span></code></p></td>
<td><p>Mean and median</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">min()</span></code>, <code class="docutils literal notranslate"><span class="pre">max()</span></code></p></td>
<td><p>Minimum and maximum</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">std()</span></code>, <code class="docutils literal notranslate"><span class="pre">var()</span></code></p></td>
<td><p>Standard deviation and variance</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mad()</span></code></p></td>
<td><p>Mean absolute deviation</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">prod()</span></code></p></td>
<td><p>Product of all items</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">sum()</span></code></p></td>
<td><p>Sum of all items</p></td>
</tr>
</tbody>
</table>
<p>These are all methods of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects.</p>
</div>
<div class="section" id="groupby-split-apply-combine">
<h3>GroupBy: Split, Apply, Combine<a class="headerlink" href="#groupby-split-apply-combine" title="Permalink to this headline">¶</a></h3>
<p>Simple aggregations can give you a flavor of your dataset, but often we
would prefer to aggregate conditionally on some label or index: this is
implemented in the so-called <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation. The name “group by”
comes from a command in the SQL database language, but it is perhaps
more illuminative to think of it in the terms first coined by Hadley
Wickham of Rstats fame: <em>split, apply, combine</em>.</p>
<div class="section" id="split-apply-combine">
<h4>Split, apply, combine<a class="headerlink" href="#split-apply-combine" title="Permalink to this headline">¶</a></h4>
<p>A canonical example of this split-apply-combine operation, where the
“apply” is a summation aggregation, is illustrated in this figure:</p>
<img alt="_images/03.08-split-apply-combine.png" src="_images/03.08-split-apply-combine.png" />
<p>This makes clear what the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> accomplishes:</p>
<ul class="simple">
<li><p>The <em>split</em> step involves breaking up and grouping a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>
depending on the value of the specified key.</p></li>
<li><p>The <em>apply</em> step involves computing some function, usually an
aggregate, transformation, or filtering, within the individual
groups.</p></li>
<li><p>The <em>combine</em> step merges the results of these operations into an
output array.</p></li>
</ul>
<p>While this could certainly be done manually using some combination of
the masking, aggregation, and merging commands covered earlier, an
important realization is that <em>the intermediate splits do not need to be
explicitly instantiated</em>. Rather, the <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> can (often) do this in
a single pass over the data, updating the sum, mean, count, min, or
other aggregate for each group along the way. The power of the
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> is that it abstracts away these steps: the user need not
think about <em>how</em> the computation is done under the hood, but rather
thinks about the <em>operation as a whole</em>.</p>
<p>As a concrete example, let’s take a look at using Pandas for the
computation shown in this diagram:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)},</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div><p>The most basic split-apply-combine operation can be computed with the
<code class="docutils literal notranslate"><span class="pre">groupby()</span></code> method of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, passing the name of the
desired key column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">DataFrameGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f864d926128</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Notice that what is returned is not a set of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, but a
<code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object. This object is where the magic is: you can
think of it as a special view of the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, which is poised to
dig into the groups but does no actual computation until the aggregation
is applied. This <em>lazy evaluation</em> approach means that common aggregates
can be implemented very efficiently in a way that is almost transparent
to the user.</p>
<p>To produce a result, we can apply an aggregate to this
<code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object, which will perform the appropriate
apply/combine steps to produce the desired result:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>5</td>
    </tr>
    <tr>
      <th>C</th>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div><p>The <code class="docutils literal notranslate"><span class="pre">sum()</span></code> method is just one possibility here; you can apply
virtually any common Pandas or NumPy aggregation function, as well as
virtually any valid <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> operation.</p>
</div>
<div class="section" id="the-groupby-object">
<h4>The GroupBy object<a class="headerlink" href="#the-groupby-object" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object is a very flexible abstraction. In many ways, you
can simply treat it as if it’s a collection of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s, and it
does the difficult things under the hood. Let’s see some examples using
the Planets data.</p>
<p>Perhaps the most important operations made available by a <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code>
are <em>aggregate</em>, <em>filter</em>, <em>transform</em>, and <em>apply</em> but before that
let’s introduce some of the other functionality that can be used with
the basic <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> operation.</p>
<div class="section" id="column-indexing">
<h5>Column indexing<a class="headerlink" href="#column-indexing" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object supports column indexing in the same way as the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and returns a modified <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">DataFrameGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f864d921470</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)[</span><span class="s1">&#39;orbital_period&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">groupby</span><span class="o">.</span><span class="n">generic</span><span class="o">.</span><span class="n">SeriesGroupBy</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f864d921898</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Here we’ve selected a particular <code class="docutils literal notranslate"><span class="pre">Series</span></code> group from the original
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> group by reference to its column name. As with the
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object, no computation is done until we call some aggregate
on the object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)[</span><span class="s1">&#39;orbital_period&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">method</span>
<span class="n">Astrometry</span>                         <span class="mf">631.180000</span>
<span class="n">Eclipse</span> <span class="n">Timing</span> <span class="n">Variations</span>         <span class="mf">4343.500000</span>
<span class="n">Imaging</span>                          <span class="mf">27500.000000</span>
<span class="n">Microlensing</span>                      <span class="mf">3300.000000</span>
<span class="n">Orbital</span> <span class="n">Brightness</span> <span class="n">Modulation</span>        <span class="mf">0.342887</span>
<span class="n">Pulsar</span> <span class="n">Timing</span>                       <span class="mf">66.541900</span>
<span class="n">Pulsation</span> <span class="n">Timing</span> <span class="n">Variations</span>       <span class="mf">1170.000000</span>
<span class="n">Radial</span> <span class="n">Velocity</span>                    <span class="mf">360.200000</span>
<span class="n">Transit</span>                              <span class="mf">5.714932</span>
<span class="n">Transit</span> <span class="n">Timing</span> <span class="n">Variations</span>           <span class="mf">57.011000</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">orbital_period</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
</div>
<div class="section" id="iteration-over-groups">
<h5>Iteration over groups<a class="headerlink" href="#iteration-over-groups" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object supports direct iteration over the groups,
returning each group as a <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">group</span><span class="p">)</span> <span class="ow">in</span> <span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{0:30s}</span><span class="s2"> shape=</span><span class="si">{1}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">group</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Astrometry</span>                     <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Eclipse</span> <span class="n">Timing</span> <span class="n">Variations</span>      <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Imaging</span>                        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Microlensing</span>                   <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Orbital</span> <span class="n">Brightness</span> <span class="n">Modulation</span>  <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Pulsar</span> <span class="n">Timing</span>                  <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Pulsation</span> <span class="n">Timing</span> <span class="n">Variations</span>    <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Radial</span> <span class="n">Velocity</span>                <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">553</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Transit</span>                        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">397</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">Transit</span> <span class="n">Timing</span> <span class="n">Variations</span>      <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dispatch-methods">
<h5>Dispatch methods<a class="headerlink" href="#dispatch-methods" title="Permalink to this headline">¶</a></h5>
<p>Through some Python class magic, any method not explicitly implemented
by the <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object will be passed through and called on the
groups, whether they are <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> or <code class="docutils literal notranslate"><span class="pre">Series</span></code> objects. For
example, you can use the <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s to
perform a set of aggregations that describe each group in the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">)[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <td>2.0</td>
      <td>2011.500000</td>
      <td>2.121320</td>
      <td>2010.0</td>
      <td>2010.75</td>
      <td>2011.5</td>
      <td>2012.25</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Eclipse Timing Variations</th>
      <td>9.0</td>
      <td>2010.000000</td>
      <td>1.414214</td>
      <td>2008.0</td>
      <td>2009.00</td>
      <td>2010.0</td>
      <td>2011.00</td>
      <td>2012.0</td>
    </tr>
    <tr>
      <th>Imaging</th>
      <td>38.0</td>
      <td>2009.131579</td>
      <td>2.781901</td>
      <td>2004.0</td>
      <td>2008.00</td>
      <td>2009.0</td>
      <td>2011.00</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Microlensing</th>
      <td>23.0</td>
      <td>2009.782609</td>
      <td>2.859697</td>
      <td>2004.0</td>
      <td>2008.00</td>
      <td>2010.0</td>
      <td>2012.00</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <td>3.0</td>
      <td>2011.666667</td>
      <td>1.154701</td>
      <td>2011.0</td>
      <td>2011.00</td>
      <td>2011.0</td>
      <td>2012.00</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Pulsar Timing</th>
      <td>5.0</td>
      <td>1998.400000</td>
      <td>8.384510</td>
      <td>1992.0</td>
      <td>1992.00</td>
      <td>1994.0</td>
      <td>2003.00</td>
      <td>2011.0</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <td>1.0</td>
      <td>2007.000000</td>
      <td>NaN</td>
      <td>2007.0</td>
      <td>2007.00</td>
      <td>2007.0</td>
      <td>2007.00</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>Radial Velocity</th>
      <td>553.0</td>
      <td>2007.518987</td>
      <td>4.249052</td>
      <td>1989.0</td>
      <td>2005.00</td>
      <td>2009.0</td>
      <td>2011.00</td>
      <td>2014.0</td>
    </tr>
    <tr>
      <th>Transit</th>
      <td>397.0</td>
      <td>2011.236776</td>
      <td>2.077867</td>
      <td>2002.0</td>
      <td>2010.00</td>
      <td>2012.0</td>
      <td>2013.00</td>
      <td>2014.0</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <td>4.0</td>
      <td>2012.500000</td>
      <td>1.290994</td>
      <td>2011.0</td>
      <td>2011.75</td>
      <td>2012.5</td>
      <td>2013.25</td>
      <td>2014.0</td>
    </tr>
  </tbody>
</table>
</div><p>Looking at this table helps us to better understand the data: for
example, the vast majority of planets have been discovered by the Radial
Velocity and Transit methods, though the latter only became common (due
to new, more accurate telescopes) in the last decade. The newest methods
seem to be Transit Timing Variation and Orbital Brightness Modulation,
which were not used to discover a new planet until 2011.</p>
<p>This is just one example of the utility of dispatch methods. Notice that
they are applied <em>to each individual group</em>, and the results are then
combined within <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> and returned. Again, any valid
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>/<code class="docutils literal notranslate"><span class="pre">Series</span></code> method can be used on the corresponding
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> object, which allows for some very flexible and powerful
operations!</p>
</div>
</div>
<div class="section" id="aggregate-filter-transform-apply">
<h4>Aggregate, filter, transform, apply<a class="headerlink" href="#aggregate-filter-transform-apply" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> objects have <code class="docutils literal notranslate"><span class="pre">aggregate()</span></code>, <code class="docutils literal notranslate"><span class="pre">filter()</span></code>, <code class="docutils literal notranslate"><span class="pre">transform()</span></code>,
and <code class="docutils literal notranslate"><span class="pre">apply()</span></code> methods that efficiently implement a variety of useful
operations before combining the grouped data.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>
                   <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">rng</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">)},</span>
                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;key&#39;</span><span class="p">,</span> <span class="s1">&#39;data1&#39;</span><span class="p">,</span> <span class="s1">&#39;data2&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div><div class="section" id="aggregation">
<h5>Aggregation<a class="headerlink" href="#aggregation" title="Permalink to this headline">¶</a></h5>
<p>We’re now familiar with <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> aggregations with <code class="docutils literal notranslate"><span class="pre">sum()</span></code>,
<code class="docutils literal notranslate"><span class="pre">median()</span></code>, and the like, but the <code class="docutils literal notranslate"><span class="pre">aggregate()</span></code> method allows for
even more flexibility. It can take a string, a function, or a list
thereof, and compute all the aggregates at once.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">aggregate</span><span class="p">([</span><span class="nb">min</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">,</span> <span class="nb">max</span><span class="p">])</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">data1</th>
      <th colspan="3" halign="left">data2</th>
    </tr>
    <tr>
      <th></th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
      <th>min</th>
      <th>median</th>
      <th>max</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>1.5</td>
      <td>3</td>
      <td>3</td>
      <td>4.0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>2.5</td>
      <td>4</td>
      <td>0</td>
      <td>3.5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>3.5</td>
      <td>5</td>
      <td>3</td>
      <td>6.0</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="filtering">
<h5>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">¶</a></h5>
<p>A filtering operation allows you to drop data based on the group
properties. For example, we might want to keep all groups in which the
standard deviation is larger than some critical value:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">filter_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">4</span>

<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s2">&quot;df.groupby(&#39;key&#39;).std()&quot;</span><span class="p">,</span> <span class="s2">&quot;df.groupby(&#39;key&#39;).filter(filter_func)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df.groupby('key').std()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>2.12132</td>
      <td>1.414214</td>
    </tr>
    <tr>
      <th>B</th>
      <td>2.12132</td>
      <td>4.949747</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2.12132</td>
      <td>4.242641</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df.groupby('key').filter(filter_func)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="transformation">
<h5>Transformation<a class="headerlink" href="#transformation" title="Permalink to this headline">¶</a></h5>
<p>While aggregation must return a reduced version of the data,
transformation can return some transformed version of the full data to
recombine. For such a transformation, the output is the same shape as
the input.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.5</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.5</td>
      <td>-3.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.5</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.5</td>
      <td>-1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.5</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="the-apply-method">
<h5>The apply() method<a class="headerlink" href="#the-apply-method" title="Permalink to this headline">¶</a></h5>
<p>The <code class="docutils literal notranslate"><span class="pre">apply()</span></code> method lets you apply an arbitrary function to the group
results. The function should take a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and return either a
Pandas object (e.g., <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, <code class="docutils literal notranslate"><span class="pre">Series</span></code>) or a scalar; the combine
operation will be tailored to the type of output returned.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">norm_by_data2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># x is a DataFrame of group values</span>
    <span class="n">x</span><span class="p">[</span><span class="s1">&#39;data1&#39;</span><span class="p">]</span> <span class="o">/=</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;data2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s2">&quot;df.groupby(&#39;key&#39;).apply(norm_by_data2)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df.groupby('key').apply(norm_by_data2)</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0.000000</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>0.142857</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>0.166667</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>0.375000</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>0.571429</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>0.416667</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
</div>
<div class="section" id="specifying-the-split-key">
<h4>Specifying the split key<a class="headerlink" href="#specifying-the-split-key" title="Permalink to this headline">¶</a></h4>
<p>In the simple examples presented before, we split the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> on a
single column name. This is just one of many options by which the groups
can be defined, and we’ll go through some other options for group
specification here.</p>
<div class="section" id="a-list-array-series-or-index-providing-the-grouping-keys">
<h5>A list, array, series, or index providing the grouping keys<a class="headerlink" href="#a-list-array-series-or-index-providing-the-grouping-keys" title="Permalink to this headline">¶</a></h5>
<p>The key can be any series or list with a length matching that of the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s1">&#39;df.groupby(L).sum()&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df.groupby(L).sum()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>17</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>7</td>
    </tr>
  </tbody>
</table>
</div>
    </div><p>Of course, this means there’s another, more verbose way of accomplishing
the <code class="docutils literal notranslate"><span class="pre">df.groupby('key')</span></code> from before:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df&#39;</span><span class="p">,</span> <span class="s2">&quot;df.groupby(df[&#39;key&#39;]).sum()&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>key</th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B</td>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>C</td>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df.groupby(df['key']).sum()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>3</td>
      <td>8</td>
    </tr>
    <tr>
      <th>B</th>
      <td>5</td>
      <td>7</td>
    </tr>
    <tr>
      <th>C</th>
      <td>7</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="a-dictionary-or-series-mapping-index-to-group">
<h5>A dictionary or series mapping index to group<a class="headerlink" href="#a-dictionary-or-series-mapping-index-to-group" title="Permalink to this headline">¶</a></h5>
<p>Another method is to provide a dictionary that maps index values to the
group keys:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;key&#39;</span><span class="p">)</span>
<span class="n">mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="s1">&#39;vowel&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="s1">&#39;consonant&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="s1">&#39;consonant&#39;</span><span class="p">}</span>
<span class="n">display</span><span class="p">(</span><span class="s1">&#39;df2&#39;</span><span class="p">,</span> <span class="s1">&#39;df2.groupby(mapping).sum()&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>A</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>C</th>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2.groupby(mapping).sum()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>consonant</th>
      <td>12</td>
      <td>19</td>
    </tr>
    <tr>
      <th>vowel</th>
      <td>3</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="any-python-function">
<h5>Any Python function<a class="headerlink" href="#any-python-function" title="Permalink to this headline">¶</a></h5>
<p>Similar to mapping, you can pass any Python function that will input the
index value and output the group:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="s1">&#39;df2&#39;</span><span class="p">,</span> <span class="s1">&#39;df2.groupby(str.lower).mean()&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
    <tr>
      <th>key</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>B</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>C</th>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>A</th>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>C</th>
      <td>5</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
</div>
    </div>
<div style="float: left; padding: 10px;">
    <p style='font-family:"Courier New", Courier, monospace'>df2.groupby(str.lower).mean()</p><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>c</th>
      <td>3.5</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div>
    </div></div>
<div class="section" id="a-list-of-valid-keys">
<h5>A list of valid keys<a class="headerlink" href="#a-list-of-valid-keys" title="Permalink to this headline">¶</a></h5>
<p>Further, any of the preceding key choices can be combined to group on a
multi-index:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">mapping</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>data1</th>
      <th>data2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <th>vowel</th>
      <td>1.5</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>b</th>
      <th>consonant</th>
      <td>2.5</td>
      <td>3.5</td>
    </tr>
    <tr>
      <th>c</th>
      <th>consonant</th>
      <td>3.5</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="section" id="grouping-example">
<h4>Grouping example<a class="headerlink" href="#grouping-example" title="Permalink to this headline">¶</a></h4>
<p>As an example of this, in a couple lines of Python code we can put all
these together and count discovered planets by method and by decade:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decade</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">planets</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">decade</span> <span class="o">=</span> <span class="n">decade</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;s&#39;</span>
<span class="n">decade</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;decade&#39;</span>
<span class="n">planets</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="n">decade</span><span class="p">])[</span><span class="s1">&#39;number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>decade</th>
      <th>1980s</th>
      <th>1990s</th>
      <th>2000s</th>
      <th>2010s</th>
    </tr>
    <tr>
      <th>method</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Astrometry</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>Eclipse Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>Imaging</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>29.0</td>
      <td>21.0</td>
    </tr>
    <tr>
      <th>Microlensing</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>12.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>Orbital Brightness Modulation</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>Pulsar Timing</th>
      <td>0.0</td>
      <td>9.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Pulsation Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Radial Velocity</th>
      <td>1.0</td>
      <td>52.0</td>
      <td>475.0</td>
      <td>424.0</td>
    </tr>
    <tr>
      <th>Transit</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>64.0</td>
      <td>712.0</td>
    </tr>
    <tr>
      <th>Transit Timing Variations</th>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>9.0</td>
    </tr>
  </tbody>
</table>
</div><p>This shows the power of combining many of the operations we’ve discussed
up to this point when looking at realistic datasets. We immediately gain
a coarse understanding of when and how planets have been discovered over
the past several decades!</p>
</div>
</div>
</div>
<div class="section" id="pivot-tables">
<h2>Pivot Tables<a class="headerlink" href="#pivot-tables" title="Permalink to this headline">¶</a></h2>
<p>We have seen how the <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> abstraction lets us explore
relationships within a dataset. A <em>pivot table</em> is a similar operation
that is commonly seen in spreadsheets and other programs that operate on
tabular data: - The pivot table takes simple column-wise data as input,
and groups the entries into a two-dimensional table that provides a
multidimensional summarization of the data. - The difference between
pivot tables and <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> can sometimes cause confusion; it helps me
to think of pivot tables as essentially a <em>multidimensional</em> version of
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> aggregation. - That is, you split-apply-combine, but both
the split and the combine happen across not a one-dimensional index, but
across a two-dimensional grid.</p>
<div class="section" id="motivating-pivot-tables">
<h3>Motivating Pivot Tables<a class="headerlink" href="#motivating-pivot-tables" title="Permalink to this headline">¶</a></h3>
<p>We’ll use the database of passengers on the <em>Titanic</em>, available through
the Seaborn library:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">titanic</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;titanic&#39;</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
<div class="section" id="pivot-tables-by-hand">
<h3>Pivot Tables by Hand<a class="headerlink" href="#pivot-tables-by-hand" title="Permalink to this headline">¶</a></h3>
<p>To start learning more about this data, we might begin by grouping
according to gender, survival status, or some combination thereof. If
you have read the previous section, you might be tempted to apply a
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> operation–for example, let’s look at survival rate by
gender:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)[[</span><span class="s1">&#39;survived&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.188908</td>
    </tr>
  </tbody>
</table>
</div><p>This immediately gives us some insight: overall, three of every four
females on board survived, while only one in five males survived.</p>
<p>This is useful, but we might like to go one step deeper and look at
survival by both sex and, say, class. Using the vocabulary of
<code class="docutils literal notranslate"><span class="pre">GroupBy</span></code>, we might proceed using something like this: we <em>group by</em>
class and gender, <em>select</em> survival, <em>apply</em> a mean aggregate, <em>combine</em>
the resulting groups, and then <em>unstack</em> the hierarchical index to
reveal the hidden multidimensionality. In code:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])[</span><span class="s1">&#39;survived&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div><p>This gives us a better idea of how both gender and class affected
survival, but the code is starting to look a bit garbled. While each
step of this pipeline makes sense in light of the tools we’ve previously
discussed, the long string of code is not particularly easy to read or
use. This two-dimensional <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code> is common enough that Pandas
includes a convenience routine, <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code>, which succinctly
handles this type of multi-dimensional aggregation.</p>
</div>
<div class="section" id="pivot-table-syntax">
<h3>Pivot Table Syntax<a class="headerlink" href="#pivot-table-syntax" title="Permalink to this headline">¶</a></h3>
<p>Here is the equivalent to the preceding operation using the
<code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> method of <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
    </tr>
  </tbody>
</table>
</div><p>This is eminently more readable than the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> approach, and
produces the same result. As you might expect of an early 20th-century
transatlantic cruise, the survival gradient favors both women and higher
classes. First-class women survived with near certainty (hi, Rose!),
while only one in ten third-class men survived (sorry, Jack!).</p>
<div class="section" id="multi-level-pivot-tables">
<h4>Multi-level pivot tables<a class="headerlink" href="#multi-level-pivot-tables" title="Permalink to this headline">¶</a></h4>
<p>Just as in the <code class="docutils literal notranslate"><span class="pre">GroupBy</span></code>, the grouping in pivot tables can be
specified with multiple levels, and via a number of options. For
example, we might be interested in looking at age as a third dimension.
We’ll bin the age using the <code class="docutils literal notranslate"><span class="pre">pd.cut</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">age</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">cut</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">],</span> <span class="s1">&#39;class&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th>age</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">female</th>
      <th>(0, 18]</th>
      <td>0.909091</td>
      <td>1.000000</td>
      <td>0.511628</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.972973</td>
      <td>0.900000</td>
      <td>0.423729</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">male</th>
      <th>(0, 18]</th>
      <td>0.800000</td>
      <td>0.600000</td>
      <td>0.215686</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.375000</td>
      <td>0.071429</td>
      <td>0.133663</td>
    </tr>
  </tbody>
</table>
</div><p>We can apply the same strategy when working with the columns as well;
let’s add info on the fare paid using <code class="docutils literal notranslate"><span class="pre">pd.qcut</span></code> to automatically
compute quantiles:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fare</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">qcut</span><span class="p">(</span><span class="n">titanic</span><span class="p">[</span><span class="s1">&#39;fare&#39;</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">age</span><span class="p">],</span> <span class="p">[</span><span class="n">fare</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>fare</th>
      <th colspan="3" halign="left">(-0.001, 14.454]</th>
      <th colspan="3" halign="left">(14.454, 512.329]</th>
    </tr>
    <tr>
      <th></th>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th>age</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">female</th>
      <th>(0, 18]</th>
      <td>NaN</td>
      <td>1.000000</td>
      <td>0.714286</td>
      <td>0.909091</td>
      <td>1.000000</td>
      <td>0.318182</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>NaN</td>
      <td>0.880000</td>
      <td>0.444444</td>
      <td>0.972973</td>
      <td>0.914286</td>
      <td>0.391304</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">male</th>
      <th>(0, 18]</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.260870</td>
      <td>0.800000</td>
      <td>0.818182</td>
      <td>0.178571</td>
    </tr>
    <tr>
      <th>(18, 80]</th>
      <td>0.0</td>
      <td>0.098039</td>
      <td>0.125000</td>
      <td>0.391304</td>
      <td>0.030303</td>
      <td>0.192308</td>
    </tr>
  </tbody>
</table>
</div><p>The result is a four-dimensional aggregation with hierarchical indices,
shown in a grid demonstrating the relationship between the values.</p>
</div>
<div class="section" id="additional-pivot-table-options">
<h4>Additional pivot table options<a class="headerlink" href="#additional-pivot-table-options" title="Permalink to this headline">¶</a></h4>
<p>The full call signature of the <code class="docutils literal notranslate"><span class="pre">pivot_table</span></code> method of
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># call signature as of Pandas 0.18</span>
<span class="n">DataFrame</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">margins_name</span><span class="o">=</span><span class="s1">&#39;All&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ve already seen examples of the first three arguments; here we’ll
take a quick look at the remaining ones. Two of the options,
<code class="docutils literal notranslate"><span class="pre">fill_value</span></code> and <code class="docutils literal notranslate"><span class="pre">dropna</span></code>, have to do with missing data and are
fairly straightforward; we will not show examples of them here.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code> keyword controls what type of aggregation is applied,
which is a mean by default. As in the GroupBy, the aggregation
specification can be a string representing one of several common choices
(e.g., <code class="docutils literal notranslate"><span class="pre">'sum'</span></code>, <code class="docutils literal notranslate"><span class="pre">'mean'</span></code>, <code class="docutils literal notranslate"><span class="pre">'count'</span></code>, <code class="docutils literal notranslate"><span class="pre">'min'</span></code>, <code class="docutils literal notranslate"><span class="pre">'max'</span></code>, etc.)
or a function that implements an aggregation (e.g., <code class="docutils literal notranslate"><span class="pre">np.sum()</span></code>,
<code class="docutils literal notranslate"><span class="pre">min()</span></code>, <code class="docutils literal notranslate"><span class="pre">sum()</span></code>, etc.).</p>
<p>Additionally, it can be specified as a dictionary mapping a column to
any of the above desired options:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span>
                    <span class="n">aggfunc</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;survived&#39;</span><span class="p">:</span><span class="nb">sum</span><span class="p">,</span> <span class="s1">&#39;fare&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">})</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">fare</th>
      <th colspan="3" halign="left">survived</th>
    </tr>
    <tr>
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>106.125798</td>
      <td>21.970121</td>
      <td>16.118810</td>
      <td>91</td>
      <td>70</td>
      <td>72</td>
    </tr>
    <tr>
      <th>male</th>
      <td>67.226127</td>
      <td>19.741782</td>
      <td>12.661633</td>
      <td>45</td>
      <td>17</td>
      <td>47</td>
    </tr>
  </tbody>
</table>
</div><p>Notice also here that we’ve omitted the <code class="docutils literal notranslate"><span class="pre">values</span></code> keyword; when
specifying a mapping for <code class="docutils literal notranslate"><span class="pre">aggfunc</span></code>, this is determined automatically.</p>
<p>At times it’s useful to compute totals along each grouping. This can be
done via the <code class="docutils literal notranslate"><span class="pre">margins</span></code> keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">titanic</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;survived&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;sex&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>class</th>
      <th>First</th>
      <th>Second</th>
      <th>Third</th>
      <th>All</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>female</th>
      <td>0.968085</td>
      <td>0.921053</td>
      <td>0.500000</td>
      <td>0.742038</td>
    </tr>
    <tr>
      <th>male</th>
      <td>0.368852</td>
      <td>0.157407</td>
      <td>0.135447</td>
      <td>0.188908</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.629630</td>
      <td>0.472826</td>
      <td>0.242363</td>
      <td>0.383838</td>
    </tr>
  </tbody>
</table>
</div><p>Here this automatically gives us information about the class-agnostic
survival rate by gender, the gender-agnostic survival rate by class, and
the overall survival rate of 38%. The margin label can be specified with
the <code class="docutils literal notranslate"><span class="pre">margins_name</span></code> keyword, which defaults to <code class="docutils literal notranslate"><span class="pre">&quot;All&quot;</span></code>.</p>
</div>
</div>
<div class="section" id="example-birthrate-data">
<h3>Example: Birthrate Data<a class="headerlink" href="#example-birthrate-data" title="Permalink to this headline">¶</a></h3>
<p>As a more interesting example, let’s take a look at the freely available
data on births in the United States, provided by the Centers for Disease
Control (CDC). This data can be found at
<a class="reference external" href="https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv">https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>curl -O https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">258</span><span class="n">k</span>  <span class="mi">100</span>  <span class="mi">258</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">258</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>  <span class="mi">258</span><span class="n">k</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">births</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/births.csv&#39;</span><span class="p">)</span>
<span class="n">births</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>15547.000000</td>
      <td>15547.000000</td>
      <td>15067.000000</td>
      <td>15547.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1979.037435</td>
      <td>6.515919</td>
      <td>17.769894</td>
      <td>9762.293561</td>
    </tr>
    <tr>
      <th>std</th>
      <td>6.728340</td>
      <td>3.449632</td>
      <td>15.284034</td>
      <td>28552.465810</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1969.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1974.000000</td>
      <td>4.000000</td>
      <td>8.000000</td>
      <td>4358.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1979.000000</td>
      <td>7.000000</td>
      <td>16.000000</td>
      <td>4814.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1984.000000</td>
      <td>10.000000</td>
      <td>24.000000</td>
      <td>5289.500000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2008.000000</td>
      <td>12.000000</td>
      <td>99.000000</td>
      <td>199622.000000</td>
    </tr>
  </tbody>
</table>
</div><p>Taking a look at the data, we see that it’s relatively simple–it
contains the number of births grouped by date and gender:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">births</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>gender</th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1969</td>
      <td>1</td>
      <td>1.0</td>
      <td>F</td>
      <td>4046</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1969</td>
      <td>1</td>
      <td>1.0</td>
      <td>M</td>
      <td>4440</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1969</td>
      <td>1</td>
      <td>2.0</td>
      <td>F</td>
      <td>4454</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1969</td>
      <td>1</td>
      <td>2.0</td>
      <td>M</td>
      <td>4548</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1969</td>
      <td>1</td>
      <td>3.0</td>
      <td>F</td>
      <td>4548</td>
    </tr>
  </tbody>
</table>
</div><p>We can start to understand this data a bit more by using a pivot table.
Let’s add a decade column, and take a look at male and female births as
a function of decade:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">births</span><span class="p">[</span><span class="s1">&#39;decade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">births</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">births</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;births&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;decade&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>gender</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>decade</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1960</th>
      <td>1753634</td>
      <td>1846572</td>
    </tr>
    <tr>
      <th>1970</th>
      <td>16263075</td>
      <td>17121550</td>
    </tr>
    <tr>
      <th>1980</th>
      <td>18310351</td>
      <td>19243452</td>
    </tr>
    <tr>
      <th>1990</th>
      <td>19479454</td>
      <td>20420553</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>18229309</td>
      <td>19106428</td>
    </tr>
  </tbody>
</table>
</div><p>We immediately see that male births outnumber female births in every
decade. To see this trend a bit more clearly, we can use the built-in
plotting tools in Pandas to visualize the total number of births by
year:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>  <span class="c1"># use Seaborn styles</span>
<span class="n">births</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;births&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;total births per year&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_451_0.png" src="_images/pandas_451_0.png" />
<p>With a simple pivot table and <code class="docutils literal notranslate"><span class="pre">plot()</span></code> method, we can immediately see
the annual trend in births by gender. By eye, it appears that over the
past 50 years male births have outnumbered female births by around 5%.</p>
<div class="section" id="further-data-exploration">
<h4>Further data exploration<a class="headerlink" href="#further-data-exploration" title="Permalink to this headline">¶</a></h4>
<p>Though this doesn’t necessarily relate to the pivot table, there are a
few more interesting features we can pull out of this dataset using the
Pandas tools covered up to this point. We must start by cleaning the
data a bit, removing outliers caused by mistyped dates (e.g., June 31st)
or missing values (e.g., June 99th). One easy way to remove these all at
once is to cut outliers; we’ll do this via a robust sigma-clipping
operation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">quartiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">births</span><span class="p">[</span><span class="s1">&#39;births&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">quartiles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.74</span> <span class="o">*</span> <span class="p">(</span><span class="n">quartiles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">quartiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>This final line is a robust estimate of the sample mean, where the 0.74
comes from the interquartile range of a Gaussian distribution.</p>
<p>With this we can use the <code class="docutils literal notranslate"><span class="pre">query()</span></code> method to filter-out rows with
births outside these values:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">births</span> <span class="o">=</span> <span class="n">births</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(births &gt; @mu - 5 * @sig) &amp; (births &lt; @mu + 5 * @sig)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next we set the <code class="docutils literal notranslate"><span class="pre">day</span></code> column to integers; previously it had been a
string because some columns in the dataset contained the value
<code class="docutils literal notranslate"><span class="pre">'null'</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set &#39;day&#39; column to integer; it originally was a string due to nulls</span>
<span class="n">births</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">births</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we can combine the day, month, and year to create a Date index.
This allows us to quickly compute the weekday corresponding to each row:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create a datetime index from the year, month, day</span>
<span class="n">births</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="n">births</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span>
                              <span class="mi">100</span> <span class="o">*</span> <span class="n">births</span><span class="o">.</span><span class="n">month</span> <span class="o">+</span>
                              <span class="n">births</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">births</span><span class="p">[</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">births</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="n">births</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;births&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">&#39;dayofweek&#39;</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;decade&#39;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="s1">&#39;Tues&#39;</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">,</span> <span class="s1">&#39;Thurs&#39;</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mean births by day&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_462_0.png" src="_images/pandas_462_0.png" />
<p>Apparently births are slightly less common on weekends than on weekdays!
Note that the 1990s and 2000s are missing because the CDC data contains
only the month of birth starting in 1989.</p>
<p>Another intersting view is to plot the mean number of births by the day
of the <em>year</em>. Let’s first group the data by month and day separately:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">births_by_date</span> <span class="o">=</span> <span class="n">births</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;births&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">births</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">births</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span><span class="p">])</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">1</th>
      <th>1</th>
      <td>4009.225</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4247.400</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4500.900</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4571.350</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4603.625</td>
    </tr>
  </tbody>
</table>
</div><p>The result is a multi-index over months and days.</p>
<p>To make this easily plottable, let’s turn these months and days into a
date by associating them with a dummy year variable (making sure to
choose a leap year so February 29th is correctly handled!)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span> <span class="ow">in</span> <span class="n">births_by_date</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-01-01</th>
      <td>4009.225</td>
    </tr>
    <tr>
      <th>2012-01-02</th>
      <td>4247.400</td>
    </tr>
    <tr>
      <th>2012-01-03</th>
      <td>4500.900</td>
    </tr>
    <tr>
      <th>2012-01-04</th>
      <td>4571.350</td>
    </tr>
    <tr>
      <th>2012-01-05</th>
      <td>4603.625</td>
    </tr>
  </tbody>
</table>
</div><p>Focusing on the month and day only, we now have a time series reflecting
the average number of births by date of the year. From this, we can use
the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method to plot the data. It reveals some interesting
trends:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_470_0.png" src="_images/pandas_470_0.png" />
<p>In particular, the striking feature of this graph is the dip in
birthrate on US holidays (e.g., Independence Day, Labor Day,
Thanksgiving, Christmas, New Year’s Day) although this likely reflects
trends in scheduled/induced births rather than some deep psychosomatic
effect on natural births.</p>
<p>Looking at this short example, you can see that many of the Python and
Pandas tools we’ve seen to this point can be combined and used to gain
insight from a variety of datasets.</p>
</div>
</div>
</div>
<div class="section" id="working-with-time-series">
<h2>Working with Time Series<a class="headerlink" href="#working-with-time-series" title="Permalink to this headline">¶</a></h2>
<p>Pandas was developed in the context of financial modeling, so as you
might expect, it contains a fairly extensive set of tools for working
with dates, times, and time-indexed data. Date and time data comes in a
few flavors:</p>
<ul class="simple">
<li><p><em>Time stamps</em> reference particular moments in time (e.g., July 4th,
2015 at 7:00am).</p></li>
<li><p><em>Time intervals</em> and <em>periods</em> reference a length of time between a
particular beginning and end point; for example, the year 2015.
Periods usually reference a special case of time intervals in which
each interval is of uniform length and does not overlap (e.g., 24
hour-long periods comprising days).</p></li>
<li><p><em>Time deltas</em> or <em>durations</em> reference an exact length of time (e.g.,
a duration of 22.56 seconds).</p></li>
</ul>
<div class="section" id="dates-and-times-in-python">
<h3>Dates and Times in Python<a class="headerlink" href="#dates-and-times-in-python" title="Permalink to this headline">¶</a></h3>
<p>The Python world has a number of available representations of dates,
times, deltas, and timespans. While the time series tools provided by
Pandas tend to be the most useful for data science applications, it is
helpful to see their relationship to other packages used in Python.</p>
<div class="section" id="native-python-dates-and-times-datetime-and-dateutil">
<h4>Native Python dates and times: <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code><a class="headerlink" href="#native-python-dates-and-times-datetime-and-dateutil" title="Permalink to this headline">¶</a></h4>
<p>Python’s basic objects for working with dates and times reside in the
built-in <code class="docutils literal notranslate"><span class="pre">datetime</span></code> module. Along with the third-party <code class="docutils literal notranslate"><span class="pre">dateutil</span></code>
module, you can use it to quickly perform a host of useful
functionalities on dates and times:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">datetime</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">2015</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Or, using the <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> module, you can parse dates from a variety of
string formats:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dateutil</span> <span class="kn">import</span> <span class="n">parser</span>
<span class="n">date</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s2">&quot;4th of July, 2015&quot;</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Once you have a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> object, you can do things like printing the
day of the week:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Saturday&#39;</span>
</pre></div>
</div>
<p>A related package to be aware of is
<code class="docutils literal notranslate"><span class="pre">`pytz</span></code> &lt;<a class="reference external" href="http://pytz.sourceforge.net/">http://pytz.sourceforge.net/</a>&gt;`__, which contains tools for
working with the most migrane-inducing piece of time series data: time
zones.</p>
<p>The power of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code> lie in their flexibility and
easy syntax: you can use these objects and their built-in methods to
easily perform nearly any operation you might be interested in. Where
they break down is when you wish to work with large arrays of dates and
times: just as lists of Python numerical variables are suboptimal
compared to NumPy-style typed numerical arrays, lists of Python datetime
objects are suboptimal compared to typed arrays of encoded dates.</p>
</div>
<div class="section" id="typed-arrays-of-times-numpys-datetime64">
<h4>Typed arrays of times: NumPy’s <code class="docutils literal notranslate"><span class="pre">datetime64</span></code><a class="headerlink" href="#typed-arrays-of-times-numpys-datetime64" title="Permalink to this headline">¶</a></h4>
<p>The weaknesses of Python’s datetime format inspired the NumPy team to
add a set of native time series data type to NumPy. The <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>
dtype encodes dates as 64-bit integers, and thus allows arrays of dates
to be represented very compactly.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">(</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Once we have this date formatted, however, we can quickly do vectorized
operations on it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2015-07-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-11&#39;</span><span class="p">,</span>
       <span class="s1">&#39;2015-07-12&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-13&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-14&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-15&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[D]&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Because of the uniform type in NumPy <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> arrays, this type of
operation can be accomplished much more quickly than if we were working
directly with Python’s <code class="docutils literal notranslate"><span class="pre">datetime</span></code> objects, especially as arrays get
large.</p>
<p>One detail of the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code> and <code class="docutils literal notranslate"><span class="pre">timedelta64</span></code> objects is that
they are built on a <em>fundamental time unit</em>. Because the <code class="docutils literal notranslate"><span class="pre">datetime64</span></code>
object is limited to 64-bit precision, the range of encodable times is
<span class="math notranslate nohighlight">\(2^{64}\)</span> times this fundamental unit. In other words,
<code class="docutils literal notranslate"><span class="pre">datetime64</span></code> imposes a trade-off between <em>time resolution</em> and
<em>maximum time span</em>.</p>
<p>If you want a time resolution of one nanosecond, you only have enough
information to encode a range of <span class="math notranslate nohighlight">\(2^{64}\)</span> nanoseconds, or just
under 600 years:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">)</span> <span class="c1"># a day-based datetime</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04 12:00&#39;</span><span class="p">)</span> <span class="c1"># a minute-based datetime</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04T12:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04 12:59:59.50&#39;</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">)</span> <span class="c1"># a nanosecond-based datetiem</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">numpy</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="s1">&#39;2015-07-04T12:59:59.500000000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The following table lists the available format codes along with the
relative and absolute timespans that they can encode:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 19%" />
<col style="width: 34%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Meaning</p></th>
<th class="head"><p>Time span (relative)</p></th>
<th class="head"><p>Time span (absolute)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Y</span></code></p></td>
<td><p>Year</p></td>
<td><p>± 9.2e18 years</p></td>
<td><p>[9.2e18 BC, 9.2e18 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p>Month</p></td>
<td><p>± 7.6e17 years</p></td>
<td><p>[7.6e17 BC, 7.6e17 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p>Week</p></td>
<td><p>± 1.7e17 years</p></td>
<td><p>[1.7e17 BC, 1.7e17 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p>Day</p></td>
<td><p>± 2.5e16 years</p></td>
<td><p>[2.5e16 BC, 2.5e16 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">h</span></code></p></td>
<td><p>Hour</p></td>
<td><p>± 1.0e15 years</p></td>
<td><p>[1.0e15 BC, 1.0e15 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></td>
<td><p>Minute</p></td>
<td><p>± 1.7e13 years</p></td>
<td><p>[1.7e13 BC, 1.7e13 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">s</span></code></p></td>
<td><p>Second</p></td>
<td><p>± 2.9e12 years</p></td>
<td><p>[ 2.9e9 BC, 2.9e9 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ms</span></code></p></td>
<td><p>Millisecond</p></td>
<td><p>± 2.9e9 years</p></td>
<td><p>[ 2.9e6 BC, 2.9e6 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">us</span></code></p></td>
<td><p>Microsecond</p></td>
<td><p>± 2.9e6 years</p></td>
<td><p>[290301 BC, 294241 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ns</span></code></p></td>
<td><p>Nanosecond</p></td>
<td><p>± 292 years</p></td>
<td><p>[ 1678 AD, 2262 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ps</span></code></p></td>
<td><p>Picosecond</p></td>
<td><p>± 106 days</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">fs</span></code></p></td>
<td><p>Femtosecond</p></td>
<td><p>± 2.6 hours</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">as</span></code></p></td>
<td><p>Attosecond</p></td>
<td><p>± 9.2 seconds</p></td>
<td><p>[ 1969 AD, 1970 AD]</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="dates-and-times-in-pandas-best-of-both-worlds">
<h4>Dates and times in pandas: best of both worlds<a class="headerlink" href="#dates-and-times-in-pandas-best-of-both-worlds" title="Permalink to this headline">¶</a></h4>
<p>Pandas builds upon all the tools just discussed to provide a
<code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> object, which combines the ease-of-use of <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and
<code class="docutils literal notranslate"><span class="pre">dateutil</span></code> with the efficient storage and vectorized interface of
<code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>. From a group of these <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> objects,
Pandas can construct a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> that can be used to index data
in a <code class="docutils literal notranslate"><span class="pre">Series</span></code> or <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s2">&quot;4th of July, 2015&quot;</span><span class="p">)</span>
<span class="n">date</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;2015-07-04 00:00:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;Saturday&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span> <span class="c1"># do NumPy-style vectorized operations directly on this same object</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-11&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-12&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-13&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-14&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-15&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="pandas-time-series-indexing-by-time">
<h3>Pandas Time Series: Indexing by Time<a class="headerlink" href="#pandas-time-series-indexing-by-time" title="Permalink to this headline">¶</a></h3>
<p>Where the Pandas time series tools really become useful is when you
begin to <em>index data by timestamps</em>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2014-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2014-08-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-08-04&#39;</span><span class="p">])</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2014</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">0</span>
<span class="mi">2014</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">1</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">2</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<p>Now that we have this data in a <code class="docutils literal notranslate"><span class="pre">Series</span></code>, we can make use of any of
the <code class="docutils literal notranslate"><span class="pre">Series</span></code> indexing patterns passing values that can be coerced into
dates:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;2014-07-04&#39;</span><span class="p">:</span><span class="s1">&#39;2015-07-04&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2014</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">0</span>
<span class="mi">2014</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">1</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">2</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;2015&#39;</span><span class="p">]</span> <span class="c1"># additional special date-only indexing operations</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2015</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">2</span>
<span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="mi">04</span>    <span class="mi">3</span>
<span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></div>
</div>
</div>
<div class="section" id="pandas-time-series-data-structures">
<h3>Pandas Time Series Data Structures<a class="headerlink" href="#pandas-time-series-data-structures" title="Permalink to this headline">¶</a></h3>
<p>The fundamental Pandas data structures for working with time series
data:</p>
<ul class="simple">
<li><p>For <em>time stamps</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code> type. As
mentioned before, it is essentially a replacement for Python’s native
<code class="docutils literal notranslate"><span class="pre">datetime</span></code>, but is based on the more efficient <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>
data type. The associated Index structure is <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>.</p></li>
<li><p>For <em>time Periods</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Period</span></code> type. This encodes
a fixed-frequency interval based on <code class="docutils literal notranslate"><span class="pre">numpy.datetime64</span></code>. The
associated index structure is <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code>.</p></li>
<li><p>For <em>time deltas</em> or <em>durations</em>, Pandas provides the <code class="docutils literal notranslate"><span class="pre">Timedelta</span></code>
type. <code class="docutils literal notranslate"><span class="pre">Timedelta</span></code> is a more efficient replacement for Python’s
native <code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code> type, and is based on
<code class="docutils literal notranslate"><span class="pre">numpy.timedelta64</span></code>. The associated index structure is
<code class="docutils literal notranslate"><span class="pre">TimedeltaIndex</span></code>.</p></li>
</ul>
<p>The most fundamental of these date/time objects are the <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code>
and <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> objects. While these class objects can be invoked
directly, it is more common to use the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code> function,
which can parse a wide variety of formats. Passing a single date to
<code class="docutils literal notranslate"><span class="pre">pd.to_datetime()</span></code> yields a <code class="docutils literal notranslate"><span class="pre">Timestamp</span></code>; passing a series of dates
by default yields a <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">([</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;4th of July, 2015&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;2015-Jul-6&#39;</span><span class="p">,</span> <span class="s1">&#39;07-07-2015&#39;</span><span class="p">,</span> <span class="s1">&#39;20150708&#39;</span><span class="p">])</span>
<span class="n">dates</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-08&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Any <code class="docutils literal notranslate"><span class="pre">DatetimeIndex</span></code> can be converted to a <code class="docutils literal notranslate"><span class="pre">PeriodIndex</span></code> with the
<code class="docutils literal notranslate"><span class="pre">to_period()</span></code> function with the addition of a frequency code; here
we’ll use <code class="docutils literal notranslate"><span class="pre">'D'</span></code> to indicate daily frequency:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span><span class="o">.</span><span class="n">to_period</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PeriodIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span>
             <span class="s1">&#39;2015-07-08&#39;</span><span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;period[D]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates</span> <span class="o">-</span> <span class="n">dates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># A ``TimedeltaIndex`` is createdwhen subtracting</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TimedeltaIndex</span><span class="p">([</span><span class="s1">&#39;0 days&#39;</span><span class="p">,</span> <span class="s1">&#39;1 days&#39;</span><span class="p">,</span> <span class="s1">&#39;3 days&#39;</span><span class="p">,</span> <span class="s1">&#39;4 days&#39;</span><span class="p">,</span> <span class="s1">&#39;5 days&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="regular-sequences-pd-date-range">
<h4>Regular sequences: <code class="docutils literal notranslate"><span class="pre">pd.date_range()</span></code><a class="headerlink" href="#regular-sequences-pd-date-range" title="Permalink to this headline">¶</a></h4>
<p>To make the creation of regular date sequences more convenient, Pandas
offers a few functions for this purpose: <code class="docutils literal notranslate"><span class="pre">pd.date_range()</span></code> for
timestamps, <code class="docutils literal notranslate"><span class="pre">pd.period_range()</span></code> for periods, and
<code class="docutils literal notranslate"><span class="pre">pd.timedelta_range()</span></code> for time deltas:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">)</span> <span class="c1"># by default, the frequency is one day</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-10&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-03 00:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-03 01:00:00&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-03 02:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-03 03:00:00&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-03 04:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-03 05:00:00&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-03 06:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-03 07:00:00&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">period_range</span><span class="p">(</span><span class="s1">&#39;2015-07&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PeriodIndex</span><span class="p">([</span><span class="s1">&#39;2015-07&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-08&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-09&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-11&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-12&#39;</span><span class="p">,</span>
             <span class="s1">&#39;2016-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2016-02&#39;</span><span class="p">],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;period[M]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">timedelta_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TimedeltaIndex</span><span class="p">([</span><span class="s1">&#39;00:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;01:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;03:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;04:00:00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;05:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;06:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;07:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;08:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;09:00:00&#39;</span><span class="p">],</span>
               <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="frequencies-and-offsets">
<h3>Frequencies and Offsets<a class="headerlink" href="#frequencies-and-offsets" title="Permalink to this headline">¶</a></h3>
<p>Fundamental to these Pandas time series tools is the concept of a
frequency or date offset. Just as we saw the <code class="docutils literal notranslate"><span class="pre">D</span></code> (day) and <code class="docutils literal notranslate"><span class="pre">H</span></code>
(hour) codes above, we can use such codes to specify any desired
frequency spacing:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 28%" />
<col style="width: 14%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Code</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">D</span></code></p></td>
<td><p>Calendar day</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">B</span></code></p></td>
<td><p>Business day</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></td>
<td><p>Weekly</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">M</span></code></p></td>
<td><p>Month end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BM</span></code></p></td>
<td><p>Business month end</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Q</span></code></p></td>
<td><p>Quarter end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BQ</span></code></p></td>
<td><p>Business quarter end</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">A</span></code></p></td>
<td><p>Year end</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BA</span></code></p></td>
<td><p>Business year end</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">H</span></code></p></td>
<td><p>Hours</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BH</span></code></p></td>
<td><p>Business hours</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p>Minutes</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></td>
<td><p>Seconds</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">L</span></code></p></td>
<td><p>Milliseonds</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">U</span></code></p></td>
<td><p>Microseconds</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></td>
<td><p>nanoseconds</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>The monthly, quarterly, and annual frequencies are all marked at the end
of the specified period. By adding an <code class="docutils literal notranslate"><span class="pre">S</span></code> suffix to any of these, they
instead will be marked at the beginning:</p>
<div class="line-block">
<div class="line">Code | Description || Code | Description |</div>
</div>
<p>|———<a href="#id10"><span class="problematic" id="id11">|————————||</span></a>———<a href="#id7"><span class="problematic" id="id8">|</span></a>————————| | <code class="docutils literal notranslate"><span class="pre">MS</span></code> | Month start ||<code class="docutils literal notranslate"><span class="pre">BMS</span></code> |
Business month start | | <code class="docutils literal notranslate"><span class="pre">QS</span></code> | Quarter start ||<code class="docutils literal notranslate"><span class="pre">BQS</span></code> |
Business quarter start | | <code class="docutils literal notranslate"><span class="pre">AS</span></code> | Year start ||<code class="docutils literal notranslate"><span class="pre">BAS</span></code> |
Business year start |</p>
<p>Additionally, you can change the month used to mark any quarterly or
annual code by adding a three-letter month code as a suffix:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Q-JAN</span></code>, <code class="docutils literal notranslate"><span class="pre">BQ-FEB</span></code>, <code class="docutils literal notranslate"><span class="pre">QS-MAR</span></code>, <code class="docutils literal notranslate"><span class="pre">BQS-APR</span></code>, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A-JAN</span></code>, <code class="docutils literal notranslate"><span class="pre">BA-FEB</span></code>, <code class="docutils literal notranslate"><span class="pre">AS-MAR</span></code>, <code class="docutils literal notranslate"><span class="pre">BAS-APR</span></code>, etc.</p></li>
</ul>
<p>In the same way, the split-point of the weekly frequency can be modified
by adding a three-letter weekday code:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">W-SUN</span></code>, <code class="docutils literal notranslate"><span class="pre">W-MON</span></code>, <code class="docutils literal notranslate"><span class="pre">W-TUE</span></code>, <code class="docutils literal notranslate"><span class="pre">W-WED</span></code>, etc.</p></li>
</ul>
<p>On top of this, codes can be combined with numbers to specify other
frequencies. For example, for a frequency of 2 hours 30 minutes, we can
combine the hour (<code class="docutils literal notranslate"><span class="pre">H</span></code>) and minute (<code class="docutils literal notranslate"><span class="pre">T</span></code>) codes as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">timedelta_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;2H30T&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TimedeltaIndex</span><span class="p">([</span><span class="s1">&#39;00:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;02:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;05:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;07:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;10:00:00&#39;</span><span class="p">,</span>
                <span class="s1">&#39;12:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;15:00:00&#39;</span><span class="p">,</span> <span class="s1">&#39;17:30:00&#39;</span><span class="p">,</span> <span class="s1">&#39;20:00:00&#39;</span><span class="p">],</span>
               <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;timedelta64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;150T&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>All of these short codes refer to specific instances of Pandas time
series offsets, which can be found in the <code class="docutils literal notranslate"><span class="pre">pd.tseries.offsets</span></code> module.
For example, we can create a business day offset directly as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas.tseries.offsets</span> <span class="kn">import</span> <span class="n">BDay</span>
<span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2015-07-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="n">BDay</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DatetimeIndex</span><span class="p">([</span><span class="s1">&#39;2015-07-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2015-07-06&#39;</span><span class="p">,</span>
               <span class="s1">&#39;2015-07-07&#39;</span><span class="p">],</span>
              <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;datetime64[ns]&#39;</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="resampling-shifting-and-windowing">
<h3>Resampling, Shifting, and Windowing<a class="headerlink" href="#resampling-shifting-and-windowing" title="Permalink to this headline">¶</a></h3>
<p>The ability to use dates and times as indices to intuitively organize
and access data is an important piece of the Pandas time series tools.
The benefits of indexed data in general (automatic alignment during
operations, intuitive data slicing and access, etc.) still apply, and
Pandas provides several additional time series-specific operations.</p>
<p>We will take a look at a few of those here, using some stock price data
as an example. Because Pandas was developed largely in a finance
context, it includes some very specific tools for financial data.</p>
<p>For example, the accompanying <code class="docutils literal notranslate"><span class="pre">pandas-datareader</span></code> package (installable
via <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pandas-datareader</span></code>), knows how to import financial
data from a number of available sources, including Yahoo finance, Google
Finance, and others.</p>
<p>Download some data (<strong>ADD A DESCRIPTION FOR IT</strong>)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas_datareader</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">goog</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">DataReader</span><span class="p">(</span><span class="s1">&#39;VIXCLS&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2004&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2016&#39;</span><span class="p">,</span> <span class="n">data_source</span><span class="o">=</span><span class="s1">&#39;fred&#39;</span><span class="p">)</span>
<span class="n">goog</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIXCLS</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2004-01-01</th>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2004-01-02</th>
      <td>18.22</td>
    </tr>
    <tr>
      <th>2004-01-05</th>
      <td>17.49</td>
    </tr>
    <tr>
      <th>2004-01-06</th>
      <td>16.73</td>
    </tr>
    <tr>
      <th>2004-01-07</th>
      <td>15.50</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">goog</span> <span class="o">=</span> <span class="n">goog</span><span class="p">[</span><span class="s1">&#39;VIXCLS&#39;</span><span class="p">]</span> <span class="c1"># for simplicity consider its sole column</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span><span class="p">;</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">goog</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/pandas_522_0.png" src="_images/pandas_522_0.png" />
<div class="section" id="resampling-and-converting-frequencies">
<h4>Resampling and converting frequencies<a class="headerlink" href="#resampling-and-converting-frequencies" title="Permalink to this headline">¶</a></h4>
<p>One common need for time series data is resampling at a higher or lower
frequency. This can be done using the <code class="docutils literal notranslate"><span class="pre">resample()</span></code> method, or the much
simpler <code class="docutils literal notranslate"><span class="pre">asfreq()</span></code> method. The primary difference between the two is
that <code class="docutils literal notranslate"><span class="pre">resample()</span></code> is fundamentally a <em>data aggregation</em>, while
<code class="docutils literal notranslate"><span class="pre">asfreq()</span></code> is fundamentally a <em>data selection</em>.</p>
<p>Let’s compare what the two return when we down-sample the data; we will
resample the data at the end of business year:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">goog</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">goog</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;BA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">goog</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;BA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="s1">&#39;resample&#39;</span><span class="p">,</span> <span class="s1">&#39;asfreq&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_525_0.png" src="_images/pandas_525_0.png" />
<p>Notice the difference: at each point, <code class="docutils literal notranslate"><span class="pre">resample</span></code> reports the <em>average
of the previous year</em>, while <code class="docutils literal notranslate"><span class="pre">asfreq</span></code> reports the <em>value at the end of
the year</em>.</p>
<p>For up-sampling, <code class="docutils literal notranslate"><span class="pre">resample()</span></code> and <code class="docutils literal notranslate"><span class="pre">asfreq()</span></code> are largely equivalent,
though resample has many more options available. In this case, the
default for both methods is to leave the up-sampled points empty, that
is, filled with NA values. Just as with the <code class="docutils literal notranslate"><span class="pre">pd.fillna()</span></code> function
discussed previously, <code class="docutils literal notranslate"><span class="pre">asfreq()</span></code> accepts a <code class="docutils literal notranslate"><span class="pre">method</span></code> argument to
specify how values are imputed.</p>
<p>We resample the business day data at a daily frequency (i.e., including
weekends):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">goog</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>

<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>

<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;-o&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;--o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;back-fill&quot;</span><span class="p">,</span> <span class="s2">&quot;forward-fill&quot;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/pandas_529_0.png" src="_images/pandas_529_0.png" />
<p>The top panel is the default: non-business days are left as NA values
and do not appear on the plot. The bottom panel shows the differences
between two strategies for filling the gaps: forward-filling and
backward-filling.</p>
</div>
<div class="section" id="time-shifts">
<h4>Time-shifts<a class="headerlink" href="#time-shifts" title="Permalink to this headline">¶</a></h4>
<p>Another common time series-specific operation is shifting of data in
time. Pandas has two closely related methods for computing this:
<code class="docutils literal notranslate"><span class="pre">shift()</span></code> and <code class="docutils literal notranslate"><span class="pre">tshift()</span></code> In short, the difference between them is
that <code class="docutils literal notranslate"><span class="pre">shift()</span></code> <em>shifts the data</em>, while <code class="docutils literal notranslate"><span class="pre">tshift()</span></code> <em>shifts the
index</em>. In both cases, the shift is specified in multiples of the
frequency.</p>
<p>Here we will both <code class="docutils literal notranslate"><span class="pre">shift()</span></code> and <code class="docutils literal notranslate"><span class="pre">tshift()</span></code> by 900 days;</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># apply a frequency to the data</span>
<span class="n">goog</span> <span class="o">=</span> <span class="n">goog</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pad&#39;</span><span class="p">)</span>

<span class="n">goog</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">goog</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">goog</span><span class="o">.</span><span class="n">tshift</span><span class="p">(</span><span class="mi">900</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># legends and annotations</span>
<span class="n">local_max</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="s1">&#39;2007-11-05&#39;</span><span class="p">)</span>
<span class="n">offset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;input&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;heavy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">local_max</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;shift(900)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;heavy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">local_max</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;tshift(900)&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;heavy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">local_max</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_532_0.png" src="_images/pandas_532_0.png" />
<p>We see here that <code class="docutils literal notranslate"><span class="pre">shift(900)</span></code> shifts the <em>data</em> by 900 days, pushing
some of it off the end of the graph (and leaving NA values at the other
end), while <code class="docutils literal notranslate"><span class="pre">tshift(900)</span></code> shifts the <em>index values</em> by 900 days.</p>
<p>A common context for this type of shift is in computing differences over
time. For example, we use shifted values to compute the one-year return
on investment for Google stock over the course of the dataset:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ROI</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">goog</span><span class="o">.</span><span class="n">tshift</span><span class="p">(</span><span class="o">-</span><span class="mi">365</span><span class="p">)</span> <span class="o">/</span> <span class="n">goog</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ROI</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;% Return on Investment&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_534_0.png" src="_images/pandas_534_0.png" />
<p>This helps us to see the overall trend in Google stock: thus far, the
most profitable times to invest in Google have been (unsurprisingly, in
retrospect) shortly after its IPO, and in the middle of the 2009
recession.</p>
</div>
<div class="section" id="rolling-windows">
<h4>Rolling windows<a class="headerlink" href="#rolling-windows" title="Permalink to this headline">¶</a></h4>
<p>Rolling statistics are a third type of time series-specific operation
implemented by Pandas. These can be accomplished via the <code class="docutils literal notranslate"><span class="pre">rolling()</span></code>
attribute of <code class="docutils literal notranslate"><span class="pre">Series</span></code> and <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> objects, which returns a view
similar to what we saw with the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> operation (see <a class="reference external" href="03.08-Aggregation-and-Grouping.ipynb">Aggregation
and Grouping</a>). This rolling
view makes available a number of aggregation operations by default.</p>
<p>For example, here is the one-year centered rolling mean and standard
deviation of the Google stock prices:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rolling</span> <span class="o">=</span> <span class="n">goog</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;input&#39;</span><span class="p">:</span> <span class="n">goog</span><span class="p">,</span>
                     <span class="s1">&#39;one-year rolling_mean&#39;</span><span class="p">:</span> <span class="n">rolling</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                     <span class="s1">&#39;one-year rolling_std&#39;</span><span class="p">:</span> <span class="n">rolling</span><span class="o">.</span><span class="n">std</span><span class="p">()})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/pandas_538_0.png" src="_images/pandas_538_0.png" />
<p>As with group-by operations, the <code class="docutils literal notranslate"><span class="pre">aggregate()</span></code> and <code class="docutils literal notranslate"><span class="pre">apply()</span></code> methods
can be used for custom rolling computations.</p>
</div>
</div>
<div class="section" id="example-visualizing-seattle-bicycle-counts">
<h3>Example: Visualizing Seattle Bicycle Counts<a class="headerlink" href="#example-visualizing-seattle-bicycle-counts" title="Permalink to this headline">¶</a></h3>
<p>As a more involved example of working with some time series data, let’s
take a look at bicycle counts on Seattle’s <a class="reference external" href="http://www.openstreetmap.org/#map=17/47.64813/-122.34965">Fremont
Bridge</a>.
This data comes from an automated bicycle counter, installed in late
2012, which has inductive sensors on the east and west sidewalks of the
bridge. The hourly bicycle counts can be downloaded from
<a class="reference external" href="http://data.seattle.gov/">http://data.seattle.gov/</a>; here is the <a class="reference external" href="https://data.seattle.gov/Transportation/Fremont-Bridge-Hourly-Bicycle-Counts-by-Month-Octo/65db-xm6k">direct link to the
dataset</a>.</p>
<p>As of summer 2016, the CSV can be downloaded as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>curl -o FremontBridge.csv https://data.seattle.gov/api/views/65db-xm6k/rows.csv?accessType<span class="o">=</span>DOWNLOAD
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span> <span class="mi">2024</span><span class="n">k</span>    <span class="mi">0</span> <span class="mi">2024</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">331</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>  <span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">06</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>  <span class="mi">462</span><span class="n">k</span>
</pre></div>
</div>
<p>Once this dataset is downloaded, we can use Pandas to read the CSV
output into a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. We will specify that we want the Date as an
index, and we want these dates to be automatically parsed:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/FremontBridge.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fremont Bridge Total</th>
      <th>Fremont Bridge East Sidewalk</th>
      <th>Fremont Bridge West Sidewalk</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2012-10-03 00:00:00</th>
      <td>13.0</td>
      <td>4.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2012-10-03 01:00:00</th>
      <td>10.0</td>
      <td>4.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>2012-10-03 02:00:00</th>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2012-10-03 03:00:00</th>
      <td>5.0</td>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>2012-10-03 04:00:00</th>
      <td>7.0</td>
      <td>6.0</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div><p>We’ll further process this dataset by shortening the column names and
adding a “Total” column:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Fremont Bridge Total&quot;</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span> <span class="c1"># have a look at summary statistics</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fremont Bridge Total</th>
      <th>Fremont Bridge East Sidewalk</th>
      <th>Fremont Bridge West Sidewalk</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>64934.000000</td>
      <td>64934.000000</td>
      <td>64934.000000</td>
      <td>64934.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>113.805033</td>
      <td>51.976191</td>
      <td>61.828842</td>
      <td>113.805033</td>
    </tr>
    <tr>
      <th>std</th>
      <td>145.235402</td>
      <td>67.013247</td>
      <td>90.605138</td>
      <td>145.235402</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>14.000000</td>
      <td>6.000000</td>
      <td>7.000000</td>
      <td>14.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>61.000000</td>
      <td>28.000000</td>
      <td>30.000000</td>
      <td>61.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>148.000000</td>
      <td>70.000000</td>
      <td>74.000000</td>
      <td>148.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1097.000000</td>
      <td>698.000000</td>
      <td>850.000000</td>
      <td>1097.000000</td>
    </tr>
  </tbody>
</table>
</div><div class="section" id="visualizing-the-data">
<h4>Visualizing the data<a class="headerlink" href="#visualizing-the-data" title="Permalink to this headline">¶</a></h4>
<p>We can gain some insight into the dataset by visualizing it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">seaborn</span><span class="p">;</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Hourly Bicycle Count&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_548_0.png" src="_images/pandas_548_0.png" />
<p>The ~25,000 hourly samples are far too dense for us to make much sense
of. We can gain more insight by resampling the data to a coarser grid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekly</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">weekly</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Weekly bicycle count&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_550_0.png" src="_images/pandas_550_0.png" />
<p>This shows us some interesting seasonal trends: as you might expect,
people bicycle more in the summer than in the winter, and even within a
particular season the bicycle use varies from week to week (likely
dependent on weather.</p>
<p>Another way that comes in handy for aggregating the data is to use a
rolling mean, utilizing the <code class="docutils literal notranslate"><span class="pre">pd.rolling_mean()</span></code> function. Here we’ll
do a 30 day rolling mean of our data, making sure to center the window:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">daily</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mean hourly count&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/pandas_553_0.png" src="_images/pandas_553_0.png" />
<p>The jaggedness of the result is due to the hard cutoff of the window. We
can get a smoother version of a rolling mean using a window function–for
example, a Gaussian window.</p>
<p>The following code specifies both the width of the window (we chose 50
days) and the width of the Gaussian within the window (we chose 10
days):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">daily</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
              <span class="n">win_type</span><span class="o">=</span><span class="s1">&#39;gaussian&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">std</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/pandas_556_0.png" src="_images/pandas_556_0.png" />
</div>
<div class="section" id="digging-into-the-data">
<h4>Digging into the data<a class="headerlink" href="#digging-into-the-data" title="Permalink to this headline">¶</a></h4>
<p>While these smoothed data views are useful to get an idea of the general
trend in the data, they hide much of the interesting structure. For
example, we might want to look at the average traffic as a function of
the time of day; we do this by grouping:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">hourly_ticks</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/pandas_558_0.png" src="_images/pandas_558_0.png" />
<p>The hourly traffic is a strongly bimodal distribution, with peaks around
8:00 in the morning and 5:00 in the evening. This is likely evidence of
a strong component of commuter traffic crossing the bridge. This is
further evidenced by the differences between the western sidewalk
(generally used going toward downtown Seattle), which peaks more
strongly in the morning, and the eastern sidewalk (generally used going
away from downtown Seattle), which peaks more strongly in the evening.</p>
<p>We also might be curious about how things change based on the day of the
week. Again, we can do this with a simple groupby:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">by_weekday</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">dayofweek</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">by_weekday</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mon&#39;</span><span class="p">,</span> <span class="s1">&#39;Tues&#39;</span><span class="p">,</span> <span class="s1">&#39;Wed&#39;</span><span class="p">,</span> <span class="s1">&#39;Thurs&#39;</span><span class="p">,</span> <span class="s1">&#39;Fri&#39;</span><span class="p">,</span> <span class="s1">&#39;Sat&#39;</span><span class="p">,</span> <span class="s1">&#39;Sun&#39;</span><span class="p">]</span>
<span class="n">by_weekday</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/pandas_561_0.png" src="_images/pandas_561_0.png" />
<p>This shows a strong distinction between weekday and weekend totals, with
around twice as many average riders crossing the bridge on Monday
through Friday than on Saturday and Sunday.</p>
<p>With this in mind, let’s do a compound GroupBy and look at the hourly
trend on weekdays versus weekends. We’ll start by grouping by both a
flag marking the weekend, and the time of day:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">weekend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">weekday</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;Weekday&#39;</span><span class="p">,</span> <span class="s1">&#39;Weekend&#39;</span><span class="p">)</span>
<span class="n">by_time</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">weekend</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">time</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Weekday&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Weekdays&#39;</span><span class="p">,</span>
                           <span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">])</span>
<span class="n">by_time</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Weekend&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Weekends&#39;</span><span class="p">,</span>
                           <span class="n">xticks</span><span class="o">=</span><span class="n">hourly_ticks</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/pandas_565_0.png" src="_images/pandas_565_0.png" />
<p>The result is very interesting: we see a bimodal commute pattern during
the work week, and a unimodal recreational pattern during the weekends.</p>
</div>
</div>
</div>
</div>
<div class="section" id="matplotlib-module">
<h1><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> module<a class="headerlink" href="#matplotlib-module" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. February 7, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract A (very concise) introduction to matplotlib.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;matplotlib&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="visualization-with-matplotlib">
<h2>Visualization with Matplotlib<a class="headerlink" href="#visualization-with-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>We’ll now take an in-depth look at the Matplotlib package for
visualization in Python. Matplotlib is a multi-platform data
visualization library built on NumPy arrays, and designed to work with
the broader SciPy stack. It was conceived by John Hunter in 2002,
originally as a patch to IPython for enabling interactive MATLAB-style
plotting via gnuplot from the IPython command line. IPython’s creator,
Fernando Perez, was at the time scrambling to finish his PhD, and let
John know he wouldn’t have time to review the patch for several months.
John took this as a cue to set out on his own, and the Matplotlib
package was born, with version 0.1 released in 2003. It received an
early boost when it was adopted as the plotting package of choice of the
Space Telescope Science Institute (the folks behind the Hubble
Telescope), which financially supported Matplotlib’s development and
greatly expanded its capabilities.</p>
<p>One of Matplotlib’s most important features is its ability to play well
with many operating systems and graphics backends. Matplotlib supports
dozens of backends and output types, which means you can count on it to
work regardless of which operating system you are using or which output
format you wish. This cross-platform, everything-to-everyone approach
has been one of the great strengths of Matplotlib. It has led to a large
user base, which in turn has led to an active developer base and
Matplotlib’s powerful tools and ubiquity within the scientific Python
world.</p>
<p>In recent years, however, the interface and style of Matplotlib have
begun to show their age. Newer tools like ggplot and ggvis in the R
language, along with web visualization toolkits based on D3js and HTML5
canvas, often make Matplotlib feel clunky and old-fashioned. Still, I’m
of the opinion that we cannot ignore Matplotlib’s strength as a
well-tested, cross-platform graphics engine. Recent Matplotlib versions
make it relatively easy to set new global plotting styles (see
<a class="reference external" href="04.11-Settings-and-Stylesheets.ipynb">Customizing Matplotlib: Configurations and Style
Sheets</a>), and people have been
developing new packages that build on its powerful internals to drive
Matplotlib via cleaner, more modern APIs—for example, Seaborn (discussed
in <a class="reference external" href="04.14-Visualization-With-Seaborn.ipynb">Visualization With
Seaborn</a>),
<a class="reference external" href="http://yhat.github.io/ggpy/">ggpy</a>,
<a class="reference external" href="http://holoviews.org/">HoloViews</a>,
<a class="reference external" href="http://altair-viz.github.io/">Altair</a>, and even Pandas itself can be
used as wrappers around Matplotlib’s API. Even with wrappers like these,
it is still often useful to dive into Matplotlib’s syntax to adjust the
final plot output. For this reason, I believe that Matplotlib itself
will remain a vital piece of the data visualization stack, even if new
tools mean the community gradually moves away from using the Matplotlib
API directly.</p>
<p>Just as we use the <code class="docutils literal notranslate"><span class="pre">np</span></code> shorthand for NumPy and the <code class="docutils literal notranslate"><span class="pre">pd</span></code> shorthand
for Pandas, we will use some standard shorthands for Matplotlib imports:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>We will use the <code class="docutils literal notranslate"><span class="pre">plt.style</span></code> directive to choose appropriate aesthetic
styles for our figures. Here we will set the <code class="docutils literal notranslate"><span class="pre">classic</span></code> style, which
ensures that the plots we create use the classic Matplotlib style:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Throughout this section, we will adjust this style as needed. Note that
the stylesheets used here are supported as of Matplotlib version 1.5; if
you are using an earlier version of Matplotlib, only the default style
is available. For more information on stylesheets, see <a class="reference external" href="04.11-Settings-and-Stylesheets.ipynb">Customizing
Matplotlib: Configurations and Style
Sheets</a>.</p>
<div class="section" id="general-matplotlib-tips">
<h3>General Matplotlib Tips<a class="headerlink" href="#general-matplotlib-tips" title="Permalink to this headline">¶</a></h3>
<p>Before we dive into the details of creating visualizations with
Matplotlib, there are a few useful things you should know about using
the package.</p>
<p>The IPython notebook is a browser-based interactive data analysis tool
that can combine narrative, code, graphics, HTML elements.</p>
<p>Plotting interactively within an IPython notebook can be done with the
<code class="docutils literal notranslate"><span class="pre">%matplotlib</span></code> command, and works in a similar way to the IPython
shell. In the IPython notebook, you also have the option of embedding
graphics directly in the notebook, with two possible options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code> will lead to <em>interactive</em> plots embedded
within the notebook</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> will lead to <em>static</em> images of your plot
embedded in the notebook</p></li>
</ul>
<p>For this book, we will generally opt for <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<p>After running this command (it needs to be done only once per
kernel/session), any cell within the notebook that creates a plot will
embed a PNG image of the resulting graphic:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;--&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_14_0.png" src="_images/matplotlib_14_0.png" />
<div class="section" id="saving-figures-to-file">
<h4>Saving Figures to File<a class="headerlink" href="#saving-figures-to-file" title="Permalink to this headline">¶</a></h4>
<p>One nice feature of Matplotlib is the ability to save figures in a wide
variety of formats. Saving a figure can be done using the <code class="docutils literal notranslate"><span class="pre">savefig()</span></code>
command. For example, to save the previous figure as a PNG file, you can
run this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;my_figure.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We now have a file called <code class="docutils literal notranslate"><span class="pre">my_figure.png</span></code> in the current working
directory:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls -lh my_figure.png
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">mn</span> <span class="n">mn</span> <span class="mi">26</span><span class="n">K</span> <span class="n">Apr</span>  <span class="mi">5</span> <span class="mi">22</span><span class="p">:</span><span class="mi">51</span> <span class="n">my_figure</span><span class="o">.</span><span class="n">png</span>
</pre></div>
</div>
<p>In <code class="docutils literal notranslate"><span class="pre">savefig()</span></code>, the file format is inferred from the extension of the
given filename. Depending on what backends you have installed, many
different file formats are available. The list of supported file types
can be found for your system by using the following method of the figure
canvas object:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_supported_filetypes</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;ps&#39;</span><span class="p">:</span> <span class="s1">&#39;Postscript&#39;</span><span class="p">,</span>
 <span class="s1">&#39;eps&#39;</span><span class="p">:</span> <span class="s1">&#39;Encapsulated Postscript&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pdf&#39;</span><span class="p">:</span> <span class="s1">&#39;Portable Document Format&#39;</span><span class="p">,</span>
 <span class="s1">&#39;pgf&#39;</span><span class="p">:</span> <span class="s1">&#39;PGF code for LaTeX&#39;</span><span class="p">,</span>
 <span class="s1">&#39;png&#39;</span><span class="p">:</span> <span class="s1">&#39;Portable Network Graphics&#39;</span><span class="p">,</span>
 <span class="s1">&#39;raw&#39;</span><span class="p">:</span> <span class="s1">&#39;Raw RGBA bitmap&#39;</span><span class="p">,</span>
 <span class="s1">&#39;rgba&#39;</span><span class="p">:</span> <span class="s1">&#39;Raw RGBA bitmap&#39;</span><span class="p">,</span>
 <span class="s1">&#39;svg&#39;</span><span class="p">:</span> <span class="s1">&#39;Scalable Vector Graphics&#39;</span><span class="p">,</span>
 <span class="s1">&#39;svgz&#39;</span><span class="p">:</span> <span class="s1">&#39;Scalable Vector Graphics&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="two-interfaces-for-the-price-of-one">
<h3>Two Interfaces for the Price of One<a class="headerlink" href="#two-interfaces-for-the-price-of-one" title="Permalink to this headline">¶</a></h3>
<p>A potentially confusing feature of Matplotlib is its dual interfaces: a
convenient MATLAB-style state-based interface, and a more powerful
object-oriented interface. We’ll quickly highlight the differences
between the two here.</p>
<p>Matplotlib was originally written as a Python alternative for MATLAB
users, and much of its syntax reflects that fact. The MATLAB-style tools
are contained in the pyplot (<code class="docutils literal notranslate"><span class="pre">plt</span></code>) interface. For example, the
following code will probably look quite familiar to MATLAB users:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>  <span class="c1"># create a plot figure</span>

<span class="c1"># create the first of two panels and set current axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># (rows, columns, panel number)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># create the second panel and set current axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_23_0.png" src="_images/matplotlib_23_0.png" />
<p>The object-oriented interface is available for these more complicated
situations, and for when you want more control over your figure. Rather
than depending on some notion of an “active” figure or axes, in the
object-oriented interface the plotting functions are <em>methods</em> of
explicit <code class="docutils literal notranslate"><span class="pre">Figure</span></code> and <code class="docutils literal notranslate"><span class="pre">Axes</span></code> objects. To re-create the previous plot
using this style of plotting, you might do the following:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First create a grid of plots</span>
<span class="c1"># ax will be an array of two Axes objects</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Call plot() method on the appropriate object</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_25_0.png" src="_images/matplotlib_25_0.png" />
</div>
</div>
<div class="section" id="simple-line-plots">
<h2>Simple Line Plots<a class="headerlink" href="#simple-line-plots" title="Permalink to this headline">¶</a></h2>
<p>Perhaps the simplest of all plots is the visualization of a single
function <span class="math notranslate nohighlight">\(y = f(x)\)</span>. Here we will take a first look at creating a
simple plot of this type. As with all the following sections, we’ll
start by setting up the notebook for plotting and importing the packages
we will use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>For all Matplotlib plots, we start by creating a figure and an axes. In
their simplest form, a figure and axes can be created as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_29_0.png" src="_images/matplotlib_29_0.png" />
<p>In Matplotlib, the <em>figure</em> (an instance of the class <code class="docutils literal notranslate"><span class="pre">plt.Figure</span></code>)
can be thought of as a single container that contains all the objects
representing axes, graphics, text, and labels. The <em>axes</em> (an instance
of the class <code class="docutils literal notranslate"><span class="pre">plt.Axes</span></code>) is what we see above: a bounding box with
ticks and labels, which will eventually contain the plot elements that
make up our visualization. Throughout this book, we’ll commonly use the
variable name <code class="docutils literal notranslate"><span class="pre">fig</span></code> to refer to a figure instance, and <code class="docutils literal notranslate"><span class="pre">ax</span></code> to refer
to an axes instance or group of axes instances.</p>
<p>Once we have created an axes, we can use the <code class="docutils literal notranslate"><span class="pre">ax.plot</span></code> function to
plot some data. Let’s start with a simple sinusoid:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_32_0.png" src="_images/matplotlib_32_0.png" />
<p>Alternatively, we can use the pylab interface and let the figure and
axes be created for us in the background:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_34_0.png" src="_images/matplotlib_34_0.png" />
<p>If we want to create a single figure with multiple lines, we can simply
call the <code class="docutils literal notranslate"><span class="pre">plot</span></code> function multiple times:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_36_0.png" src="_images/matplotlib_36_0.png" />
<div class="section" id="adjusting-the-plot-line-colors-and-styles">
<h3>Adjusting the Plot: Line Colors and Styles<a class="headerlink" href="#adjusting-the-plot-line-colors-and-styles" title="Permalink to this headline">¶</a></h3>
<p>The first adjustment you might wish to make to a plot is to control the
line colors and styles. The <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> function takes additional
arguments that can be used to specify these. To adjust the color, you
can use the <code class="docutils literal notranslate"><span class="pre">color</span></code> keyword, which accepts a string argument
representing virtually any imaginable color.</p>
<p>The color can be specified in a variety of ways (If no color is
specified, Matplotlib will automatically cycle through a set of default
colors for multiple lines):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">0</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>        <span class="c1"># specify color by name</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>           <span class="c1"># short color code (rgbcmyk)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>        <span class="c1"># Grayscale between 0 and 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">3</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#FFDD44&#39;</span><span class="p">)</span>     <span class="c1"># Hex code (RRGGBB from 00 to FF)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.3</span><span class="p">))</span> <span class="c1"># RGB tuple, values 0 to 1</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;chartreuse&#39;</span><span class="p">);</span> <span class="c1"># all HTML color names supported</span>
</pre></div>
</div>
<img alt="_images/matplotlib_39_0.png" src="_images/matplotlib_39_0.png" />
<p>Similarly, the line style can be adjusted using the <code class="docutils literal notranslate"><span class="pre">linestyle</span></code>
keyword:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashdot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">);</span>

<span class="c1"># For short, you can use the following codes:</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># solid</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1"># dashed</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span> <span class="c1"># dashdot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">);</span>  <span class="c1"># dotted</span>
</pre></div>
</div>
<img alt="_images/matplotlib_41_0.png" src="_images/matplotlib_41_0.png" />
<p>If you would like to be extremely terse, these <code class="docutils literal notranslate"><span class="pre">linestyle</span></code> and
<code class="docutils literal notranslate"><span class="pre">color</span></code> codes can be combined into a single non-keyword argument to
the <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;-g&#39;</span><span class="p">)</span>  <span class="c1"># solid green</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;--c&#39;</span><span class="p">)</span> <span class="c1"># dashed cyan</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;-.k&#39;</span><span class="p">)</span> <span class="c1"># dashdot black</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;:r&#39;</span><span class="p">);</span>  <span class="c1"># dotted red</span>
</pre></div>
</div>
<img alt="_images/matplotlib_43_0.png" src="_images/matplotlib_43_0.png" />
</div>
<div class="section" id="adjusting-the-plot-axes-limits">
<h3>Adjusting the Plot: Axes Limits<a class="headerlink" href="#adjusting-the-plot-axes-limits" title="Permalink to this headline">¶</a></h3>
<p>Matplotlib does a decent job of choosing default axes limits for your
plot, but sometimes it’s nice to have finer control. The most basic way
to adjust axis limits is to use the <code class="docutils literal notranslate"><span class="pre">plt.xlim()</span></code> and <code class="docutils literal notranslate"><span class="pre">plt.ylim()</span></code>
methods:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_45_0.png" src="_images/matplotlib_45_0.png" />
<p>If for some reason you’d like either axis to be displayed in reverse,
you can simply reverse the order of the arguments:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_47_0.png" src="_images/matplotlib_47_0.png" />
<p>A useful related method is <code class="docutils literal notranslate"><span class="pre">plt.axis()</span></code> (note here the potential
confusion between <em>axes</em> with an <em>e</em>, and <em>axis</em> with an <em>i</em>). The
<code class="docutils literal notranslate"><span class="pre">plt.axis()</span></code> method allows you to set the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> limits with
a single call, by passing a list which specifies
<code class="docutils literal notranslate"><span class="pre">[xmin,</span> <span class="pre">xmax,</span> <span class="pre">ymin,</span> <span class="pre">ymax]</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_49_0.png" src="_images/matplotlib_49_0.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">plt.axis()</span></code> method goes even beyond this, allowing you to do
things like automatically tighten the bounds around the current plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_51_0.png" src="_images/matplotlib_51_0.png" />
<p>It allows even higher-level specifications, such as ensuring an equal
aspect ratio so that on your screen, one unit in <code class="docutils literal notranslate"><span class="pre">x</span></code> is equal to one
unit in <code class="docutils literal notranslate"><span class="pre">y</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_53_0.png" src="_images/matplotlib_53_0.png" />
</div>
<div class="section" id="labeling-plots">
<h3>Labeling Plots<a class="headerlink" href="#labeling-plots" title="Permalink to this headline">¶</a></h3>
<p>As the last piece of this section, we’ll briefly look at the labeling of
plots: titles, axis labels, and simple legends.</p>
<p>Titles and axis labels are the simplest such labels—there are methods
that can be used to quickly set them:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;A Sine Curve&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;sin(x)&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_55_0.png" src="_images/matplotlib_55_0.png" />
<p>When multiple lines are being shown within a single axes, it can be
useful to create a plot legend that labels each line type. Again,
Matplotlib has a built-in way of quickly creating such a legend. It is
done via the (you guessed it) <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> method. Though there are
several valid ways of using this, I find it easiest to specify the label
of each line using the <code class="docutils literal notranslate"><span class="pre">label</span></code> keyword of the plot function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;-g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;:b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;cos(x)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_57_0.png" src="_images/matplotlib_57_0.png" />
</div>
<div class="section" id="aside-matplotlib-gotchas">
<h3>Aside: Matplotlib Gotchas<a class="headerlink" href="#aside-matplotlib-gotchas" title="Permalink to this headline">¶</a></h3>
<p>While most <code class="docutils literal notranslate"><span class="pre">plt</span></code> functions translate directly to <code class="docutils literal notranslate"><span class="pre">ax</span></code> methods (such
as <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.plot()</span></code>, <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.legend()</span></code>,
etc.), this is not the case for all commands. In particular, functions
to set limits, labels, and titles are slightly modified. For
transitioning between MATLAB-style functions and object-oriented
methods, make the following changes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plt.xlabel()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.set_xlabel()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.ylabel()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.set_ylabel()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.xlim()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.set_xlim()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.ylim()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.set_ylim()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.title()</span></code> → <code class="docutils literal notranslate"><span class="pre">ax.set_title()</span></code></p></li>
</ul>
<p>In the object-oriented interface to plotting, rather than calling these
functions individually, it is often more convenient to use the
<code class="docutils literal notranslate"><span class="pre">ax.set()</span></code> method to set all these properties at once:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;sin(x)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;A Simple Plot&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_59_0.png" src="_images/matplotlib_59_0.png" />
</div>
</div>
<div class="section" id="simple-scatter-plots">
<h2>Simple Scatter Plots<a class="headerlink" href="#simple-scatter-plots" title="Permalink to this headline">¶</a></h2>
<p>Another commonly used plot type is the simple scatter plot, a close
cousin of the line plot. Instead of points being joined by line
segments, here the points are represented individually with a dot,
circle, or other shape. We’ll start by setting up the notebook for
plotting and importing the functions we will use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="section" id="scatter-plots-with-plt-plot">
<h3>Scatter Plots with <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code><a class="headerlink" href="#scatter-plots-with-plt-plot" title="Permalink to this headline">¶</a></h3>
<p>In the previous section we looked at <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>/<code class="docutils literal notranslate"><span class="pre">ax.plot</span></code> to produce
line plots. It turns out that this same function can produce scatter
plots as well:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_63_0.png" src="_images/matplotlib_63_0.png" />
<p>The third argument in the function call is a character that represents
the type of symbol used for the plotting. Just as you can specify
options such as <code class="docutils literal notranslate"><span class="pre">'-'</span></code>, <code class="docutils literal notranslate"><span class="pre">'--'</span></code> to control the line style, the marker
style has its own set of short string codes. The full list of available
symbols can be seen in the documentation of <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>, or in
Matplotlib’s online documentation. Most of the possibilities are fairly
intuitive, and we’ll show a number of the more common ones here:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">marker</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;^&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">marker</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;marker=&#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">marker</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">numpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_65_0.png" src="_images/matplotlib_65_0.png" />
<p>For even more possibilities, these character codes can be used together
with line and color codes to plot points along with a line connecting
them:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-ok&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_67_0.png" src="_images/matplotlib_67_0.png" />
<p>Additional keyword arguments to <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> specify a wide range of
properties of the lines and markers:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
         <span class="n">markersize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
         <span class="n">markerfacecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
         <span class="n">markeredgecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span>
         <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_69_0.png" src="_images/matplotlib_69_0.png" />
</div>
<div class="section" id="scatter-plots-with-plt-scatter">
<h3>Scatter Plots with <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code><a class="headerlink" href="#scatter-plots-with-plt-scatter" title="Permalink to this headline">¶</a></h3>
<p>A second, more powerful method of creating scatter plots is the
<code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> function, which can be used very similarly to the
<code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_71_0.png" src="_images/matplotlib_71_0.png" />
<p>The primary difference of <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> from <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> is that it
can be used to create scatter plots where the properties of each
individual point (size, face color, edge color, etc.) can be
individually controlled or mapped to data.</p>
<p>Let’s show this by creating a random scatter plot with points of many
colors and sizes. In order to better see the overlapping results, we’ll
also use the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> keyword to adjust the transparency level:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>  <span class="c1"># show color scale</span>
</pre></div>
</div>
<img alt="_images/matplotlib_74_0.png" src="_images/matplotlib_74_0.png" />
<p>Notice that the color argument is automatically mapped to a color scale
(shown here by the <code class="docutils literal notranslate"><span class="pre">colorbar()</span></code> command), and that the size argument
is given in pixels. In this way, the color and size of points can be
used to convey information in the visualization, in order to visualize
multidimensional data.</p>
<p>For example, we might use the Iris data from Scikit-Learn, where each
sample is one of three types of flowers that has had the size of its
petals and sepals carefully measured:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">T</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">features</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">features</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="o">*</span><span class="n">features</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_77_0.png" src="_images/matplotlib_77_0.png" />
</div>
<div class="section" id="plot-versus-scatter-a-note-on-efficiency">
<h3><code class="docutils literal notranslate"><span class="pre">plot</span></code> Versus <code class="docutils literal notranslate"><span class="pre">scatter</span></code>: A Note on Efficiency<a class="headerlink" href="#plot-versus-scatter-a-note-on-efficiency" title="Permalink to this headline">¶</a></h3>
<p>Aside from the different features available in <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> and
<code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code>, why might you choose to use one over the other? While
it doesn’t matter as much for small amounts of data, as datasets get
larger than a few thousand points, <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> can be noticeably more
efficient than <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code>. The reason is that <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> has
the capability to render a different size and/or color for each point,
so the renderer must do the extra work of constructing each point
individually. In <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>, on the other hand, the points are always
essentially clones of each other, so the work of determining the
appearance of the points is done only once for the entire set of data.
For large datasets, the difference between these two can lead to vastly
different performance, and for this reason, <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code> should be
preferred over <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code> for large datasets.</p>
</div>
</div>
<div class="section" id="visualizing-errors">
<h2>Visualizing Errors<a class="headerlink" href="#visualizing-errors" title="Permalink to this headline">¶</a></h2>
<p>For any scientific measurement, accurate accounting for errors is nearly
as important, if not more important, than accurate reporting of the
number itself. For example, imagine that I am using some astrophysical
observations to estimate the Hubble Constant, the local measurement of
the expansion rate of the Universe. I know that the current literature
suggests a value of around 71 (km/s)/Mpc, and I measure a value of 74
(km/s)/Mpc with my method. Are the values consistent? The only correct
answer, given this information, is this: there is no way to know.</p>
<p>Suppose I augment this information with reported uncertainties: the
current literature suggests a value of around 71 <span class="math notranslate nohighlight">\(\pm\)</span> 2.5
(km/s)/Mpc, and my method has measured a value of 74 <span class="math notranslate nohighlight">\(\pm\)</span> 5
(km/s)/Mpc. Now are the values consistent? That is a question that can
be quantitatively answered.</p>
<p>In visualization of data and results, showing these errors effectively
can make a plot convey much more complete information.</p>
<div class="section" id="basic-errorbars">
<h3>Basic Errorbars<a class="headerlink" href="#basic-errorbars" title="Permalink to this headline">¶</a></h3>
<p>A basic errorbar can be created with a single Matplotlib function call:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Here the <code class="docutils literal notranslate"><span class="pre">fmt</span></code> is a format code controlling the appearance of lines
and points, and has the same syntax as the shorthand used in
<code class="docutils literal notranslate"><span class="pre">plt.plot</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">dy</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">dy</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.k&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_83_0.png" src="_images/matplotlib_83_0.png" />
<p>In addition to these basic options, the <code class="docutils literal notranslate"><span class="pre">errorbar</span></code> function has many
options to fine-tune the outputs. Using these additional options you can
easily customize the aesthetics of your errorbar plot. I often find it
helpful, especially in crowded plots, to make the errorbars lighter than
the points themselves:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">dy</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_85_0.png" src="_images/matplotlib_85_0.png" />
</div>
</div>
<div class="section" id="density-and-contour-plots">
<h2>Density and Contour Plots<a class="headerlink" href="#density-and-contour-plots" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is useful to display three-dimensional data in two
dimensions using contours or color-coded regions. There are three
Matplotlib functions that can be helpful for this task: <code class="docutils literal notranslate"><span class="pre">plt.contour</span></code>
for contour plots, <code class="docutils literal notranslate"><span class="pre">plt.contourf</span></code> for filled contour plots, and
<code class="docutils literal notranslate"><span class="pre">plt.imshow</span></code> for showing images. This section looks at several
examples of using these. We’ll start by setting up the notebook for
plotting and importing the functions we will use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="section" id="visualizing-a-three-dimensional-function">
<h3>Visualizing a Three-Dimensional Function<a class="headerlink" href="#visualizing-a-three-dimensional-function" title="Permalink to this headline">¶</a></h3>
<p>We’ll start by demonstrating a contour plot using a function
<span class="math notranslate nohighlight">\(z = f(x, y)\)</span>, using the following particular choice for <span class="math notranslate nohighlight">\(f\)</span>
(we’ve seen this before in <a class="reference external" href="02.05-Computation-on-arrays-broadcasting.ipynb">Computation on Arrays:
Broadcasting</a>, when
we used it as a motivating example for array broadcasting):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">**</span> <span class="mi">10</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">10</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>A contour plot can be created with the <code class="docutils literal notranslate"><span class="pre">plt.contour</span></code> function. It
takes three arguments: a grid of <em>x</em> values, a grid of <em>y</em> values, and a
grid of <em>z</em> values. The <em>x</em> and <em>y</em> values represent positions on the
plot, and the <em>z</em> values will be represented by the contour levels.
Perhaps the most straightforward way to prepare such data is to use the
<code class="docutils literal notranslate"><span class="pre">np.meshgrid</span></code> function, which builds two-dimensional grids from
one-dimensional arrays:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s look at this with a standard line-only contour plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_93_0.png" src="_images/matplotlib_93_0.png" />
<p>Notice that by default when a single color is used, negative values are
represented by dashed lines, and positive values by solid lines.</p>
<p>Alternatively, the lines can be color-coded by specifying a colormap
with the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> argument. Here, we’ll also specify that we want more
lines to be drawn—20 equally spaced intervals within the data range:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdGy&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_96_0.png" src="_images/matplotlib_96_0.png" />
<p>Here we chose the <code class="docutils literal notranslate"><span class="pre">RdGy</span></code> (short for <em>Red-Gray</em>) colormap, which is a
good choice for centered data. Matplotlib has a wide range of colormaps
available, which you can easily browse in IPython by doing a tab
completion on the <code class="docutils literal notranslate"><span class="pre">plt.cm</span></code> module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.&lt;</span><span class="n">TAB</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Our plot is looking nicer, but the spaces between the lines may be a bit
distracting. We can change this by switching to a filled contour plot
using the <code class="docutils literal notranslate"><span class="pre">plt.contourf()</span></code> function (notice the <code class="docutils literal notranslate"><span class="pre">f</span></code> at the end),
which uses largely the same syntax as <code class="docutils literal notranslate"><span class="pre">plt.contour()</span></code>.</p>
<p>Additionally, we’ll add a <code class="docutils literal notranslate"><span class="pre">plt.colorbar()</span></code> command, which
automatically creates an additional axis with labeled color information
for the plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdGy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span> <span class="c1"># The colorbar makes it clear that the black regions</span>
                <span class="c1"># are &quot;peaks,&quot; while the red regions are &quot;valleys.&quot;</span>
</pre></div>
</div>
<img alt="_images/matplotlib_99_0.png" src="_images/matplotlib_99_0.png" />
<p>One potential issue with this plot is that it is a bit “splotchy.” That
is, the color steps are discrete rather than continuous, which is not
always what is desired. This could be remedied by setting the number of
contours to a very high number, but this results in a rather inefficient
plot: Matplotlib must render a new polygon for each step in the level. A
better way to handle this is to use the <code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code> function, which
interprets a two-dimensional grid of data as an image. The following
code shows this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdGy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;image&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_101_0.png" src="_images/matplotlib_101_0.png" />
<p>There are a few potential gotchas with <code class="docutils literal notranslate"><span class="pre">imshow()</span></code>, however:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code> doesn’t accept an <em>x</em> and <em>y</em> grid, so you must
manually specify the <em>extent</em> [<em>xmin</em>, <em>xmax</em>, <em>ymin</em>, <em>ymax</em>] of the
image on the plot.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code> by default follows the standard image array
definition where the origin is in the upper left, not in the lower
left as in most contour plots. This must be changed when showing
gridded data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code> will automatically adjust the axis aspect ratio to
match the input data; this can be changed by setting, for example,
<code class="docutils literal notranslate"><span class="pre">plt.axis(aspect='image')</span></code> to make <em>x</em> and <em>y</em> units match.</p></li>
</ul>
<p>Finally, it can sometimes be useful to combine contour plots and image
plots. For example, here we’ll use a partially transparent background
image (with transparency set via the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> parameter) and overplot
contours with labels on the contours themselves (using the
<code class="docutils literal notranslate"><span class="pre">plt.clabel()</span></code> function):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">contours</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">contours</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdGy&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_104_0.png" src="_images/matplotlib_104_0.png" />
</div>
</div>
<div class="section" id="histograms-binnings-and-density">
<h2>Histograms, Binnings, and Density<a class="headerlink" href="#histograms-binnings-and-density" title="Permalink to this headline">¶</a></h2>
<p>A simple histogram can be a great first step in understanding a dataset.
Earlier, we saw a preview of Matplotlib’s histogram function (see
<a class="reference external" href="02.06-Boolean-Arrays-and-Masks.ipynb">Comparisons, Masks, and Boolean
Logic</a>), which creates a basic
histogram in one line, once the normal boiler-plate imports are done:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_107_0.png" src="_images/matplotlib_107_0.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">hist()</span></code> function has many options to tune both the calculation
and the display; here’s an example of a more customized histogram:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
         <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span>
         <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_109_0.png" src="_images/matplotlib_109_0.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">plt.hist</span></code> docstring has more information on other customization
options available. I find this combination of <code class="docutils literal notranslate"><span class="pre">histtype='stepfilled'</span></code>
along with some transparency <code class="docutils literal notranslate"><span class="pre">alpha</span></code> to be very useful when comparing
histograms of several distributions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_111_0.png" src="_images/matplotlib_111_0.png" />
<p>If you would like to simply compute the histogram (that is, count the
number of points in a given bin) and not display it, the
<code class="docutils literal notranslate"><span class="pre">np.histogram()</span></code> function is available:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mi">54</span> <span class="mi">262</span> <span class="mi">462</span> <span class="mi">203</span>  <span class="mi">19</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="two-dimensional-histograms-and-binnings">
<h3>Two-Dimensional Histograms and Binnings<a class="headerlink" href="#two-dimensional-histograms-and-binnings" title="Permalink to this headline">¶</a></h3>
<p>Just as we create histograms in one dimension by dividing the
number-line into bins, we can also create histograms in two-dimensions
by dividing points among two-dimensional bins. We’ll take a brief look
at several ways to do this here. We’ll start by defining some data—an
<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> array drawn from a multivariate Gaussian distribution:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<div class="section" id="plt-hist2d-two-dimensional-histogram">
<h4><code class="docutils literal notranslate"><span class="pre">plt.hist2d</span></code>: Two-dimensional histogram<a class="headerlink" href="#plt-hist2d-two-dimensional-histogram" title="Permalink to this headline">¶</a></h4>
<p>One straightforward way to plot a two-dimensional histogram is to use
Matplotlib’s <code class="docutils literal notranslate"><span class="pre">plt.hist2d</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;counts in bin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_117_0.png" src="_images/matplotlib_117_0.png" />
<p>Just as with <code class="docutils literal notranslate"><span class="pre">plt.hist</span></code>, <code class="docutils literal notranslate"><span class="pre">plt.hist2d</span></code> has a number of extra options
to fine-tune the plot and the binning, which are nicely outlined in the
function docstring. Further, just as <code class="docutils literal notranslate"><span class="pre">plt.hist</span></code> has a counterpart in
<code class="docutils literal notranslate"><span class="pre">np.histogram</span></code>, <code class="docutils literal notranslate"><span class="pre">plt.hist2d</span></code> has a counterpart in
<code class="docutils literal notranslate"><span class="pre">np.histogram2d</span></code>, which can be used as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counts</span><span class="p">,</span> <span class="n">xedges</span><span class="p">,</span> <span class="n">yedges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plt-hexbin-hexagonal-binnings">
<h4><code class="docutils literal notranslate"><span class="pre">plt.hexbin</span></code>: Hexagonal binnings<a class="headerlink" href="#plt-hexbin-hexagonal-binnings" title="Permalink to this headline">¶</a></h4>
<p>The two-dimensional histogram creates a tesselation of squares across
the axes. Another natural shape for such a tesselation is the regular
hexagon. For this purpose, Matplotlib provides the <code class="docutils literal notranslate"><span class="pre">plt.hexbin</span></code>
routine, which will represents a two-dimensional dataset binned within a
grid of hexagons:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">gridsize</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;count in bin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_121_0.png" src="_images/matplotlib_121_0.png" />
<p><code class="docutils literal notranslate"><span class="pre">plt.hexbin</span></code> has a number of interesting options, including the
ability to specify weights for each point, and to change the output in
each bin to any NumPy aggregate (mean of weights, standard deviation of
weights, etc.).</p>
</div>
<div class="section" id="kernel-density-estimation">
<h4>Kernel density estimation<a class="headerlink" href="#kernel-density-estimation" title="Permalink to this headline">¶</a></h4>
<p>Another common method of evaluating densities in multiple dimensions is
<em>kernel density estimation</em> (KDE). This will be discussed more fully in
<a class="reference external" href="05.13-Kernel-Density-Estimation.ipynb">In-Depth: Kernel Density
Estimation</a>, but for now we’ll
simply mention that KDE can be thought of as a way to “smear out” the
points in space and add up the result to obtain a smooth function. One
extremely quick and simple KDE implementation exists in the
<code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> package. Here is a quick example of using the KDE on
this data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gaussian_kde</span>

<span class="c1"># fit an array of size [Ndim, Nsamples]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
<span class="n">kde</span> <span class="o">=</span> <span class="n">gaussian_kde</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># evaluate on a regular grid</span>
<span class="n">xgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">Xgrid</span><span class="p">,</span> <span class="n">Ygrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">xgrid</span><span class="p">,</span> <span class="n">ygrid</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">kde</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">Xgrid</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">Ygrid</span><span class="o">.</span><span class="n">ravel</span><span class="p">()]))</span>

<span class="c1"># Plot the result as an image</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">Z</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Xgrid</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_124_0.png" src="_images/matplotlib_124_0.png" />
<p>KDE has a smoothing length that effectively slides the knob between
detail and smoothness (one example of the ubiquitous bias–variance
trade-off). The literature on choosing an appropriate smoothing length
is vast: <code class="docutils literal notranslate"><span class="pre">gaussian_kde</span></code> uses a rule-of-thumb to attempt to find a
nearly optimal smoothing length for the input data.</p>
<p>Other KDE implementations are available within the SciPy ecosystem, each
with its own strengths and weaknesses; see, for example,
<code class="docutils literal notranslate"><span class="pre">sklearn.neighbors.KernelDensity</span></code> and
<code class="docutils literal notranslate"><span class="pre">statsmodels.nonparametric.kernel_density.KDEMultivariate</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="customizing-plot-legends">
<h2>Customizing Plot Legends<a class="headerlink" href="#customizing-plot-legends" title="Permalink to this headline">¶</a></h2>
<p>Plot legends give meaning to a visualization, assigning meaning to the
various plot elements. We previously saw how to create a simple legend;
here we’ll take a look at customizing the placement and aesthetics of
the legend in Matplotlib.</p>
<p>The simplest legend can be created with the <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> command,
which automatically creates a legend for any labeled plot elements:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;-b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sine&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;--r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cosine&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_128_0.png" src="_images/matplotlib_128_0.png" />
<p>But there are many ways we might want to customize such a legend. For
example, we can specify the location and turn off the frame:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_130_0.png" src="_images/matplotlib_130_0.png" />
<p>We can use the <code class="docutils literal notranslate"><span class="pre">ncol</span></code> command to specify the number of columns in the
legend:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower center&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_132_0.png" src="_images/matplotlib_132_0.png" />
<p>We can use a rounded box (<code class="docutils literal notranslate"><span class="pre">fancybox</span></code>) or add a shadow, change the
transparency (alpha value) of the frame, or change the padding around
the text:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">borderpad</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_134_0.png" src="_images/matplotlib_134_0.png" />
<div class="section" id="choosing-elements-for-the-legend">
<h3>Choosing Elements for the Legend<a class="headerlink" href="#choosing-elements-for-the-legend" title="Permalink to this headline">¶</a></h3>
<p>As we have already seen, the legend includes all labeled elements by
default. If this is not what is desired, we can fine-tune which elements
and labels appear in the legend by using the objects returned by plot
commands. The <code class="docutils literal notranslate"><span class="pre">plt.plot()</span></code> command is able to create multiple lines at
once, and returns a list of created line instances. Passing any of these
to <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> will tell it which to identify, along with the
labels we’d like to specify:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># lines is a list of plt.Line2D instances</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;first&#39;</span><span class="p">,</span> <span class="s1">&#39;second&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_136_0.png" src="_images/matplotlib_136_0.png" />
<p>I generally find in practice that it is clearer to use the first method,
applying labels to the plot elements you’d like to show on the legend:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;second&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">framealpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_138_0.png" src="_images/matplotlib_138_0.png" />
</div>
<div class="section" id="legend-for-size-of-points">
<h3>Legend for Size of Points<a class="headerlink" href="#legend-for-size-of-points" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the legend defaults are not sufficient for the given
visualization. For example, perhaps you’re be using the size of points
to mark certain features of the data, and want to create a legend
reflecting this. Here is an example where we’ll use the size of points
to indicate populations of California cities. We’d like a legend that
specifies the scale of the sizes of the points, and we’ll accomplish
this by plotting some labeled data with no entries:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">cities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/california_cities.csv&#39;</span><span class="p">)</span>

<span class="c1"># Extract the data we&#39;re interested in</span>
<span class="n">lat</span><span class="p">,</span> <span class="n">lon</span> <span class="o">=</span> <span class="n">cities</span><span class="p">[</span><span class="s1">&#39;latd&#39;</span><span class="p">],</span> <span class="n">cities</span><span class="p">[</span><span class="s1">&#39;longd&#39;</span><span class="p">]</span>
<span class="n">population</span><span class="p">,</span> <span class="n">area</span> <span class="o">=</span> <span class="n">cities</span><span class="p">[</span><span class="s1">&#39;population_total&#39;</span><span class="p">],</span> <span class="n">cities</span><span class="p">[</span><span class="s1">&#39;area_total_km2&#39;</span><span class="p">]</span>

<span class="c1"># Scatter the points, using size and color but no label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">population</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;latitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;log$_</span><span class="si">{10}</span><span class="s1">$(population)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>

<span class="c1"># Here we create a legend:</span>
<span class="c1"># we&#39;ll plot empty lists with the desired size and label</span>
<span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">]:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([],</span> <span class="p">[],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">area</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">area</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; km$^2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">scatterpoints</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">labelspacing</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;City Area&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;California Cities: Area and Population&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_140_0.png" src="_images/matplotlib_140_0.png" />
<p>The legend will always reference some object that is on the plot, so if
we’d like to display a particular shape we need to plot it. In this
case, the objects we want (gray circles) are not on the plot, so we fake
them by plotting empty lists. Notice too that the legend only lists plot
elements that have a label specified.</p>
<p>By plotting empty lists, we create labeled plot objects which are picked
up by the legend, and now our legend tells us some useful information.
This strategy can be useful for creating more sophisticated
visualizations.</p>
<p>Finally, note that for geographic data like this, it would be clearer if
we could show state boundaries or other map-specific elements.</p>
</div>
<div class="section" id="multiple-legends">
<h3>Multiple Legends<a class="headerlink" href="#multiple-legends" title="Permalink to this headline">¶</a></h3>
<p>Sometimes when designing a plot you’d like to add multiple legends to
the same axes. Unfortunately, Matplotlib does not make this easy: via
the standard <code class="docutils literal notranslate"><span class="pre">legend</span></code> interface, it is only possible to create a
single legend for the entire plot. If you try to create a second legend
using <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> or <code class="docutils literal notranslate"><span class="pre">ax.legend()</span></code>, it will simply override the
first one. We can work around this by creating a new legend artist from
scratch, and then using the lower-level <code class="docutils literal notranslate"><span class="pre">ax.add_artist()</span></code> method to
manually add the second artist to the plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">styles</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">lines</span> <span class="o">+=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="c1"># specify the lines and labels of the first legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">lines</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;line A&#39;</span><span class="p">,</span> <span class="s1">&#39;line B&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Create the second legend and add the artist manually.</span>
<span class="kn">from</span> <span class="nn">matplotlib.legend</span> <span class="kn">import</span> <span class="n">Legend</span>
<span class="n">leg</span> <span class="o">=</span> <span class="n">Legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="mi">2</span><span class="p">:],</span> <span class="p">[</span><span class="s1">&#39;line C&#39;</span><span class="p">,</span> <span class="s1">&#39;line D&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">leg</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_143_0.png" src="_images/matplotlib_143_0.png" />
</div>
</div>
<div class="section" id="customizing-colorbars">
<h2>Customizing Colorbars<a class="headerlink" href="#customizing-colorbars" title="Permalink to this headline">¶</a></h2>
<p>Plot legends identify discrete labels of discrete points. For continuous
labels based on the color of points, lines, or regions, a labeled
colorbar can be a great tool. In Matplotlib, a colorbar is a separate
axes that can provide a key for the meaning of colors in a plot. Because
the book is printed in black-and-white, this section has an accompanying
online supplement where you can view the figures in full color
(<a class="reference external" href="https://github.com/jakevdp/PythonDataScienceHandbook">https://github.com/jakevdp/PythonDataScienceHandbook</a>). We’ll start by
setting up the notebook for plotting and importing the functions we will
use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>As we have seen several times throughout this section, the simplest
colorbar can be created with the <code class="docutils literal notranslate"><span class="pre">plt.colorbar</span></code> function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_148_0.png" src="_images/matplotlib_148_0.png" />
<div class="section" id="id9">
<h3>Customizing Colorbars<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>The colormap can be specified using the <code class="docutils literal notranslate"><span class="pre">cmap</span></code> argument to the
plotting function that is creating the visualization:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_150_0.png" src="_images/matplotlib_150_0.png" />
<div class="section" id="choosing-the-colormap">
<h4>Choosing the Colormap<a class="headerlink" href="#choosing-the-colormap" title="Permalink to this headline">¶</a></h4>
<p>A full treatment of color choice within visualization is beyond the
scope of this book, but for entertaining reading on this subject and
others, see the article <a class="reference external" href="http://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1003833">“Ten Simple Rules for Better
Figures”</a>.
Matplotlib’s online documentation also has an <a class="reference external" href="http://Matplotlib.org/1.4.1/users/colormaps.html">interesting
discussion</a> of
colormap choice.</p>
<p>Broadly, you should be aware of three different categories of colormaps:</p>
<ul class="simple">
<li><p><em>Sequential colormaps</em>: These are made up of one continuous sequence
of colors (e.g., <code class="docutils literal notranslate"><span class="pre">binary</span></code> or <code class="docutils literal notranslate"><span class="pre">viridis</span></code>).</p></li>
<li><p><em>Divergent colormaps</em>: These usually contain two distinct colors,
which show positive and negative deviations from a mean (e.g.,
<code class="docutils literal notranslate"><span class="pre">RdBu</span></code> or <code class="docutils literal notranslate"><span class="pre">PuOr</span></code>).</p></li>
<li><p><em>Qualitative colormaps</em>: these mix colors with no particular sequence
(e.g., <code class="docutils literal notranslate"><span class="pre">rainbow</span></code> or <code class="docutils literal notranslate"><span class="pre">jet</span></code>).</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">jet</span></code> colormap, which was the default in Matplotlib prior to
version 2.0, is an example of a qualitative colormap. Its status as the
default was quite unfortunate, because qualitative maps are often a poor
choice for representing quantitative data. Among the problems is the
fact that qualitative maps usually do not display any uniform
progression in brightness as the scale increases.</p>
<p>We can see this by converting the <code class="docutils literal notranslate"><span class="pre">jet</span></code> colorbar into black and white:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>

<span class="k">def</span> <span class="nf">grayscale_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return a grayscale version of the given colormap&quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>

    <span class="c1"># convert RGBA to perceived grayscale luminance</span>
    <span class="c1"># cf. http://alienryderflex.com/hsp.html</span>
    <span class="n">RGB_weight</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.299</span><span class="p">,</span> <span class="mf">0.587</span><span class="p">,</span> <span class="mf">0.114</span><span class="p">]</span>
    <span class="n">luminance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">colors</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">RGB_weight</span><span class="p">))</span>
    <span class="n">colors</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">luminance</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;_gray&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">view_colormap</span><span class="p">(</span><span class="n">cmap</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Plot a colormap with its grayscale equivalent&quot;&quot;&quot;</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">grayscale_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">grayscale</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">))</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[]))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">colors</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">([</span><span class="n">grayscale</span><span class="p">],</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_colormap</span><span class="p">(</span><span class="s1">&#39;jet&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_154_0.png" src="_images/matplotlib_154_0.png" />
<p>Notice the bright stripes in the grayscale image. Even in full color,
this uneven brightness means that the eye will be drawn to certain
portions of the color range, which will potentially emphasize
unimportant parts of the dataset. It’s better to use a colormap such as
<code class="docutils literal notranslate"><span class="pre">viridis</span></code> (the default as of Matplotlib 2.0), which is specifically
constructed to have an even brightness variation across the range.</p>
<p>Thus it not only plays well with our color perception, but also will
translate well to grayscale printing:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_colormap</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_157_0.png" src="_images/matplotlib_157_0.png" />
<p>If you favor rainbow schemes, another good option for continuous data is
the <code class="docutils literal notranslate"><span class="pre">cubehelix</span></code> colormap:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_colormap</span><span class="p">(</span><span class="s1">&#39;cubehelix&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_159_0.png" src="_images/matplotlib_159_0.png" />
<p>For other situations, such as showing positive and negative deviations
from some mean, dual-color colorbars such as <code class="docutils literal notranslate"><span class="pre">RdBu</span></code> (<em>Red-Blue</em>) can
be useful. However, as you can see in the following figure, it’s
important to note that the positive-negative information will be lost
upon translation to grayscale!</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">view_colormap</span><span class="p">(</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_161_0.png" src="_images/matplotlib_161_0.png" />
</div>
<div class="section" id="color-limits-and-extensions">
<h4>Color limits and extensions<a class="headerlink" href="#color-limits-and-extensions" title="Permalink to this headline">¶</a></h4>
<p>Matplotlib allows for a large range of colorbar customization. The
colorbar itself is simply an instance of <code class="docutils literal notranslate"><span class="pre">plt.Axes</span></code>, so all of the
axes and tick formatting tricks we’ve learned are applicable. The
colorbar has some interesting flexibility: for example, we can narrow
the color limits and indicate the out-of-bounds values with a triangular
arrow at the top and bottom by setting the <code class="docutils literal notranslate"><span class="pre">extend</span></code> property. This
might come in handy, for example, if displaying an image that is subject
to noise:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># make noise in 1% of the image pixels</span>
<span class="n">speckles</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">I</span><span class="p">[</span><span class="n">speckles</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">speckles</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_163_0.png" src="_images/matplotlib_163_0.png" />
<p>Notice that in the left panel, the default color limits respond to the
noisy pixels, and the range of the noise completely washes-out the
pattern we are interested in. In the right panel, we manually set the
color limits, and add extensions to indicate values which are above or
below those limits. The result is a much more useful visualization of
our data.</p>
</div>
<div class="section" id="discrete-color-bars">
<h4>Discrete Color Bars<a class="headerlink" href="#discrete-color-bars" title="Permalink to this headline">¶</a></h4>
<p>Colormaps are by default continuous, but sometimes you’d like to
represent discrete values. The easiest way to do this is to use the
<code class="docutils literal notranslate"><span class="pre">plt.cm.get_cmap()</span></code> function, and pass the name of a suitable colormap
along with the number of desired bins:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_166_0.png" src="_images/matplotlib_166_0.png" />
</div>
</div>
<div class="section" id="example-handwritten-digits">
<h3>Example: Handwritten Digits<a class="headerlink" href="#example-handwritten-digits" title="Permalink to this headline">¶</a></h3>
<p>For an example of where this might be useful, let’s look at an
interesting visualization of some hand written digits data. This data is
included in Scikit-Learn, and consists of nearly 2,000
<span class="math notranslate nohighlight">\(8 \times 8\)</span> thumbnails showing various hand-written digits.</p>
<p>For now, let’s start by downloading the digits data and visualizing
several of the example images with <code class="docutils literal notranslate"><span class="pre">plt.imshow()</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load images of the digits 0 through 5 and visualize several of them</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_digits</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">(</span><span class="n">n_class</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">axi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xticks</span><span class="o">=</span><span class="p">[],</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
</pre></div>
</div>
<img alt="_images/matplotlib_169_0.png" src="_images/matplotlib_169_0.png" />
<p>Because each digit is defined by the hue of its 64 pixels, we can
consider each digit to be a point lying in 64-dimensional space: each
dimension represents the brightness of one pixel. But visualizing
relationships in such high-dimensional spaces can be extremely
difficult. One way to approach this is to use a <em>dimensionality
reduction</em> technique such as manifold learning to reduce the
dimensionality of the data while maintaining the relationships of
interest.</p>
<p>Deferring the discussion of these details, let’s take a look at a
two-dimensional manifold learning projection of this digits data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># project the digits into 2 dimensions using IsoMap</span>
<span class="kn">from</span> <span class="nn">sklearn.manifold</span> <span class="kn">import</span> <span class="n">Isomap</span>
<span class="n">iso</span> <span class="o">=</span> <span class="n">Isomap</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">iso</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>We’ll use our discrete colormap to view the results, setting the
<code class="docutils literal notranslate"><span class="pre">ticks</span></code> and <code class="docutils literal notranslate"><span class="pre">clim</span></code> to improve the aesthetics of the resulting
colorbar:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">projection</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projection</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="n">digits</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;cubehelix&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;digit value&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_174_0.png" src="_images/matplotlib_174_0.png" />
<p>The projection also gives us some interesting insights on the
relationships within the dataset: for example, the ranges of 5 and 3
nearly overlap in this projection, indicating that some hand written
fives and threes are difficult to distinguish, and therefore more likely
to be confused by an automated classification algorithm. Other values,
like 0 and 1, are more distantly separated, and therefore much less
likely to be confused. This observation agrees with our intuition,
because 5 and 3 look much more similar than do 0 and 1.</p>
</div>
</div>
<div class="section" id="multiple-subplots">
<h2>Multiple Subplots<a class="headerlink" href="#multiple-subplots" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is helpful to compare different views of data side by side.
To this end, Matplotlib has the concept of <em>subplots</em>: groups of smaller
axes that can exist together within a single figure. These subplots
might be insets, grids of plots, or other more complicated layouts. In
this section we’ll explore four routines for creating subplots in
Matplotlib.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-white&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="section" id="plt-axes-subplots-by-hand">
<h3><code class="docutils literal notranslate"><span class="pre">plt.axes</span></code>: Subplots by Hand<a class="headerlink" href="#plt-axes-subplots-by-hand" title="Permalink to this headline">¶</a></h3>
<p>The most basic method of creating an axes is to use the <code class="docutils literal notranslate"><span class="pre">plt.axes</span></code>
function. As we’ve seen previously, by default this creates a standard
axes object that fills the entire figure. <code class="docutils literal notranslate"><span class="pre">plt.axes</span></code> also takes an
optional argument that is a list of four numbers in the figure
coordinate system. These numbers represent
<code class="docutils literal notranslate"><span class="pre">[left,</span> <span class="pre">bottom,</span> <span class="pre">width,</span> <span class="pre">height]</span></code> in the figure coordinate system, which
ranges from 0 at the bottom left of the figure to 1 at the top right of
the figure.</p>
<p>For example, we might create an inset axes at the top-right corner of
another axes by setting the <em>x</em> and <em>y</em> position to 0.65 (that is,
starting at 65% of the width and 65% of the height of the figure) and
the <em>x</em> and <em>y</em> extents to 0.2 (that is, the size of the axes is 20% of
the width and 20% of the height of the figure):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>  <span class="c1"># standard axes</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">([</span><span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.65</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>
</pre></div>
</div>
<img alt="_images/matplotlib_180_0.png" src="_images/matplotlib_180_0.png" />
<p>The equivalent of this command within the object-oriented interface is
<code class="docutils literal notranslate"><span class="pre">fig.add_axes()</span></code>. Let’s use this to create two vertically stacked
axes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
                   <span class="n">xticklabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span>
                   <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_182_0.png" src="_images/matplotlib_182_0.png" />
</div>
<div class="section" id="plt-subplot-simple-grids-of-subplots">
<h3><code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code>: Simple Grids of Subplots<a class="headerlink" href="#plt-subplot-simple-grids-of-subplots" title="Permalink to this headline">¶</a></h3>
<p>Aligned columns or rows of subplots are a common-enough need that
Matplotlib has several convenience routines that make them easy to
create. The lowest level of these is <code class="docutils literal notranslate"><span class="pre">plt.subplot()</span></code>, which creates a
single subplot within a grid. As you can see, this command takes three
integer arguments—the number of rows, the number of columns, and the
index of the plot to be created in this scheme, which runs from the
upper left to the bottom right:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)),</span>
             <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_184_0.png" src="_images/matplotlib_184_0.png" />
<p>The command <code class="docutils literal notranslate"><span class="pre">plt.subplots_adjust</span></code> can be used to adjust the spacing
between these plots. The following code uses the equivalent
object-oriented command, <code class="docutils literal notranslate"><span class="pre">fig.add_subplot()</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="p">)),</span>
           <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_186_0.png" src="_images/matplotlib_186_0.png" />
<p>We’ve used the <code class="docutils literal notranslate"><span class="pre">hspace</span></code> and <code class="docutils literal notranslate"><span class="pre">wspace</span></code> arguments of
<code class="docutils literal notranslate"><span class="pre">plt.subplots_adjust</span></code>, which specify the spacing along the height and
width of the figure, in units of the subplot size (in this case, the
space is 40% of the subplot width and height).</p>
</div>
<div class="section" id="plt-subplots-the-whole-grid-in-one-go">
<h3><code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code>: The Whole Grid in One Go<a class="headerlink" href="#plt-subplots-the-whole-grid-in-one-go" title="Permalink to this headline">¶</a></h3>
<p>The approach just described can become quite tedious when creating a
large grid of subplots, especially if you’d like to hide the x- and
y-axis labels on the inner plots. For this purpose, <code class="docutils literal notranslate"><span class="pre">plt.subplots()</span></code>
is the easier tool to use (note the <code class="docutils literal notranslate"><span class="pre">s</span></code> at the end of <code class="docutils literal notranslate"><span class="pre">subplots</span></code>).
Rather than creating a single subplot, this function creates a full grid
of subplots in a single line, returning them in a NumPy array. The
arguments are the number of rows and number of columns, along with
optional keywords <code class="docutils literal notranslate"><span class="pre">sharex</span></code> and <code class="docutils literal notranslate"><span class="pre">sharey</span></code>, which allow you to specify
the relationships between different axes.</p>
<p>Here we’ll create a <span class="math notranslate nohighlight">\(2 \times 3\)</span> grid of subplots, where all axes
in the same row share their y-axis scale, and all axes in the same
column share their x-axis scale:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_190_0.png" src="_images/matplotlib_190_0.png" />
<p>Note that by specifying <code class="docutils literal notranslate"><span class="pre">sharex</span></code> and <code class="docutils literal notranslate"><span class="pre">sharey</span></code>, we’ve automatically
removed inner labels on the grid to make the plot cleaner. The resulting
grid of axes instances is returned within a NumPy array, allowing for
convenient specification of the desired axes using standard array
indexing notation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># axes are in a two-dimensional array, indexed by [row, col]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">str</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)),</span>
                      <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_192_0.png" src="_images/matplotlib_192_0.png" />
</div>
<div class="section" id="plt-gridspec-more-complicated-arrangements">
<h3><code class="docutils literal notranslate"><span class="pre">plt.GridSpec</span></code>: More Complicated Arrangements<a class="headerlink" href="#plt-gridspec-more-complicated-arrangements" title="Permalink to this headline">¶</a></h3>
<p>To go beyond a regular grid to subplots that span multiple rows and
columns, <code class="docutils literal notranslate"><span class="pre">plt.GridSpec()</span></code> is the best tool. The <code class="docutils literal notranslate"><span class="pre">plt.GridSpec()</span></code>
object does not create a plot by itself; it is simply a convenient
interface that is recognized by the <code class="docutils literal notranslate"><span class="pre">plt.subplot()</span></code> command. For
example, a gridspec for a grid of two rows and three columns with some
specified width and height space looks like this:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
<p>From this we can specify subplot locations and extents using the
familiary Python slicing syntax:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_196_0.png" src="_images/matplotlib_196_0.png" />
<p>This type of flexible grid alignment has a wide range of uses. I most
often use it when creating multi-axes histogram plots like the ones
shown here:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create some normally distributed data</span>
<span class="n">mean</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">cov</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">cov</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="c1"># Set up the axes with gridspec</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">main_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
<span class="n">y_hist</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">xticklabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">sharey</span><span class="o">=</span><span class="n">main_ax</span><span class="p">)</span>
<span class="n">x_hist</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">grid</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:],</span> <span class="n">yticklabels</span><span class="o">=</span><span class="p">[],</span> <span class="n">sharex</span><span class="o">=</span><span class="n">main_ax</span><span class="p">)</span>
<span class="c1"># scatter points on the main axes</span>
<span class="n">main_ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ok&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="c1"># histogram on the attached axes</span>
<span class="n">x_hist</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">x_hist</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">y_hist</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;stepfilled&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">y_hist</span><span class="o">.</span><span class="n">invert_xaxis</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_198_0.png" src="_images/matplotlib_198_0.png" />
</div>
</div>
<div class="section" id="text-and-annotation">
<h2>Text and Annotation<a class="headerlink" href="#text-and-annotation" title="Permalink to this headline">¶</a></h2>
<p>Creating a good visualization involves guiding the reader so that the
figure tells a story. In some cases, this story can be told in an
entirely visual manner, without the need for added text, but in others,
small textual cues and labels are necessary. Perhaps the most basic
types of annotations you will use are axes labels and titles, but the
options go beyond this. Let’s take a look at some data and how we might
visualize and annotate it to help convey interesting information. We’ll
start by setting up the notebook for plotting and importing the
functions we will use:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-whitegrid&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<div class="section" id="example-effect-of-holidays-on-us-births">
<h3>Example: Effect of Holidays on US Births<a class="headerlink" href="#example-effect-of-holidays-on-us-births" title="Permalink to this headline">¶</a></h3>
<p>Let’s return to some data we worked with earler, in <a class="reference external" href="03.09-Pivot-Tables.ipynb#Example:-Birthrate-Data">“Example: Birthrate
Data”</a>, where we
generated a plot of average births over the course of the calendar year;
as already mentioned, that this data can be downloaded at
<a class="reference external" href="https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv">https://raw.githubusercontent.com/jakevdp/data-CDCbirths/master/births.csv</a>.</p>
<p>We’ll start with the same cleaning procedure we used there, and plot the
results:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="n">births</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/births.csv&#39;</span><span class="p">)</span>

<span class="n">quartiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">births</span><span class="p">[</span><span class="s1">&#39;births&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">quartiles</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.74</span> <span class="o">*</span> <span class="p">(</span><span class="n">quartiles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">quartiles</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">births</span> <span class="o">=</span> <span class="n">births</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;(births &gt; @mu - 5 * @sig) &amp; (births &lt; @mu + 5 * @sig)&#39;</span><span class="p">)</span>
<span class="n">births</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">births</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">births</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="mi">10000</span> <span class="o">*</span> <span class="n">births</span><span class="o">.</span><span class="n">year</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">births</span><span class="o">.</span><span class="n">month</span> <span class="o">+</span> <span class="n">births</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">births_by_date</span> <span class="o">=</span> <span class="n">births</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="s1">&#39;births&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">births</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="p">,</span> <span class="n">births</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span><span class="p">])</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">)</span> <span class="ow">in</span> <span class="n">births_by_date</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_203_0.png" src="_images/matplotlib_203_0.png" />
<p>When we’re communicating data like this, it is often useful to annotate
certain features of the plot to draw the reader’s attention. This can be
done manually with the <code class="docutils literal notranslate"><span class="pre">plt.text</span></code>/<code class="docutils literal notranslate"><span class="pre">ax.text</span></code> command, which will
place text at a particular x/y value:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Add labels to the plot</span>
<span class="n">style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-1-1&#39;</span><span class="p">,</span> <span class="mi">3950</span><span class="p">,</span> <span class="s2">&quot;New Year&#39;s Day&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-7-4&#39;</span><span class="p">,</span> <span class="mi">4250</span><span class="p">,</span> <span class="s2">&quot;Independence Day&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-9-4&#39;</span><span class="p">,</span> <span class="mi">4850</span><span class="p">,</span> <span class="s2">&quot;Labor Day&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-10-31&#39;</span><span class="p">,</span> <span class="mi">4600</span><span class="p">,</span> <span class="s2">&quot;Halloween&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-11-25&#39;</span><span class="p">,</span> <span class="mi">4450</span><span class="p">,</span> <span class="s2">&quot;Thanksgiving&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="s1">&#39;2012-12-25&#39;</span><span class="p">,</span> <span class="mi">3850</span><span class="p">,</span> <span class="s2">&quot;Christmas &quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">style</span><span class="p">)</span>

<span class="c1"># Label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;USA births by day of year (1969-1988)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;average daily births&#39;</span><span class="p">)</span>

<span class="c1"># Format the x axis with centered month labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonthday</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%h&#39;</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_205_0.png" src="_images/matplotlib_205_0.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">ax.text</span></code> method takes an x position, a y position, a string, and
then optional keywords specifying the color, size, style, alignment, and
other properties of the text. Here we used <code class="docutils literal notranslate"><span class="pre">ha='right'</span></code> and
<code class="docutils literal notranslate"><span class="pre">ha='center'</span></code>, where <code class="docutils literal notranslate"><span class="pre">ha</span></code> is short for <em>horizonal alignment</em>. See
the docstring of <code class="docutils literal notranslate"><span class="pre">plt.text()</span></code> and of <code class="docutils literal notranslate"><span class="pre">mpl.text.Text()</span></code> for more
information on available options.</p>
</div>
<div class="section" id="transforms-and-text-position">
<h3>Transforms and Text Position<a class="headerlink" href="#transforms-and-text-position" title="Permalink to this headline">¶</a></h3>
<p>In the previous example, we have anchored our text annotations to data
locations. Sometimes it’s preferable to anchor the text to a position on
the axes or figure, independent of the data. In Matplotlib, this is done
by modifying the <em>transform</em>.</p>
<p>Any graphics display framework needs some scheme for translating between
coordinate systems. For example, a data point at <span class="math notranslate nohighlight">\((x, y) = (1, 1)\)</span>
needs to somehow be represented at a certain location on the figure,
which in turn needs to be represented in pixels on the screen.
Mathematically, such coordinate transformations are relatively
straightforward, and Matplotlib has a well-developed set of tools that
it uses internally to perform them (these tools can be explored in the
<code class="docutils literal notranslate"><span class="pre">matplotlib.transforms</span></code> submodule).</p>
<p>The average user rarely needs to worry about the details of these
transforms, but it is helpful knowledge to have when considering the
placement of text on a figure. There are three pre-defined transforms
that can be useful in this situation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax.transData</span></code>: Transform associated with data coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax.transAxes</span></code>: Transform associated with the axes (in units of
axes dimensions)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fig.transFigure</span></code>: Transform associated with the figure (in units
of figure dimensions)</p></li>
</ul>
<p>Here let’s look at an example of drawing text at various locations using
these transforms:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="c1"># transform=ax.transData is the default, but we&#39;ll specify it anyway</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;. Data: (1, 5)&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transData</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;. Axes: (0.5, 0.1)&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;. Figure: (0.2, 0.2)&quot;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">fig</span><span class="o">.</span><span class="n">transFigure</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_209_0.png" src="_images/matplotlib_209_0.png" />
<p>Note that by default, the text is aligned above and to the left of the
specified coordinates: here the “.” at the beginning of each string will
approximately mark the given coordinate location.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">transData</span></code> coordinates give the usual data coordinates associated
with the x- and y-axis labels. The <code class="docutils literal notranslate"><span class="pre">transAxes</span></code> coordinates give the
location from the bottom-left corner of the axes (here the white box),
as a fraction of the axes size. The <code class="docutils literal notranslate"><span class="pre">transFigure</span></code> coordinates are
similar, but specify the position from the bottom-left of the figure
(here the gray box), as a fraction of the figure size.</p>
<p>Notice now that if we change the axes limits, it is only the
<code class="docutils literal notranslate"><span class="pre">transData</span></code> coordinates that will be affected, while the others remain
stationary:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_212_0.png" src="_images/matplotlib_212_0.png" />
<p>This behavior can be seen more clearly by changing the axes limits
interactively: if you are executing this code in a notebook, you can
make that happen by changing <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> to
<code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code> and using each plot’s menu to interact with the
plot.</p>
</div>
<div class="section" id="arrows-and-annotation">
<h3>Arrows and Annotation<a class="headerlink" href="#arrows-and-annotation" title="Permalink to this headline">¶</a></h3>
<p>Along with tick marks and text, another useful annotation mark is the
simple arrow.</p>
<p>Drawing arrows in Matplotlib is often much harder than you’d bargain
for. While there is a <code class="docutils literal notranslate"><span class="pre">plt.arrow()</span></code> function available, I wouldn’t
suggest using it: the arrows it creates are SVG objects that will be
subject to the varying aspect ratio of your plots, and the result is
rarely what the user intended. Instead, I’d suggest using the
<code class="docutils literal notranslate"><span class="pre">plt.annotate()</span></code> function. This function creates some text and an
arrow, and the arrows can be very flexibly specified.</p>
<p>Here we’ll use <code class="docutils literal notranslate"><span class="pre">annotate</span></code> with several of its options:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;local maximum&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mf">6.28</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;local minimum&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;angle3,angleA=0,angleB=-90&quot;</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_216_0.png" src="_images/matplotlib_216_0.png" />
<p>The arrow style is controlled through the <code class="docutils literal notranslate"><span class="pre">arrowprops</span></code> dictionary,
which has numerous options available. These options are fairly
well-documented in Matplotlib’s online documentation, so rather than
repeating them here it is probably more useful to quickly show some of
the possibilities. Let’s demonstrate several of the possible options
using the birthrate plot from before:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">births_by_date</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="c1"># Add labels to the plot</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;New Year&#39;s Day&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-1-1&#39;</span><span class="p">,</span> <span class="mi">4100</span><span class="p">),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;arc3,rad=-0.2&quot;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s2">&quot;Independence Day&quot;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-7-4&#39;</span><span class="p">,</span> <span class="mi">4250</span><span class="p">),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Labor Day&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-9-4&#39;</span><span class="p">,</span> <span class="mi">4850</span><span class="p">),</span> <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-9-1&#39;</span><span class="p">,</span> <span class="mi">4850</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-9-7&#39;</span><span class="p">,</span> <span class="mi">4850</span><span class="p">),</span>
            <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">:</span> <span class="s1">&#39;|-|,widthA=0.2,widthB=0.2&#39;</span><span class="p">,</span> <span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Halloween&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-10-31&#39;</span><span class="p">,</span> <span class="mi">4600</span><span class="p">),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;fancy&quot;</span><span class="p">,</span>
                            <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;0.6&quot;</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;angle3,angleA=0,angleB=-90&quot;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Thanksgiving&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-11-25&#39;</span><span class="p">,</span> <span class="mi">4500</span><span class="p">),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
            <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round4,pad=.5&quot;</span><span class="p">,</span> <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;0.9&quot;</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span>
                            <span class="n">connectionstyle</span><span class="o">=</span><span class="s2">&quot;angle,angleA=0,angleB=80,rad=20&quot;</span><span class="p">))</span>


<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;Christmas&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2012-12-25&#39;</span><span class="p">,</span> <span class="mi">3850</span><span class="p">),</span>  <span class="n">xycoords</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">,</span>
             <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
             <span class="n">size</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
             <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s2">&quot;round&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">),</span>
             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">arrowstyle</span><span class="o">=</span><span class="s2">&quot;wedge,tail_width=0.5&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">));</span>

<span class="c1"># Label the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;USA births by day of year (1969-1988)&#39;</span><span class="p">,</span>
       <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;average daily births&#39;</span><span class="p">)</span>

<span class="c1"># Format the x axis with centered month labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">MonthLocator</span><span class="p">(</span><span class="n">bymonthday</span><span class="o">=</span><span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">dates</span><span class="o">.</span><span class="n">DateFormatter</span><span class="p">(</span><span class="s1">&#39;%h&#39;</span><span class="p">));</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">3600</span><span class="p">,</span> <span class="mi">5400</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_218_0.png" src="_images/matplotlib_218_0.png" />
</div>
</div>
<div class="section" id="customizing-ticks">
<h2>Customizing Ticks<a class="headerlink" href="#customizing-ticks" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib’s default tick locators and formatters are designed to be
generally sufficient in many common situations, but are in no way
optimal for every plot. This section will give several examples of
adjusting the tick locations and formatting for the particular plot type
you’re interested in.</p>
<p>Before we go into examples, it will be best for us to understand further
the object hierarchy of Matplotlib plots. Matplotlib aims to have a
Python object representing everything that appears on the plot: for
example, recall that the <code class="docutils literal notranslate"><span class="pre">figure</span></code> is the bounding box within which
plot elements appear. Each Matplotlib object can also act as a container
of sub-objects: for example, each <code class="docutils literal notranslate"><span class="pre">figure</span></code> can contain one or more
<code class="docutils literal notranslate"><span class="pre">axes</span></code> objects, each of which in turn contain other objects
representing plot contents.</p>
<p>The tick marks are no exception. Each <code class="docutils literal notranslate"><span class="pre">axes</span></code> has attributes <code class="docutils literal notranslate"><span class="pre">xaxis</span></code>
and <code class="docutils literal notranslate"><span class="pre">yaxis</span></code>, which in turn have attributes that contain all the
properties of the lines, ticks, and labels that make up the axes.</p>
<div class="section" id="major-and-minor-ticks">
<h3>Major and Minor Ticks<a class="headerlink" href="#major-and-minor-ticks" title="Permalink to this headline">¶</a></h3>
<p>Within each axis, there is the concept of a <em>major</em> tick mark, and a
<em>minor</em> tick mark. As the names would imply, major ticks are usually
bigger or more pronounced, while minor ticks are usually smaller. By
default, Matplotlib rarely makes use of minor ticks, but one place you
can see them is within logarithmic plots:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_222_0.png" src="_images/matplotlib_222_0.png" />
<p>We see here that each major tick shows a large tickmark and a label,
while each minor tick shows a smaller tickmark with no label.</p>
<p>These tick properties—locations and labels—that is, can be customized by
setting the <code class="docutils literal notranslate"><span class="pre">formatter</span></code> and <code class="docutils literal notranslate"><span class="pre">locator</span></code> objects of each axis. Let’s
examine these for the x axis of the just shown plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_locator</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_minor_locator</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7ff2b92625f8</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogLocator</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7ff2b92627f0</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_minor_formatter</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7ff2b9262828</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">LogFormatterSciNotation</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7ff2b9258c88</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>We see that both major and minor tick labels have their locations
specified by a <code class="docutils literal notranslate"><span class="pre">LogLocator</span></code> (which makes sense for a logarithmic
plot). Minor ticks, though, have their labels formatted by a
<code class="docutils literal notranslate"><span class="pre">NullFormatter</span></code>: this says that no labels will be shown.</p>
</div>
<div class="section" id="hiding-ticks-or-labels">
<h3>Hiding Ticks or Labels<a class="headerlink" href="#hiding-ticks-or-labels" title="Permalink to this headline">¶</a></h3>
<p>Perhaps the most common tick/label formatting operation is the act of
hiding ticks or labels. This can be done using <code class="docutils literal notranslate"><span class="pre">plt.NullLocator()</span></code> and
<code class="docutils literal notranslate"><span class="pre">plt.NullFormatter()</span></code>, as shown here:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullFormatter</span><span class="p">())</span>
</pre></div>
</div>
<img alt="_images/matplotlib_229_0.png" src="_images/matplotlib_229_0.png" />
<p>Notice that we’ve removed the labels (but kept the ticks/gridlines) from
the x axis, and removed the ticks (and thus the labels as well) from the
y axis. Having no ticks at all can be useful in many situations—for
example, when you want to show a grid of images. For instance, consider
the following figure, which includes images of different faces, an
example often used in supervised machine learning problems:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Get some face data from scikit-learn</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_olivetti_faces</span>
<span class="n">faces</span> <span class="o">=</span> <span class="n">fetch_olivetti_faces</span><span class="p">()</span><span class="o">.</span><span class="n">images</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">faces</span><span class="p">[</span><span class="mi">10</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;bone&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">downloading</span> <span class="n">Olivetti</span> <span class="n">faces</span> <span class="kn">from</span> <span class="nn">https</span><span class="p">:</span><span class="o">//</span><span class="n">ndownloader</span><span class="o">.</span><span class="n">figshare</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">files</span><span class="o">/</span><span class="mi">5976027</span> <span class="n">to</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mn</span><span class="o">/</span><span class="n">scikit_learn_data</span>
</pre></div>
</div>
<img alt="_images/matplotlib_231_1.png" src="_images/matplotlib_231_1.png" />
</div>
<div class="section" id="reducing-or-increasing-the-number-of-ticks">
<h3>Reducing or Increasing the Number of Ticks<a class="headerlink" href="#reducing-or-increasing-the-number-of-ticks" title="Permalink to this headline">¶</a></h3>
<p>One common problem with the default settings is that smaller subplots
can end up with crowded labels. We can see this in the plot grid shown
here:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_233_0.png" src="_images/matplotlib_233_0.png" />
<p>Particularly for the x ticks, the numbers nearly overlap and make them
quite difficult to decipher. We can fix this with the
<code class="docutils literal notranslate"><span class="pre">plt.MaxNLocator()</span></code>, which allows us to specify the maximum number of
ticks that will be displayed. Given this maximum number, Matplotlib will
use internal logic to choose the particular tick locations:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For every axis, set the x and y major locator</span>
<span class="k">for</span> <span class="n">axi</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">flat</span><span class="p">:</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">axi</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_235_0.png" src="_images/matplotlib_235_0.png" />
</div>
<div class="section" id="fancy-tick-formats">
<h3>Fancy Tick Formats<a class="headerlink" href="#fancy-tick-formats" title="Permalink to this headline">¶</a></h3>
<p>Matplotlib’s default tick formatting can leave a lot to be desired: it
works well as a broad default, but sometimes you’d like do do something
more. Consider this plot of a sine and a cosine:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot a sine and cosine curve</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sine&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Cosine&#39;</span><span class="p">)</span>

<span class="c1"># Set up grid, legend, and limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_237_0.png" src="_images/matplotlib_237_0.png" />
<p>There are a couple changes we might like to make. First, it’s more
natural for this data to space the ticks and grid lines in multiples of
<span class="math notranslate nohighlight">\(\pi\)</span>. We can do this by setting a <code class="docutils literal notranslate"><span class="pre">MultipleLocator</span></code>, which
locates ticks at a multiple of the number you provide. For good measure,
we’ll add both major and minor ticks in multiples of <span class="math notranslate nohighlight">\(\pi/4\)</span>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_239_0.png" src="_images/matplotlib_239_0.png" />
<p>But now these tick labels look a little bit silly: we can see that they
are multiples of <span class="math notranslate nohighlight">\(\pi\)</span>, but the decimal representation does not
immediately convey this. To fix this, we can change the tick formatter.
There’s no built-in formatter for what we want to do, so we’ll instead
use <code class="docutils literal notranslate"><span class="pre">plt.FuncFormatter</span></code>, which accepts a user-defined function giving
fine-grained control over the tick outputs:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">format_func</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">tick_number</span><span class="p">):</span>
    <span class="c1"># find number of multiples of pi/2</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">value</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;0&quot;</span>
    <span class="k">elif</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;$\pi/2$&quot;</span>
    <span class="k">elif</span> <span class="n">N</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;$\pi$&quot;</span>
    <span class="k">elif</span> <span class="n">N</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;$</span><span class="si">{0}</span><span class="s2">\pi/2$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">r</span><span class="s2">&quot;$</span><span class="si">{0}</span><span class="s2">\pi$&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">N</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">format_func</span><span class="p">))</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_241_0.png" src="_images/matplotlib_241_0.png" />
</div>
<div class="section" id="summary-of-formatters-and-locators">
<h3>Summary of Formatters and Locators<a class="headerlink" href="#summary-of-formatters-and-locators" title="Permalink to this headline">¶</a></h3>
<p>We’ve mentioned a couple of the available formatters and locators. We’ll
conclude this section by briefly listing all the built-in locator and
formatter options. For more information on any of these, refer to the
docstrings or to the Matplotlib online documentaion. Each of the
following is available in the <code class="docutils literal notranslate"><span class="pre">plt</span></code> namespace:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Locator class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NullLocator</span></code></p></td>
<td><p>No ticks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FixedLocator</span></code></p></td>
<td><p>Tick locations are fixed</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">IndexLocator</span></code></p></td>
<td><p>Locator for index plots (e.g., where x =
range(len(y)))</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">LinearLocator</span></code></p></td>
<td><p>Evenly spaced ticks from min to max</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LogLocator</span></code></p></td>
<td><p>Logarithmically ticks from min to max</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">MultipleLocator</span></code></p></td>
<td><p>Ticks and range are a multiple of base</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MaxNLocator</span></code></p></td>
<td><p>Finds up to a max number of ticks at nice
locations</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">AutoLocator</span></code></p></td>
<td><p>(Default.) MaxNLocator with simple defaults.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">AutoMinorLocator</span></code></p></td>
<td><p>Locator for minor ticks</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Formatter Class</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">NullFormatter</span></code></p></td>
<td><p>No labels on the ticks</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">IndexFormatter</span></code></p></td>
<td><p>Set the strings from a list of labels</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FixedFormatter</span></code></p></td>
<td><p>Set the strings manually for the labels</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">FuncFormatter</span></code></p></td>
<td><p>User-defined function sets the labels</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">FormatStrFormatter</span></code></p></td>
<td><p>Use a format string for each value</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ScalarFormatter</span></code></p></td>
<td><p>(Default.) Formatter for scalar values</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">LogFormatter</span></code></p></td>
<td><p>Default formatter for log axes</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="customizing-matplotlib-configurations-and-stylesheets">
<h2>Customizing Matplotlib: Configurations and Stylesheets<a class="headerlink" href="#customizing-matplotlib-configurations-and-stylesheets" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib’s default plot settings are often the subject of complaint
among its users. While much is slated to change in the 2.0 Matplotlib
release in late 2016, the ability to customize default settings helps
bring the package inline with your own aesthetic preferences.</p>
<p>Here we’ll walk through some of Matplotlib’s runtime configuration (rc)
options, and take a look at the newer <em>stylesheets</em> feature, which
contains some nice sets of default configurations.</p>
<div class="section" id="plot-customization-by-hand">
<h3>Plot Customization by Hand<a class="headerlink" href="#plot-customization-by-hand" title="Permalink to this headline">¶</a></h3>
<p>Through this chapter, we’ve seen how it is possible to tweak individual
plot settings to end up with something that looks a little bit nicer
than the default. It’s possible to do these customizations for each
individual plot. For example, here is a fairly drab default histogram:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_247_0.png" src="_images/matplotlib_247_0.png" />
<p>We can adjust this by hand to make it a much more visually pleasing
plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use a gray background</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axisbelow</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># draw solid white grid lines</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>

<span class="c1"># hide axis spines</span>
<span class="k">for</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
    <span class="n">spine</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># hide top and right ticks</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">tick_bottom</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">tick_left</span><span class="p">()</span>

<span class="c1"># lighten ticks and labels</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">():</span>
    <span class="n">tick</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># control face and edge color of histogram</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;#E6E6E6&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#EE6666&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_249_0.png" src="_images/matplotlib_249_0.png" />
</div>
<div class="section" id="changing-the-defaults-rcparams">
<h3>Changing the Defaults: <code class="docutils literal notranslate"><span class="pre">rcParams</span></code><a class="headerlink" href="#changing-the-defaults-rcparams" title="Permalink to this headline">¶</a></h3>
<p>Each time Matplotlib loads, it defines a runtime configuration (rc)
containing the default styles for every plot element you create. This
configuration can be adjusted at any time using the <code class="docutils literal notranslate"><span class="pre">plt.rc</span></code>
convenience routine. Let’s see what it looks like to modify the rc
parameters so that our default plot will look similar to what we did
before.</p>
<p>We’ll start by saving a copy of the current <code class="docutils literal notranslate"><span class="pre">rcParams</span></code> dictionary, so
we can easily reset these changes in the current session:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">IPython_default</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we can use the <code class="docutils literal notranslate"><span class="pre">plt.rc</span></code> function to change some of these settings:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cycler</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span>
                <span class="p">[</span><span class="s1">&#39;#EE6666&#39;</span><span class="p">,</span> <span class="s1">&#39;#3388BB&#39;</span><span class="p">,</span> <span class="s1">&#39;#9988DD&#39;</span><span class="p">,</span>
                 <span class="s1">&#39;#EECC55&#39;</span><span class="p">,</span> <span class="s1">&#39;#88BB44&#39;</span><span class="p">,</span> <span class="s1">&#39;#FFBBBB&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;#E6E6E6&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
       <span class="n">axisbelow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">prop_cycle</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;grid&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;solid&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;xtick&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;ytick&#39;</span><span class="p">,</span> <span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;patch&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;#E6E6E6&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>With these settings defined, we can now create a plot and see our
settings in action:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_255_0.png" src="_images/matplotlib_255_0.png" />
<p>Let’s see what simple line plots look like with these rc parameters:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<img alt="_images/matplotlib_257_0.png" src="_images/matplotlib_257_0.png" />
</div>
<div class="section" id="stylesheets">
<h3>Stylesheets<a class="headerlink" href="#stylesheets" title="Permalink to this headline">¶</a></h3>
<p>The version 1.4 release of Matplotlib in August 2014 added a very
convenient <code class="docutils literal notranslate"><span class="pre">style</span></code> module, which includes a number of new default
stylesheets, as well as the ability to create and package your own
styles. These stylesheets are formatted similarly to the <em>.matplotlibrc</em>
files mentioned earlier, but must be named with a <em>.mplstyle</em> extension.</p>
<p>Even if you don’t create your own style, the stylesheets included by
default are extremely useful. The available styles are listed in
<code class="docutils literal notranslate"><span class="pre">plt.style.available</span></code>—here I’ll list only the first five for brevity:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;seaborn-poster&#39;</span><span class="p">,</span>
 <span class="s1">&#39;seaborn-muted&#39;</span><span class="p">,</span>
 <span class="s1">&#39;seaborn-dark-palette&#39;</span><span class="p">,</span>
 <span class="s1">&#39;seaborn-bright&#39;</span><span class="p">,</span>
 <span class="s1">&#39;seaborn-ticks&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The basic way to switch to a stylesheet is to call</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;stylename&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>But keep in mind that this will change the style for the rest of the
session! Alternatively, you can use the style context manager, which
sets a style temporarily:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;stylename&#39;</span><span class="p">):</span>
    <span class="n">make_a_plot</span><span class="p">()</span>
</pre></div>
</div>
<p>Let’s create a function that will make two basic types of plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hist_and_lines</span><span class="p">():</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="default-style">
<h4>Default style<a class="headerlink" href="#default-style" title="Permalink to this headline">¶</a></h4>
<p>The default style is what we’ve been seeing so far throughout the book;
we’ll start with that. First, let’s reset our runtime configuration to
the notebook default:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reset rcParams</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">IPython_default</span><span class="p">);</span>
</pre></div>
</div>
<p>Now let’s see how it looks:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hist_and_lines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_266_0.png" src="_images/matplotlib_266_0.png" />
</div>
<div class="section" id="fivethiryeight-style">
<h4>FiveThiryEight style<a class="headerlink" href="#fivethiryeight-style" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">fivethirtyeight</span></code> style mimics the graphics found on the popular
<a class="reference external" href="https://fivethirtyeight.com">FiveThirtyEight website</a>. As you can
see here, it is typified by bold colors, thick lines, and transparent
axes:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">):</span>
    <span class="n">hist_and_lines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_268_0.png" src="_images/matplotlib_268_0.png" />
</div>
<div class="section" id="ggplot">
<h4>ggplot<a class="headerlink" href="#ggplot" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> package in the R language is a very popular visualization
tool. Matplotlib’s <code class="docutils literal notranslate"><span class="pre">ggplot</span></code> style mimics the default styles from that
package:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">):</span>
    <span class="n">hist_and_lines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_270_0.png" src="_images/matplotlib_270_0.png" />
</div>
<div class="section" id="bayesian-methods-for-hackers-style">
<h4><em>Bayesian Methods for Hackers</em> style<a class="headerlink" href="#bayesian-methods-for-hackers-style" title="Permalink to this headline">¶</a></h4>
<p>There is a very nice short online book called <a class="reference external" href="http://camdavidsonpilon.github.io/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/">Probabilistic Programming
and Bayesian Methods for
Hackers</a>;
it features figures created with Matplotlib, and uses a nice set of rc
parameters to create a consistent and visually-appealing style
throughout the book. This style is reproduced in the <code class="docutils literal notranslate"><span class="pre">bmh</span></code> stylesheet:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="s1">&#39;bmh&#39;</span><span class="p">):</span>
    <span class="n">hist_and_lines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_272_0.png" src="_images/matplotlib_272_0.png" />
</div>
<div class="section" id="seaborn-style">
<h4>Seaborn style<a class="headerlink" href="#seaborn-style" title="Permalink to this headline">¶</a></h4>
<p>Matplotlib also has stylesheets inspired by the Seaborn library. As we
will see, these styles are loaded automatically when Seaborn is imported
into a notebook. I’ve found these settings to be very nice, and tend to
use them as defaults in my own data exploration.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span>
<span class="n">hist_and_lines</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/matplotlib_274_0.png" src="_images/matplotlib_274_0.png" />
</div>
</div>
</div>
<div class="section" id="three-dimensional-plotting-in-matplotlib">
<h2>Three-Dimensional Plotting in Matplotlib<a class="headerlink" href="#three-dimensional-plotting-in-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib was initially designed with only two-dimensional plotting in
mind. Around the time of the 1.0 release, some three-dimensional
plotting utilities were built on top of Matplotlib’s two-dimensional
display, and the result is a convenient (if somewhat limited) set of
tools for three-dimensional data visualization. three-dimensional plots
are enabled by importing the <code class="docutils literal notranslate"><span class="pre">mplot3d</span></code> toolkit, included with the main
Matplotlib installation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits</span> <span class="kn">import</span> <span class="n">mplot3d</span>
</pre></div>
</div>
<p>Once this submodule is imported, a three-dimensional axes can be created
by passing the keyword <code class="docutils literal notranslate"><span class="pre">projection='3d'</span></code> to any of the normal axes
creation routines:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_279_0.png" src="_images/matplotlib_279_0.png" />
<p>With this three-dimensional axes enabled, we can now plot a variety of
three-dimensional plot types. Three-dimensional plotting is one of the
functionalities that benefits immensely from viewing figures
interactively rather than statically in the notebook; recall that to use
interactive figures, you can use <code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">notebook</span></code> rather than
<code class="docutils literal notranslate"><span class="pre">%matplotlib</span> <span class="pre">inline</span></code> when running this code.</p>
<div class="section" id="three-dimensional-points-and-lines">
<h3>Three-dimensional Points and Lines<a class="headerlink" href="#three-dimensional-points-and-lines" title="Permalink to this headline">¶</a></h3>
<p>The most basic three-dimensional plot is a line or collection of scatter
plot created from sets of (x, y, z) triples. In analogy with the more
common two-dimensional plots discussed earlier, these can be created
using the <code class="docutils literal notranslate"><span class="pre">ax.plot3D</span></code> and <code class="docutils literal notranslate"><span class="pre">ax.scatter3D</span></code> functions. The call
signature for these is nearly identical to that of their two-dimensional
counterparts, so you can refer to <a class="reference external" href="04.01-Simple-Line-Plots.ipynb">Simple Line
Plots</a> and <a class="reference external" href="04.02-Simple-Scatter-Plots.ipynb">Simple Scatter
Plots</a> for more information on
controlling the output.</p>
<p>Here we’ll plot a trigonometric spiral, along with some points drawn
randomly near the line:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="c1"># Data for a three-dimensional line</span>
<span class="n">zline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">xline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">zline</span><span class="p">)</span>
<span class="n">yline</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zline</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot3D</span><span class="p">(</span><span class="n">xline</span><span class="p">,</span> <span class="n">yline</span><span class="p">,</span> <span class="n">zline</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="c1"># Data for three-dimensional scattered points</span>
<span class="n">zdata</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">xdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">zdata</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ydata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">zdata</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter3D</span><span class="p">(</span><span class="n">xdata</span><span class="p">,</span> <span class="n">ydata</span><span class="p">,</span> <span class="n">zdata</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">zdata</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greens&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_283_0.png" src="_images/matplotlib_283_0.png" />
</div>
<div class="section" id="three-dimensional-contour-plots">
<h3>Three-dimensional Contour Plots<a class="headerlink" href="#three-dimensional-contour-plots" title="Permalink to this headline">¶</a></h3>
<p>Analogous to the contour plots contains tools to create
three-dimensional relief plots using the same inputs. Like
two-dimensional <code class="docutils literal notranslate"><span class="pre">ax.contour</span></code> plots, <code class="docutils literal notranslate"><span class="pre">ax.contour3D</span></code> requires all the
input data to be in the form of two-dimensional regular grids, with the
Z data evaluated at each point. Here we’ll show a three-dimensional
contour diagram of a three-dimensional sinusoidal function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour3D</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;binary&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_286_0.png" src="_images/matplotlib_286_0.png" />
<p>Sometimes the default viewing angle is not optimal, in which case we can
use the <code class="docutils literal notranslate"><span class="pre">view_init</span></code> method to set the elevation and azimuthal angles.
In the following example, we’ll use an elevation of 60 degrees (that is,
60 degrees above the x-y plane) and an azimuth of 35 degrees (that is,
rotated 35 degrees counter-clockwise about the z-axis):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">35</span><span class="p">)</span>
<span class="n">fig</span>
</pre></div>
</div>
<img alt="_images/matplotlib_288_0.png" src="_images/matplotlib_288_0.png" />
</div>
<div class="section" id="wireframes-and-surface-plots">
<h3>Wireframes and Surface Plots<a class="headerlink" href="#wireframes-and-surface-plots" title="Permalink to this headline">¶</a></h3>
<p>Two other types of three-dimensional plots that work on gridded data are
wireframes and surface plots. These take a grid of values and project it
onto the specified three-dimensional surface, and can make the resulting
three-dimensional forms quite easy to visualize. Here’s an example of
using a wireframe:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;wireframe&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_290_0.png" src="_images/matplotlib_290_0.png" />
<p>A surface plot is like a wireframe plot, but each face of the wireframe
is a filled polygon. Adding a colormap to the filled polygons can aid
perception of the topology of the surface being visualized:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;surface&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_292_0.png" src="_images/matplotlib_292_0.png" />
<p>Note that though the grid of values for a surface plot needs to be
two-dimensional, it need not be rectilinear. Here is an example of
creating a partial polar grid, which when used with the <code class="docutils literal notranslate"><span class="pre">surface3D</span></code>
plot can give us a slice into the function we’re visualizing:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.9</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">r</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">rstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cstride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_294_0.png" src="_images/matplotlib_294_0.png" />
</div>
<div class="section" id="surface-triangulations">
<h3>Surface Triangulations<a class="headerlink" href="#surface-triangulations" title="Permalink to this headline">¶</a></h3>
<p>For some applications, the evenly sampled grids required by the above
routines is overly restrictive and inconvenient. In these situations,
the triangulation-based plots can be very useful. What if rather than an
even draw from a Cartesian or a polar grid, we instead have a set of
random draws?</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>We could create a scatter plot of the points to get an idea of the
surface we’re sampling from:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_298_0.png" src="_images/matplotlib_298_0.png" />
<p>This leaves a lot to be desired. The function that will help us in this
case is <code class="docutils literal notranslate"><span class="pre">ax.plot_trisurf</span></code>, which creates a surface by first finding a
set of triangles formed between adjacent points (remember that x, y, and
z here are one-dimensional arrays):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_300_0.png" src="_images/matplotlib_300_0.png" />
<div class="section" id="example-visualizing-a-mobius-strip">
<h4>Example: Visualizing a Möbius strip<a class="headerlink" href="#example-visualizing-a-mobius-strip" title="Permalink to this headline">¶</a></h4>
<p>A Möbius strip is similar to a strip of paper glued into a loop with a
half-twist. Topologically, it’s quite interesting because despite
appearances it has only a single side! Here we will visualize such an
object using Matplotlib’s three-dimensional tools. The key to creating
the Möbius strip is to think about it’s parametrization: it’s a
two-dimensional strip, so we need two intrinsic dimensions. Let’s call
them <span class="math notranslate nohighlight">\(\theta\)</span>, which ranges from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(2\pi\)</span> around
the loop, and <span class="math notranslate nohighlight">\(w\)</span> which ranges from -1 to 1 across the width of
the strip:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Now from this parametrization, we must determine the <em>(x, y, z)</em>
positions of the embedded strip.</p>
<p>Thinking about it, we might realize that there are two rotations
happening: one is the position of the loop about its center (what we’ve
called <span class="math notranslate nohighlight">\(\theta\)</span>), while the other is the twisting of the strip
about its axis (we’ll call this <span class="math notranslate nohighlight">\(\phi\)</span>). For a Möbius strip, we
must have the strip makes half a twist during a full loop, or
<span class="math notranslate nohighlight">\(\Delta\phi = \Delta\theta/2\)</span>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phi</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">theta</span>
</pre></div>
</div>
<p>Now we use our recollection of trigonometry to derive the
three-dimensional embedding. We’ll define <span class="math notranslate nohighlight">\(r\)</span>, the distance of
each point from the center, and use this to find the embedded
<span class="math notranslate nohighlight">\((x, y, z)\)</span> coordinates:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># radius in x-y plane</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, to plot the object, we must make sure the triangulation is
correct. The best way to do this is to define the triangulation <em>within
the underlying parametrization</em>, and then let Matplotlib project this
triangulation into the three-dimensional space of the Möbius strip. This
can be accomplished as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># triangulate in the underlying parametrization</span>
<span class="kn">from</span> <span class="nn">matplotlib.tri</span> <span class="kn">import</span> <span class="n">Triangulation</span>
<span class="n">tri</span> <span class="o">=</span> <span class="n">Triangulation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">axes</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">triangles</span><span class="o">=</span><span class="n">tri</span><span class="o">.</span><span class="n">triangles</span><span class="p">,</span>
                <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.2</span><span class="p">);</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_308_0.png" src="_images/matplotlib_308_0.png" />
</div>
</div>
</div>
<div class="section" id="visualization-with-seaborn">
<h2>Visualization with Seaborn<a class="headerlink" href="#visualization-with-seaborn" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib has proven to be an incredibly useful and popular
visualization tool, but even avid users will admit it often leaves much
to be desired. There are several valid complaints about Matplotlib that
often come up:</p>
<ul class="simple">
<li><p>Prior to version 2.0, Matplotlib’s defaults are not exactly the best
choices. It was based off of MATLAB circa 1999, and this often shows.</p></li>
<li><p>Matplotlib’s API is relatively low level. Doing sophisticated
statistical visualization is possible, but often requires a <em>lot</em> of
boilerplate code.</p></li>
<li><p>Matplotlib predated Pandas by more than a decade, and thus is not
designed for use with Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s. In order to visualize
data from a Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, you must extract each <code class="docutils literal notranslate"><span class="pre">Series</span></code>
and often concatenate them together into the right format. It would
be nicer to have a plotting library that can intelligently use the
<code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> labels in a plot.</p></li>
</ul>
<p>An answer to these problems is <a class="reference external" href="http://seaborn.pydata.org/">Seaborn</a>.
Seaborn provides an API on top of Matplotlib that offers sane choices
for plot style and color defaults, defines simple high-level functions
for common statistical plot types, and integrates with the functionality
provided by Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>s.</p>
<p>To be fair, the Matplotlib team is addressing this: it has recently
added the <code class="docutils literal notranslate"><span class="pre">plt.style</span></code> tools, and is starting to handle Pandas data
more seamlessly. The 2.0 release of the library will include a new
default stylesheet that will improve on the current status quo. But for
all the reasons just discussed, Seaborn remains an extremely useful
addon.</p>
<div class="section" id="seaborn-versus-matplotlib">
<h3>Seaborn Versus Matplotlib<a class="headerlink" href="#seaborn-versus-matplotlib" title="Permalink to this headline">¶</a></h3>
<p>Here is an example of a simple random-walk plot in Matplotlib, using its
classic plot formatting and colors. We start with the typical imports:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;classic&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
<p>Now we create some random walk data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create some data</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rng</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>And do a simple plot:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the data with Matplotlib defaults</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;ABCDEF&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_316_0.png" src="_images/matplotlib_316_0.png" />
<p>Although the result contains all the information we’d like it to convey,
it does so in a way that is not all that aesthetically pleasing, and
even looks a bit old-fashioned in the context of 21st-century data
visualization.</p>
<p>Now let’s take a look at how it works with Seaborn. As we will see,
Seaborn has many of its own high-level plotting routines, but it can
also overwrite Matplotlib’s default parameters and in turn get even
simple Matplotlib scripts to produce vastly superior output. We can set
the style by calling Seaborn’s <code class="docutils literal notranslate"><span class="pre">set()</span></code> method. By convention, Seaborn
is imported as <code class="docutils literal notranslate"><span class="pre">sns</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>
</div>
<p>Now let’s rerun the same two lines as before:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># same plotting code as above!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="s1">&#39;ABCDEF&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_320_0.png" src="_images/matplotlib_320_0.png" />
</div>
<div class="section" id="exploring-seaborn-plots">
<h3>Exploring Seaborn Plots<a class="headerlink" href="#exploring-seaborn-plots" title="Permalink to this headline">¶</a></h3>
<p>The main idea of Seaborn is that it provides high-level commands to
create a variety of plot types useful for statistical data exploration,
and even some statistical model fitting.</p>
<p>Let’s take a look at a few of the datasets and plot types available in
Seaborn. Note that all of the following <em>could</em> be done using raw
Matplotlib commands (this is, in fact, what Seaborn does under the hood)
but the Seaborn API is much more convenient.</p>
<div class="section" id="histograms-kde-and-densities">
<h4>Histograms, KDE, and densities<a class="headerlink" href="#histograms-kde-and-densities" title="Permalink to this headline">¶</a></h4>
<p>Often in statistical data visualization, all you want is to plot
histograms and joint distributions of variables. We have seen that this
is relatively straightforward in Matplotlib:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_323_0.png" src="_images/matplotlib_323_0.png" />
<p>Rather than a histogram, we can get a smooth estimate of the
distribution using a kernel density estimation, which Seaborn does with
<code class="docutils literal notranslate"><span class="pre">sns.kdeplot</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="s1">&#39;xy&#39;</span><span class="p">:</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_325_0.png" src="_images/matplotlib_325_0.png" />
<p>Histograms and KDE can be combined using <code class="docutils literal notranslate"><span class="pre">distplot</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_327_0.png" src="_images/matplotlib_327_0.png" />
<p>If we pass the full two-dimensional dataset to <code class="docutils literal notranslate"><span class="pre">kdeplot</span></code>, we will get
a two-dimensional visualization of the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">mn</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">working</span><span class="o">-</span><span class="n">copies</span><span class="o">/</span><span class="n">pythons</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">seaborn</span><span class="o">/</span><span class="n">distributions</span><span class="o">.</span><span class="n">py</span><span class="p">:</span><span class="mi">693</span><span class="p">:</span> <span class="ne">UserWarning</span><span class="p">:</span> <span class="n">Passing</span> <span class="n">a</span> <span class="mi">2</span><span class="n">D</span> <span class="n">dataset</span> <span class="k">for</span> <span class="n">a</span> <span class="n">bivariate</span> <span class="n">plot</span> <span class="ow">is</span> <span class="n">deprecated</span> <span class="ow">in</span> <span class="n">favor</span> <span class="n">of</span> <span class="n">kdeplot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="ow">and</span> <span class="n">it</span> <span class="n">will</span> <span class="n">cause</span> <span class="n">an</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">future</span> <span class="n">versions</span><span class="o">.</span> <span class="n">Please</span> <span class="n">update</span> <span class="n">your</span> <span class="n">code</span><span class="o">.</span>
  <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">warn_msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_329_1.png" src="_images/matplotlib_329_1.png" />
<p>We can see the joint distribution and the marginal distributions
together using <code class="docutils literal notranslate"><span class="pre">sns.jointplot</span></code>. For this plot, we’ll set the style to
a white background:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;kde&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_331_0.png" src="_images/matplotlib_331_0.png" />
<p>There are other parameters that can be passed to <code class="docutils literal notranslate"><span class="pre">jointplot</span></code>—for
example, we can use a hexagonally based histogram instead:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_333_0.png" src="_images/matplotlib_333_0.png" />
</div>
<div class="section" id="pair-plots">
<h4>Pair plots<a class="headerlink" href="#pair-plots" title="Permalink to this headline">¶</a></h4>
<p>When you generalize joint plots to datasets of larger dimensions, you
end up with <em>pair plots</em>. This is very useful for exploring correlations
between multidimensional data, when you’d like to plot all pairs of
values against each other.</p>
<p>We’ll demo this with the well-known Iris dataset, which lists
measurements of petals and sepals of three iris species:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;iris&quot;</span><span class="p">)</span>
<span class="n">iris</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal_length</th>
      <th>sepal_width</th>
      <th>petal_length</th>
      <th>petal_width</th>
      <th>species</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>setosa</td>
    </tr>
  </tbody>
</table>
</div><p>Visualizing the multidimensional relationships among the samples is as
easy as calling <code class="docutils literal notranslate"><span class="pre">sns.pairplot</span></code>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;species&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_337_0.png" src="_images/matplotlib_337_0.png" />
</div>
<div class="section" id="faceted-histograms">
<h4>Faceted histograms<a class="headerlink" href="#faceted-histograms" title="Permalink to this headline">¶</a></h4>
<p>Sometimes the best way to view data is via histograms of subsets.
Seaborn’s <code class="docutils literal notranslate"><span class="pre">FacetGrid</span></code> makes this extremely simple. We’ll take a look
at some data that shows the amount that restaurant staff receive in tips
based on various indicator data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;tips&#39;</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.34</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.68</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">&#39;total_bill&#39;</span><span class="p">]</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">FacetGrid</span><span class="p">(</span><span class="n">tips</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">margin_titles</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">,</span> <span class="s2">&quot;tip_pct&quot;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">15</span><span class="p">));</span>
</pre></div>
</div>
<img alt="_images/matplotlib_340_0.png" src="_images/matplotlib_340_0.png" />
</div>
<div class="section" id="factor-plots">
<h4>Factor plots<a class="headerlink" href="#factor-plots" title="Permalink to this headline">¶</a></h4>
<p>Factor plots can be useful for this kind of visualization as well. This
allows you to view the distribution of a parameter within bins defined
by any other parameter:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;ticks&#39;</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;day&quot;</span><span class="p">,</span> <span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_axis_labels</span><span class="p">(</span><span class="s2">&quot;Day&quot;</span><span class="p">,</span> <span class="s2">&quot;Total Bill&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_342_0.png" src="_images/matplotlib_342_0.png" />
</div>
<div class="section" id="joint-distributions">
<h4>Joint distributions<a class="headerlink" href="#joint-distributions" title="Permalink to this headline">¶</a></h4>
<p>Similar to the pairplot we saw earlier, we can use <code class="docutils literal notranslate"><span class="pre">sns.jointplot</span></code> to
show the joint distribution between different datasets, along with the
associated marginal distributions:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="s2">&quot;tip&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_344_0.png" src="_images/matplotlib_344_0.png" />
<p>The joint plot can even do some automatic kernel density estimation and
regression:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="s2">&quot;total_bill&quot;</span><span class="p">,</span> <span class="s2">&quot;tip&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;reg&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_346_0.png" src="_images/matplotlib_346_0.png" />
</div>
<div class="section" id="bar-plots">
<h4>Bar plots<a class="headerlink" href="#bar-plots" title="Permalink to this headline">¶</a></h4>
<p>Time series can be plotted using <code class="docutils literal notranslate"><span class="pre">sns.factorplot</span></code>. In the following
example, we’ll use the Planets data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">planets</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">&#39;planets&#39;</span><span class="p">)</span>
<span class="n">planets</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>method</th>
      <th>number</th>
      <th>orbital_period</th>
      <th>mass</th>
      <th>distance</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>269.300</td>
      <td>7.10</td>
      <td>77.40</td>
      <td>2006</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>874.774</td>
      <td>2.21</td>
      <td>56.95</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>763.000</td>
      <td>2.60</td>
      <td>19.84</td>
      <td>2011</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>326.030</td>
      <td>19.40</td>
      <td>110.62</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Radial Velocity</td>
      <td>1</td>
      <td>516.220</td>
      <td>10.50</td>
      <td>119.47</td>
      <td>2009</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">planets</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                       <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;count&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;steelblue&#39;</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_349_0.png" src="_images/matplotlib_349_0.png" />
<p>We can learn more by looking at the <em>method</em> of discovery of each of
these planets:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">factorplot</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">planets</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
                       <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">2001</span><span class="p">,</span> <span class="mi">2015</span><span class="p">))</span>
    <span class="n">g</span><span class="o">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="s1">&#39;Number of Planets Discovered&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_351_0.png" src="_images/matplotlib_351_0.png" />
</div>
</div>
<div class="section" id="example-exploring-marathon-finishing-times">
<h3>Example: Exploring Marathon Finishing Times<a class="headerlink" href="#example-exploring-marathon-finishing-times" title="Permalink to this headline">¶</a></h3>
<p>Here we’ll look at using Seaborn to help visualize and understand
finishing results from a marathon. I’ve scraped the data from sources on
the Web, aggregated it and removed any identifying information, and put
it on GitHub where it can be downloaded (if you are interested in using
Python for web scraping, I would recommend <a class="reference external" href="http://shop.oreilly.com/product/0636920034391.do">Web Scraping with
Python</a> by Ryan
Mitchell). We will start by downloading the data from the Web, and
loading it into Pandas:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>curl -O https://raw.githubusercontent.com/jakevdp/marathon-data/master/marathon-data.csv
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="o">%</span> <span class="n">Total</span>    <span class="o">%</span> <span class="n">Received</span> <span class="o">%</span> <span class="n">Xferd</span>  <span class="n">Average</span> <span class="n">Speed</span>   <span class="n">Time</span>    <span class="n">Time</span>     <span class="n">Time</span>  <span class="n">Current</span>
                                 <span class="n">Dload</span>  <span class="n">Upload</span>   <span class="n">Total</span>   <span class="n">Spent</span>    <span class="n">Left</span>  <span class="n">Speed</span>
<span class="mi">100</span>  <span class="mi">836</span><span class="n">k</span>  <span class="mi">100</span>  <span class="mi">836</span><span class="n">k</span>    <span class="mi">0</span>     <span class="mi">0</span>   <span class="mi">974</span><span class="n">k</span>      <span class="mi">0</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span> <span class="o">--</span><span class="p">:</span><span class="o">--</span><span class="p">:</span><span class="o">--</span>  <span class="mi">972</span><span class="n">k</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;marathon-data.csv&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>split</th>
      <th>final</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>33</td>
      <td>M</td>
      <td>01:05:38</td>
      <td>02:08:51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>M</td>
      <td>01:06:26</td>
      <td>02:09:28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:49</td>
      <td>02:10:42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>M</td>
      <td>01:06:16</td>
      <td>02:13:45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:32</td>
      <td>02:13:59</td>
    </tr>
  </tbody>
</table>
</div><p>By default, Pandas loaded the time columns as Python strings (type
<code class="docutils literal notranslate"><span class="pre">object</span></code>); we can see this by looking at the <code class="docutils literal notranslate"><span class="pre">dtypes</span></code> attribute of
the DataFrame:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">age</span>        <span class="n">int64</span>
<span class="n">gender</span>    <span class="nb">object</span>
<span class="n">split</span>     <span class="nb">object</span>
<span class="n">final</span>     <span class="nb">object</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>Let’s fix this by providing a converter for the times:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">def</span> <span class="nf">convert_time</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">minutes</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">seconds</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;marathon-data.csv&#39;</span><span class="p">,</span>
                   <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;split&#39;</span><span class="p">:</span><span class="n">convert_time</span><span class="p">,</span> <span class="s1">&#39;final&#39;</span><span class="p">:</span><span class="n">convert_time</span><span class="p">})</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>split</th>
      <th>final</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>33</td>
      <td>M</td>
      <td>01:05:38</td>
      <td>02:08:51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>M</td>
      <td>01:06:26</td>
      <td>02:09:28</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:49</td>
      <td>02:10:42</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>M</td>
      <td>01:06:16</td>
      <td>02:13:45</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:32</td>
      <td>02:13:59</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">age</span>                 <span class="n">int64</span>
<span class="n">gender</span>             <span class="nb">object</span>
<span class="n">split</span>     <span class="n">timedelta64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">final</span>     <span class="n">timedelta64</span><span class="p">[</span><span class="n">ns</span><span class="p">]</span>
<span class="n">dtype</span><span class="p">:</span> <span class="nb">object</span>
</pre></div>
</div>
<p>That looks much better. For the purpose of our Seaborn plotting
utilities, let’s next add columns that give the times in seconds:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;split_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;split&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1E9</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;final_sec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;final&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1E9</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>split</th>
      <th>final</th>
      <th>split_sec</th>
      <th>final_sec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>33</td>
      <td>M</td>
      <td>01:05:38</td>
      <td>02:08:51</td>
      <td>3938.0</td>
      <td>7731.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>M</td>
      <td>01:06:26</td>
      <td>02:09:28</td>
      <td>3986.0</td>
      <td>7768.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:49</td>
      <td>02:10:42</td>
      <td>4009.0</td>
      <td>7842.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>M</td>
      <td>01:06:16</td>
      <td>02:13:45</td>
      <td>3976.0</td>
      <td>8025.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:32</td>
      <td>02:13:59</td>
      <td>3992.0</td>
      <td>8039.0</td>
    </tr>
  </tbody>
</table>
</div><p>To get an idea of what the data looks like, we can plot a <code class="docutils literal notranslate"><span class="pre">jointplot</span></code>
over the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">jointplot</span><span class="p">(</span><span class="s2">&quot;split_sec&quot;</span><span class="p">,</span> <span class="s2">&quot;final_sec&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;hex&#39;</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">ax_joint</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">16000</span><span class="p">),</span>
                    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">8000</span><span class="p">,</span> <span class="mi">32000</span><span class="p">),</span> <span class="s1">&#39;:k&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/matplotlib_363_0.png" src="_images/matplotlib_363_0.png" />
<p>The dotted line shows where someone’s time would lie if they ran the
marathon at a perfectly steady pace. The fact that the distribution lies
above this indicates (as you might expect) that most people slow down
over the course of the marathon. If you have run competitively, you’ll
know that those who do the opposite—run faster during the second half of
the race—are said to have “negative-split” the race.</p>
<p>Let’s create another column in the data, the split fraction, which
measures the degree to which each runner negative-splits or
positive-splits the race:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;split_frac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;split_sec&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;final_sec&#39;</span><span class="p">]</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>split</th>
      <th>final</th>
      <th>split_sec</th>
      <th>final_sec</th>
      <th>split_frac</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>33</td>
      <td>M</td>
      <td>01:05:38</td>
      <td>02:08:51</td>
      <td>3938.0</td>
      <td>7731.0</td>
      <td>-0.018756</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>M</td>
      <td>01:06:26</td>
      <td>02:09:28</td>
      <td>3986.0</td>
      <td>7768.0</td>
      <td>-0.026262</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:49</td>
      <td>02:10:42</td>
      <td>4009.0</td>
      <td>7842.0</td>
      <td>-0.022443</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>M</td>
      <td>01:06:16</td>
      <td>02:13:45</td>
      <td>3976.0</td>
      <td>8025.0</td>
      <td>0.009097</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:32</td>
      <td>02:13:59</td>
      <td>3992.0</td>
      <td>8039.0</td>
      <td>0.006842</td>
    </tr>
  </tbody>
</table>
</div><p>Where this split difference is less than zero, the person negative-split
the race by that fraction. Let’s do a distribution plot of this split
fraction:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;split_frac&#39;</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_367_0.png" src="_images/matplotlib_367_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split_frac</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">251</span>
</pre></div>
</div>
<p>Out of nearly 40,000 participants, there were only 250 people who
negative-split their marathon.</p>
<p>Let’s see whether there is any correlation between this split fraction
and other variables. We’ll do this using a <code class="docutils literal notranslate"><span class="pre">pairgrid</span></code>, which draws
plots of all these correlations:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">PairGrid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;split_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;final_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;split_frac&#39;</span><span class="p">],</span>
                 <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">add_legend</span><span class="p">();</span>
</pre></div>
</div>
<img alt="_images/matplotlib_370_0.png" src="_images/matplotlib_370_0.png" />
<p>It looks like the split fraction does not correlate particularly with
age, but does correlate with the final time: faster runners tend to have
closer to even splits on their marathon time. (We see here that Seaborn
is no panacea for Matplotlib’s ills when it comes to plot styles: in
particular, the x-axis labels overlap. Because the output is a simple
Matplotlib plot, however, the methods about ticks can be used to adjust
such things if desired.)</p>
<p>The difference between men and women here is interesting. Let’s look at
the histogram of split fractions for these two groups:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split_frac</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">gender</span><span class="o">==</span><span class="s1">&#39;M&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;men&#39;</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">split_frac</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">gender</span><span class="o">==</span><span class="s1">&#39;W&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;women&#39;</span><span class="p">,</span> <span class="n">shade</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;split_frac&#39;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_373_0.png" src="_images/matplotlib_373_0.png" />
<p>The interesting thing here is that there are many more men than women
who are running close to an even split! This almost looks like some kind
of bimodal distribution among the men and women. Let’s see if we can
suss-out what’s going on by looking at the distributions as a function
of age.</p>
<p>A nice way to compare distributions is to use a <em>violin plot</em></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="s2">&quot;split_frac&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="s2">&quot;lightpink&quot;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_375_0.png" src="_images/matplotlib_375_0.png" />
<p>This is yet another way to compare the distributions between men and
women.</p>
<p>Let’s look a little deeper, and compare these violin plots as a function
of age. We’ll start by creating a new column in the array that specifies
the decade of age that each person is in:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;age_dec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">age</span><span class="p">:</span> <span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">age</span> <span class="o">//</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>gender</th>
      <th>split</th>
      <th>final</th>
      <th>split_sec</th>
      <th>final_sec</th>
      <th>split_frac</th>
      <th>age_dec</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>33</td>
      <td>M</td>
      <td>01:05:38</td>
      <td>02:08:51</td>
      <td>3938.0</td>
      <td>7731.0</td>
      <td>-0.018756</td>
      <td>30</td>
    </tr>
    <tr>
      <th>1</th>
      <td>32</td>
      <td>M</td>
      <td>01:06:26</td>
      <td>02:09:28</td>
      <td>3986.0</td>
      <td>7768.0</td>
      <td>-0.026262</td>
      <td>30</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:49</td>
      <td>02:10:42</td>
      <td>4009.0</td>
      <td>7842.0</td>
      <td>-0.022443</td>
      <td>30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>38</td>
      <td>M</td>
      <td>01:06:16</td>
      <td>02:13:45</td>
      <td>3976.0</td>
      <td>8025.0</td>
      <td>0.009097</td>
      <td>30</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31</td>
      <td>M</td>
      <td>01:06:32</td>
      <td>02:13:59</td>
      <td>3992.0</td>
      <td>8039.0</td>
      <td>0.006842</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div><div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">men</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gender</span> <span class="o">==</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="n">women</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">gender</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">axes_style</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="s2">&quot;age_dec&quot;</span><span class="p">,</span> <span class="s2">&quot;split_frac&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                   <span class="n">split</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inner</span><span class="o">=</span><span class="s2">&quot;quartile&quot;</span><span class="p">,</span>
                   <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="s2">&quot;lightpink&quot;</span><span class="p">]);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_379_0.png" src="_images/matplotlib_379_0.png" />
<p>Looking at this, we can see where the distributions of men and women
differ: the split distributions of men in their 20s to 50s show a
pronounced over-density toward lower splits when compared to women of
the same age (or of any age, for that matter).</p>
<p>Also surprisingly, the 80-year-old women seem to outperform <em>everyone</em>
in terms of their split time. This is probably due to the fact that
we’re estimating the distribution from small numbers, as there are only
a handful of runners in that range:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">age</span> <span class="o">&gt;</span> <span class="mi">80</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
<p>Back to the men with negative splits: who are these runners? Does this
split fraction correlate with finishing quickly? We can plot this very
easily. We’ll use <code class="docutils literal notranslate"><span class="pre">regplot</span></code>, which will automatically fit a linear
regression to the data:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">&#39;final_sec&#39;</span><span class="p">,</span> <span class="s1">&#39;split_frac&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;gender&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
               <span class="n">markers</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">scatter_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">))</span>
<span class="n">g</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/matplotlib_384_0.png" src="_images/matplotlib_384_0.png" />
</div>
</div>
</div>
<div class="section" id="networkx-module">
<h1><code class="docutils literal notranslate"><span class="pre">networkx</span></code> module<a class="headerlink" href="#networkx-module" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. May 2, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract A (very concise) introduction to the NetworkX module.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;notebooks&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,</span> <span class="s1">&#39;NetworkX&#39;</span><span class="p">,</span> <span class="s1">&#39;graphs&#39;</span><span class="p">]</span>
</pre></div>
</div>
<center></center><p><a class="reference external" href="https://github.com/networkx/networkx">https://github.com/networkx/networkx</a></p>
<p>Aric A. Hagberg, Daniel A. Schult and Pieter J. Swart, <a class="reference external" href="http://conference.scipy.org/proceedings/SciPy2008/paper_2/">“Exploring
network structure, dynamics, and function using NetworkX”, in
Proceedings of the 7th Python in Science Conference
(SciPy2008)</a>,
Gäel Varoquaux, Travis Vaught, and Jarrod Millman (Eds), (Pasadena, CA
USA), pp. 11–15, Aug 2008
(<a class="reference external" href="http://math.lanl.gov/~hagberg/Papers/hagberg-2008-exploring.pdf">pdf</a>).</p>
<p>This content is originally downloaded from
<a class="reference external" href="https://networkx.github.io/documentation/stable/tutorial.html">https://networkx.github.io/documentation/stable/tutorial.html</a> and
adapted to be shown as a presentation; moreover, we mix in additional
resources such as examples (citing them and the original authors) in the
last section.</p>
<p>Create an empty graph with no nodes and no edges.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
</pre></div>
</div>
<p>By definition, a <code class="docutils literal notranslate"><span class="pre">Graph</span></code> is a collection of nodes (vertices) along
with identified pairs of nodes (called edges, links, etc). In NetworkX,
nodes can be any <em>hashable</em> object e.g., a text string, an image, an XML
object, another Graph, a customized node object, etc.</p>
<blockquote>
<div><p>An object is hashable if it has a hash value which never changes
during its lifetime (it needs a <code class="docutils literal notranslate"><span class="pre">__hash__()</span></code> method), and can be
compared to other objects (it needs an <code class="docutils literal notranslate"><span class="pre">__eq__()</span></code> method). Hashable
objects which compare equal must have the same hash value.</p>
</div></blockquote>
<div class="section" id="nodes">
<h2>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h2>
<p>The graph <code class="docutils literal notranslate"><span class="pre">G</span></code> can be grown in several ways. NetworkX includes many
graph generator functions and facilities to read and write graphs in
many formats. To get started though we’ll look at simple manipulations.
You can add one node at a time,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>add a list of nodes,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>or add any iterable container of nodes. You can also add nodes along
with node attributes if your container yields 2-tuples (node,
node_attribute_dict). Node attributes are discussed further below.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">G</span></code> now contains the nodes of <code class="docutils literal notranslate"><span class="pre">H</span></code> as nodes of <code class="docutils literal notranslate"><span class="pre">G</span></code>. In
contrast, you could use the graph <code class="docutils literal notranslate"><span class="pre">H</span></code> as a node in <code class="docutils literal notranslate"><span class="pre">G</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
<p>The graph <code class="docutils literal notranslate"><span class="pre">G</span></code> now contains <code class="docutils literal notranslate"><span class="pre">H</span></code> as a node. This flexibility is very
powerful as it allows graphs of graphs, graphs of files, graphs of
functions and much more. It is worth thinking about how to structure
your application so that the nodes are useful entities. Of course you
can always use a unique identifier in <code class="docutils literal notranslate"><span class="pre">G</span></code> and have a separate
dictionary keyed by identifier to the node information if you prefer.</p>
</div>
<div class="section" id="edges">
<h2>Edges<a class="headerlink" href="#edges" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">G</span></code> can also be grown by adding one edge at a time,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># unpack edge tuple*</span>
</pre></div>
</div>
<p>by adding a list of edges,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
</pre></div>
</div>
<p>or by adding any ebunch of edges. An <em>ebunch</em> is any iterable container
of edge-tuples. An edge-tuple can be a 2-tuple of nodes or a 3-tuple
with 2 nodes followed by an edge attribute dictionary, e.g.,
<code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3,</span> <span class="pre">{'weight':</span> <span class="pre">3.1415})</span></code>. Edge attributes are discussed further
below</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
<p>There are no complaints when adding existing nodes or edges. For
example, after removing all nodes and edges,</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
</pre></div>
</div>
<p>we add new nodes/edges and NetworkX quietly ignores any that are already
present.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;spam&quot;</span><span class="p">)</span>        <span class="c1"># adds node &quot;spam&quot;</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="s2">&quot;spam&quot;</span><span class="p">)</span>  <span class="c1"># adds 4 nodes: &#39;s&#39;, &#39;p&#39;, &#39;a&#39;, &#39;m&#39;</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>At this stage the graph <code class="docutils literal notranslate"><span class="pre">G</span></code> consists of 8 nodes and 3 edges, as can be
seen by:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<p>We can examine the nodes and edges. Four basic graph properties
facilitate reporting: <code class="docutils literal notranslate"><span class="pre">G.nodes</span></code>, <code class="docutils literal notranslate"><span class="pre">G.edges</span></code>, <code class="docutils literal notranslate"><span class="pre">G.adj</span></code> and
<code class="docutils literal notranslate"><span class="pre">G.degree</span></code>. These are set-like views of the nodes, edges, neighbors
(adjacencies), and degrees of nodes in a graph. They offer a continually
updated read-only view into the graph structure. They are also dict-like
in that you can look up node and edge data attributes via the views and
iterate with data attributes using methods <code class="docutils literal notranslate"><span class="pre">.items()</span></code>,
<code class="docutils literal notranslate"><span class="pre">.data('span')</span></code>. If you want a specific container type instead of a
view, you can specify one. Here we use lists, though sets, dicts, tuples
and other containers may be better in other contexts.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;spam&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">adj</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># or list(G.neighbors(1))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># the number of edges incident to 1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<p>One can specify to report the edges and degree from a subset of all
nodes using an <em>nbunch</em>. An <em>nbunch</em> is any of: None (meaning all
nodes), a node, or an iterable container of nodes that is not itself a
node in the graph.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">]),</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">EdgeDataView</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]),</span> <span class="n">DegreeView</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">}))</span>
</pre></div>
</div>
<p>One can remove nodes and edges from the graph in a similar fashion to
adding. Use methods <code class="docutils literal notranslate"><span class="pre">Graph.remove_node()</span></code>,
<code class="docutils literal notranslate"><span class="pre">Graph.remove_nodes_from()</span></code>, <code class="docutils literal notranslate"><span class="pre">Graph.remove_edge()</span></code> and
<code class="docutils literal notranslate"><span class="pre">Graph.remove_edges_from()</span></code>, e.g.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">remove_node</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">remove_nodes_from</span><span class="p">(</span><span class="s2">&quot;spam&quot;</span><span class="p">)</span>
<span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;spam&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>When creating a graph structure by instantiating one of the graph
classes you can specify data in several formats.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>   <span class="c1"># create a DiGraph using the connections from G</span>
<span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">edgelist</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">edgelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="what-to-use-as-nodes-and-edges">
<h2>What to use as nodes and edges<a class="headerlink" href="#what-to-use-as-nodes-and-edges" title="Permalink to this headline">¶</a></h2>
<p>You might notice that nodes and edges are not specified as NetworkX
objects. This leaves you free to use meaningful items as nodes and
edges. The most common choices are numbers or strings, but a node can be
any hashable object (except <code class="docutils literal notranslate"><span class="pre">None</span></code>), and an edge can be associated
with any object <code class="docutils literal notranslate"><span class="pre">x</span></code> using <code class="docutils literal notranslate"><span class="pre">G.add_edge(n1,</span> <span class="pre">n2,</span> <span class="pre">object=x)</span></code>.</p>
<p>As an example, <code class="docutils literal notranslate"><span class="pre">n1</span></code> and <code class="docutils literal notranslate"><span class="pre">n2</span></code> could be protein objects from the RCSB
Protein Data Bank, and <code class="docutils literal notranslate"><span class="pre">x</span></code> could refer to an XML record of
publications detailing experimental observations of their interaction.</p>
<p>We have found this power quite useful, but its abuse can lead to
unexpected surprises unless one is familiar with Python. If in doubt,
consider using <code class="docutils literal notranslate"><span class="pre">convert_node_labels_to_integers()</span></code> to obtain a more
traditional graph with integer labels.</p>
</div>
<div class="section" id="accessing-edges-and-neighbors">
<h2>Accessing edges and neighbors<a class="headerlink" href="#accessing-edges-and-neighbors" title="Permalink to this headline">¶</a></h2>
<p>In addition to the views <code class="docutils literal notranslate"><span class="pre">Graph.edges()</span></code>, and <code class="docutils literal notranslate"><span class="pre">Graph.adj()</span></code>, access
to edges and neighbors is possible using subscript notation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># same as G.adj[1]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AtlasView</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="p">{}})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">({},</span> <span class="p">{})</span>
</pre></div>
</div>
<p>You can get/set the attributes of an edge using subscript notation if
the edge already exists.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span>
<span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">][</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span>
</pre></div>
</div>
<p>Fast examination of all (node, adjacency) pairs is achieved using
<code class="docutils literal notranslate"><span class="pre">G.adjacency()</span></code>, or <code class="docutils literal notranslate"><span class="pre">G.adj.items()</span></code>. Note that for undirected
graphs, adjacency iteration sees each edge twice.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">FG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">FG</span><span class="o">.</span><span class="n">add_weighted_edges_from</span><span class="p">(</span>
    <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">nbrs</span> <span class="ow">in</span> <span class="n">FG</span><span class="o">.</span><span class="n">adj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
   <span class="k">for</span> <span class="n">nbr</span><span class="p">,</span> <span class="n">eattr</span> <span class="ow">in</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
       <span class="n">wt</span> <span class="o">=</span> <span class="n">eattr</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span>
       <span class="k">if</span> <span class="n">wt</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nbr</span><span class="p">,</span> <span class="n">wt</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">)</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">)</span>
</pre></div>
</div>
<p>Convenient access to all edges is achieved with the edges property.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">wt</span><span class="p">)</span> <span class="ow">in</span> <span class="n">FG</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="s1">&#39;weight&#39;</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">wt</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">%d</span><span class="s1">, </span><span class="si">%d</span><span class="s1">, </span><span class="si">%.3f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">wt</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.125</span><span class="p">)</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-attributes-to-graphs-nodes-and-edges">
<h2>Adding attributes to graphs, nodes, and edges<a class="headerlink" href="#adding-attributes-to-graphs-nodes-and-edges" title="Permalink to this headline">¶</a></h2>
<p>Attributes such as weights, labels, colors, or whatever Python object
you like, can be attached to graphs, nodes, or edges.</p>
<p>Each graph, node, and edge can hold key/value attribute pairs in an
associated attribute dictionary (the keys must be hashable). By default
these are empty, but attributes can be added or changed using
<code class="docutils literal notranslate"><span class="pre">add_edge</span></code>, <code class="docutils literal notranslate"><span class="pre">add_node</span></code> or direct manipulation of the attribute
dictionaries named <code class="docutils literal notranslate"><span class="pre">G.graph</span></code>, <code class="docutils literal notranslate"><span class="pre">G.nodes</span></code>, and <code class="docutils literal notranslate"><span class="pre">G.edges</span></code> for a graph
<code class="docutils literal notranslate"><span class="pre">G</span></code>.</p>
<div class="section" id="graph-attributes">
<h3>Graph attributes<a class="headerlink" href="#graph-attributes" title="Permalink to this headline">¶</a></h3>
<p>Assign graph attributes when creating a new graph</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">day</span><span class="o">=</span><span class="s2">&quot;Friday&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">graph</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="s1">&#39;Friday&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>Or you can modify attributes later</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Monday&quot;</span>
<span class="n">G</span><span class="o">.</span><span class="n">graph</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;day&#39;</span><span class="p">:</span> <span class="s1">&#39;Monday&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="node-attributes">
<h2>Node attributes<a class="headerlink" href="#node-attributes" title="Permalink to this headline">¶</a></h2>
<p>Add node attributes using <code class="docutils literal notranslate"><span class="pre">add_node()</span></code>, <code class="docutils literal notranslate"><span class="pre">add_nodes_from()</span></code>, or
<code class="docutils literal notranslate"><span class="pre">G.nodes</span></code></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;5pm&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;2pm&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;5pm&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;room&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">714</span>
<span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">data</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NodeDataView</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;5pm&#39;</span><span class="p">,</span> <span class="s1">&#39;room&#39;</span><span class="p">:</span> <span class="mi">714</span><span class="p">},</span> <span class="mi">3</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;2pm&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<p>Note that adding a node to <code class="docutils literal notranslate"><span class="pre">G.nodes</span></code> does not add it to the graph, use
<code class="docutils literal notranslate"><span class="pre">G.add_node()</span></code> to add new nodes. Similarly for edges.</p>
</div>
<div class="section" id="edge-attributes">
<h2>Edge Attributes<a class="headerlink" href="#edge-attributes" title="Permalink to this headline">¶</a></h2>
<p>Add/change edge attributes using <code class="docutils literal notranslate"><span class="pre">add_edge()</span></code>, <code class="docutils literal notranslate"><span class="pre">add_edges_from()</span></code>,
or subscript notation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">4.7</span> <span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">}),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">})])</span>
<span class="n">G</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.7</span>
<span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">][</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.2</span>
</pre></div>
</div>
<p>The special attribute <code class="docutils literal notranslate"><span class="pre">weight</span></code> should be numeric as it is used by
algorithms requiring weighted edges.</p>
<p>Directed graphs</p>
<p>The <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> class provides additional properties specific to
directed edges, e.g., <code class="docutils literal notranslate"><span class="pre">DiGraph.out_edges()</span></code>, <code class="docutils literal notranslate"><span class="pre">DiGraph.in_degree()</span></code>,
<code class="docutils literal notranslate"><span class="pre">DiGraph.predecessors()</span></code>, <code class="docutils literal notranslate"><span class="pre">DiGraph.successors()</span></code> etc. To allow
algorithms to work with both classes easily, the directed versions of
<code class="docutils literal notranslate"><span class="pre">neighbors()</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">successors()</span></code> while <code class="docutils literal notranslate"><span class="pre">degree</span></code>
reports the sum of <code class="docutils literal notranslate"><span class="pre">in_degree</span></code> and <code class="docutils literal notranslate"><span class="pre">out_degree</span></code> even though that may
feel inconsistent at times.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
<span class="n">DG</span><span class="o">.</span><span class="n">add_weighted_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">)])</span>
<span class="n">DG</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">),</span> <span class="n">DG</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">DG</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="n">DG</span><span class="o">.</span><span class="n">neighbors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Some algorithms work only for directed graphs and others are not well
defined for directed graphs. Indeed the tendency to lump directed and
undirected graphs together is dangerous. If you want to treat a directed
graph as undirected for some measurement you should probably convert it
using <code class="docutils literal notranslate"><span class="pre">Graph.to_undirected()</span></code> or with</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">H</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>  <span class="c1"># convert G to undirected graph</span>
</pre></div>
</div>
</div>
<div class="section" id="multigraphs">
<h2>Multigraphs<a class="headerlink" href="#multigraphs" title="Permalink to this headline">¶</a></h2>
<p>NetworkX provides classes for graphs which allow multiple edges between
any pair of nodes. The <code class="docutils literal notranslate"><span class="pre">MultiGraph</span></code> and <code class="docutils literal notranslate"><span class="pre">MultiDiGraph</span></code> classes allow
you to add the same edge twice, possibly with different edge data. This
can be powerful for some applications, but many algorithms are not well
defined on such graphs. Where results are well defined, e.g.,
<code class="docutils literal notranslate"><span class="pre">MultiGraph.degree()</span></code> we provide the function. Otherwise you should
convert to a standard graph in a way that makes the measurement well
defined.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">()</span>
<span class="n">MG</span><span class="o">.</span><span class="n">add_weighted_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)])</span>
<span class="nb">dict</span><span class="p">(</span><span class="n">MG</span><span class="o">.</span><span class="n">degree</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;weight&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">1.75</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">nbrs</span> <span class="ow">in</span> <span class="n">MG</span><span class="o">.</span><span class="n">adjacency</span><span class="p">():</span>
   <span class="k">for</span> <span class="n">nbr</span><span class="p">,</span> <span class="n">edict</span> <span class="ow">in</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
       <span class="n">minvalue</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;weight&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">edict</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
       <span class="n">GG</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nbr</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="n">minvalue</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="n">GG</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="graph-generators-and-graph-operations">
<h2>Graph generators and graph operations<a class="headerlink" href="#graph-generators-and-graph-operations" title="Permalink to this headline">¶</a></h2>
<p>In addition to constructing graphs node-by-node or edge-by-edge, they
can also be generated by</p>
<ol class="arabic">
<li><p>Applying classic graph operations, such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">subgraph</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">nbunch</span><span class="p">)</span>      <span class="o">-</span> <span class="n">induced</span> <span class="n">subgraph</span> <span class="n">view</span> <span class="n">of</span> <span class="n">G</span> <span class="n">on</span> <span class="n">nodes</span> <span class="ow">in</span> <span class="n">nbunch</span>
<span class="n">union</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">G2</span><span class="p">)</span>             <span class="o">-</span> <span class="n">graph</span> <span class="n">union</span>
<span class="n">disjoint_union</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">G2</span><span class="p">)</span>    <span class="o">-</span> <span class="n">graph</span> <span class="n">union</span> <span class="n">assuming</span> <span class="nb">all</span> <span class="n">nodes</span> <span class="n">are</span> <span class="n">different</span>
<span class="n">cartesian_product</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">G2</span><span class="p">)</span> <span class="o">-</span> <span class="k">return</span> <span class="n">Cartesian</span> <span class="n">product</span> <span class="n">graph</span>
<span class="n">compose</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">G2</span><span class="p">)</span>           <span class="o">-</span> <span class="n">combine</span> <span class="n">graphs</span> <span class="n">identifying</span> <span class="n">nodes</span> <span class="n">common</span> <span class="n">to</span> <span class="n">both</span>
<span class="n">complement</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>            <span class="o">-</span> <span class="n">graph</span> <span class="n">complement</span>
<span class="n">create_empty_copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>     <span class="o">-</span> <span class="k">return</span> <span class="n">an</span> <span class="n">empty</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">the</span> <span class="n">same</span> <span class="n">graph</span> <span class="k">class</span>
<span class="nc">to_undirected</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">-</span> <span class="k">return</span> <span class="n">an</span> <span class="n">undirected</span> <span class="n">representation</span> <span class="n">of</span> <span class="n">G</span>
<span class="n">to_directed</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>   <span class="o">-</span> <span class="k">return</span> <span class="n">a</span> <span class="n">directed</span> <span class="n">representation</span> <span class="n">of</span> <span class="n">G</span>
</pre></div>
</div>
</li>
<li><p>Using a call to one of the classic small graphs, e.g.,</p></li>
</ol>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">petersen</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">petersen_graph</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">petersen</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_71_0.png" src="_images/networkx_71_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tutte</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">tutte_graph</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">tutte</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_72_0.png" src="_images/networkx_72_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maze</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">sedgewick_maze_graph</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">maze</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_73_0.png" src="_images/networkx_73_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tet</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">tetrahedral_graph</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">tet</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_74_0.png" src="_images/networkx_74_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K_5</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">complete_graph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">K_5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_75_0.png" src="_images/networkx_75_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">K_3_5</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">complete_bipartite_graph</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">K_3_5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_76_0.png" src="_images/networkx_76_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">barbell</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">barbell_graph</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">barbell</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_77_0.png" src="_images/networkx_77_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lollipop</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">lollipop_graph</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">lollipop</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_78_0.png" src="_images/networkx_78_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">er</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">erdos_renyi_graph</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">er</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_79_0.png" src="_images/networkx_79_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">watts_strogatz_graph</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">ws</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_80_0.png" src="_images/networkx_80_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ba</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">barabasi_albert_graph</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">ba</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_81_0.png" src="_images/networkx_81_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">red</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">random_lobster</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">red</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_82_0.png" src="_images/networkx_82_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">write_gml</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="s2">&quot;path.to.file&quot;</span><span class="p">)</span>
<span class="n">mygraph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_gml</span><span class="p">(</span><span class="s2">&quot;path.to.file&quot;</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">mygraph</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_83_0.png" src="_images/networkx_83_0.png" />
</div>
<div class="section" id="analyzing-graphs">
<h2>Analyzing graphs<a class="headerlink" href="#analyzing-graphs" title="Permalink to this headline">¶</a></h2>
<p>The structure of <code class="docutils literal notranslate"><span class="pre">G</span></code> can be analyzed using various graph-theoretic
functions such as:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_edges_from</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s2">&quot;spam&quot;</span><span class="p">)</span>       <span class="c1"># adds node &quot;spam&quot;</span>
<span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">connected_components</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;spam&#39;</span><span class="p">}]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">d</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">clustering</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;spam&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
</pre></div>
</div>
<p>Some functions with large output iterate over (node, value) 2-tuples.
These are easily stored in a
<a class="reference external" href="https://docs.python.org/2/library/stdtypes.html#dict">dict</a>
structure if you desire.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sp</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">all_pairs_shortest_path</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="n">sp</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
</pre></div>
</div>
<p>See
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/algorithms/index.html">Algorithms</a>
for details on graph algorithms supported.</p>
</div>
<div class="section" id="drawing-graphs">
<h2>Drawing graphs<a class="headerlink" href="#drawing-graphs" title="Permalink to this headline">¶</a></h2>
<p>NetworkX is not primarily a graph drawing package but basic drawing with
Matplotlib as well as an interface to use the open source Graphviz
software package are included. These are part of the
<code class="docutils literal notranslate"><span class="pre">networkx.drawing</span></code> module and will be imported if possible.</p>
<p>First import Matplotlib’s plot interface (pylab works too)</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>You may find it useful to interactively test code using
<code class="docutils literal notranslate"><span class="pre">ipython</span> <span class="pre">-pylab</span></code>, which combines the power of ipython and matplotlib
and provides a convenient interactive mode.</p>
<p>To test if the import of <code class="docutils literal notranslate"><span class="pre">networkx.drawing</span></code> was successful draw <code class="docutils literal notranslate"><span class="pre">G</span></code>
using one of</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">petersen_graph</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_shell</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">nlist</span><span class="o">=</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span>
              <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_94_0.png" src="_images/networkx_94_0.png" />
<p>when drawing to an interactive display. Note that you may need to issue
a Matplotlib</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>command if you are not using matplotlib in interactive mode (see
<a class="reference external" href="http://matplotlib.org/faq/installing_faq.html#matplotlib-compiled-fine-but-nothing-shows-up-when-i-use-it">Matplotlib
FAQ</a>
).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;node_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;node_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_random</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_circular</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_shell</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">nlist</span><span class="o">=</span><span class="p">[</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)],</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_98_0.png" src="_images/networkx_98_0.png" />
<p>You can find additional options via <code class="docutils literal notranslate"><span class="pre">draw_networkx()</span></code> and layouts via
<code class="docutils literal notranslate"><span class="pre">layout</span></code>. You can use multiple shells with <code class="docutils literal notranslate"><span class="pre">draw_shell()</span></code>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">dodecahedral_graph</span><span class="p">()</span>
<span class="n">shells</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]]</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_shell</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">nlist</span><span class="o">=</span><span class="n">shells</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_100_0.png" src="_images/networkx_100_0.png" />
<p>To save drawings to a file, use, for example</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;path.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_102_0.png" src="_images/networkx_102_0.png" />
<p>writes to the file <code class="docutils literal notranslate"><span class="pre">path.png</span></code> in the local directory.</p>
<p>If Graphviz and PyGraphviz or pydot, are available on your system, you
can also use <code class="docutils literal notranslate"><span class="pre">nx_agraph.graphviz_layout(G)</span></code> or
<code class="docutils literal notranslate"><span class="pre">nx_pydot.graphviz_layout(G)</span></code> to get the node positions, or write the
graph in dot format for further processing.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">networkx.drawing.nx_pydot</span> <span class="kn">import</span> <span class="n">write_dot</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_agraph</span><span class="o">.</span><span class="n">graphviz_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">)</span>
<span class="n">write_dot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="s1">&#39;file.dot&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_105_0.png" src="_images/networkx_105_0.png" />
<p>See
<a class="reference external" href="https://networkx.github.io/documentation/stable/reference/drawing.html">Drawing</a>
for additional details.</p>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>A complete gallery of examples can be found at
<a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/index.html">https://networkx.github.io/documentation/stable/auto_examples/index.html</a></p>
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/basic/plot_read_write.html#sphx-glr-auto-examples-basic-plot-read-write-py">https://networkx.github.io/documentation/stable/auto_examples/basic/plot_read_write.html#sphx-glr-auto-examples-basic-plot-read-write-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Aric Hagberg (hagberg@lanl.gov)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">grid_2d_graph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5x5 grid</span>

<span class="c1"># print the adjacency list</span>
<span class="c1">#for line in nx.generate_adjlist(G):</span>
<span class="c1">#    print(line)</span>

<span class="c1"># write edgelist to grid.edgelist</span>
<span class="n">nx</span><span class="o">.</span><span class="n">write_edgelist</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;grid.edgelist&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<span class="c1"># read edgelist from grid.edgelist</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">read_edgelist</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;grid.edgelist&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/networkx_109_0.png" src="_images/networkx_109_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/basic/plot_properties.html#sphx-glr-auto-examples-basic-plot-properties-py">https://networkx.github.io/documentation/stable/auto_examples/basic/plot_properties.html#sphx-glr-auto-examples-basic-plot-properties-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">lollipop_graph</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="n">pathlengths</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;source vertex {target:length, }&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">():</span>
    <span class="n">spl</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">single_source_shortest_path_length</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">spl</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">spl</span><span class="p">:</span>
        <span class="n">pathlengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spl</span><span class="p">[</span><span class="n">p</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;average shortest path length </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
      <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pathlengths</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">pathlengths</span><span class="p">)))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="n">vertex</span> <span class="p">{</span><span class="n">target</span><span class="p">:</span><span class="n">length</span><span class="p">,</span> <span class="p">}</span>
<span class="mi">0</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="mi">1</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="mi">2</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="mi">3</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="mi">4</span> <span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="mi">5</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="mi">6</span> <span class="p">{</span><span class="mi">6</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="mi">7</span> <span class="p">{</span><span class="mi">7</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>
<span class="mi">8</span> <span class="p">{</span><span class="mi">8</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">6</span><span class="p">}</span>
<span class="mi">9</span> <span class="p">{</span><span class="mi">9</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>

<span class="n">average</span> <span class="n">shortest</span> <span class="n">path</span> <span class="n">length</span> <span class="mf">2.86</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># histogram of path lengths</span>
<span class="n">dist</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pathlengths</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">dist</span><span class="p">:</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;length #paths&quot;</span><span class="p">)</span>
<span class="n">verts</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">verts</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">dist</span><span class="p">[</span><span class="n">d</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="c1">#paths</span>
<span class="mi">0</span> <span class="mi">10</span>
<span class="mi">1</span> <span class="mi">24</span>
<span class="mi">2</span> <span class="mi">16</span>
<span class="mi">3</span> <span class="mi">14</span>
<span class="mi">4</span> <span class="mi">12</span>
<span class="mi">5</span> <span class="mi">10</span>
<span class="mi">6</span> <span class="mi">8</span>
<span class="mi">7</span> <span class="mi">6</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;radius: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">radius</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;diameter: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">diameter</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;eccentricity: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">eccentricity</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;center: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;periphery: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">periphery</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;density: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">nx</span><span class="o">.</span><span class="n">density</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">radius</span><span class="p">:</span> <span class="mi">4</span>
<span class="n">diameter</span><span class="p">:</span> <span class="mi">7</span>
<span class="n">eccentricity</span><span class="p">:</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">7</span><span class="p">}</span>
<span class="n">center</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">periphery</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">density</span><span class="p">:</span> <span class="mf">0.26666666666666666</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/networkx_114_0.png" src="_images/networkx_114_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_node_colormap.html#sphx-glr-auto-examples-drawing-plot-node-colormap-py">https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_node_colormap.html#sphx-glr-auto-examples-drawing-plot-node-colormap-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Aric Hagberg (hagberg@lanl.gov)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">cycle_graph</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>
        <span class="n">node_size</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/networkx_116_0.png" src="_images/networkx_116_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_edge_colormap.html#sphx-glr-auto-examples-drawing-plot-edge-colormap-py">https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_edge_colormap.html#sphx-glr-auto-examples-drawing-plot-edge-colormap-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Aric Hagberg (hagberg@lanl.gov)</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">star_graph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="n">colors</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;#A0CBE2&#39;</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">edge_cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/networkx_118_0.png" src="_images/networkx_118_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_spectral_grid.html#sphx-glr-auto-examples-drawing-plot-spectral-grid-py">https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_spectral_grid.html#sphx-glr-auto-examples-drawing-plot-spectral-grid-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;node_color&#39;</span><span class="p">:</span> <span class="s1">&#39;C0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;node_size&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">grid_2d_graph</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">332</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">334</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">335</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_120_0.png" src="_images/networkx_120_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">336</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">337</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">338</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>

<span class="n">G</span><span class="o">.</span><span class="n">remove_edge</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">339</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_spectral</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/networkx_121_0.png" src="_images/networkx_121_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_directed.html#sphx-glr-auto-examples-drawing-plot-directed-py">https://networkx.github.io/documentation/stable/auto_examples/drawing/plot_directed.html#sphx-glr-auto-examples-drawing-plot-directed-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Author: Rodrigo Dorantes-Gilardi (rodgdor@gmail.com)</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">generators</span><span class="o">.</span><span class="n">directed</span><span class="o">.</span><span class="n">random_k_out_graph</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">pos</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">spring_layout</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

<span class="n">node_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">))]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">()</span>
<span class="n">edge_colors</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">M</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">edge_alphas</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">5</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nodes</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">draw_networkx_edges</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="n">node_sizes</span><span class="p">,</span> <span class="n">arrowstyle</span><span class="o">=</span><span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
                               <span class="n">arrowsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">edge_colors</span><span class="p">,</span>
                               <span class="n">edge_cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># set alpha value for each edge</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="n">edges</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">edge_alphas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">pc</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">collections</span><span class="o">.</span><span class="n">PatchCollection</span><span class="p">(</span><span class="n">edges</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">)</span>
<span class="n">pc</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">edge_colors</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/networkx_124_0.png" src="_images/networkx_124_0.png" />
<p><a class="reference external" href="https://networkx.github.io/documentation/stable/auto_examples/graph/plot_roget.html#sphx-glr-auto-examples-graph-plot-roget-py">https://networkx.github.io/documentation/stable/auto_examples/graph/plot_roget.html#sphx-glr-auto-examples-graph-plot-roget-py</a></p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Brendt Wohlberg, Aric Hagberg (hagberg@lanl.gov)</span>

<span class="kn">import</span> <span class="nn">gzip</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">networkx</span> <span class="kn">import</span> <span class="n">nx</span>

<span class="k">def</span> <span class="nf">roget_graph</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Return the thesaurus graph from the roget.dat example in</span>
<span class="sd">    the Stanford Graph Base.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># open file roget_dat.txt.gz (or roget_dat.txt)</span>
    <span class="n">fh</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;roget_dat.txt.gz&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>

    <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fh</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">):</span>  <span class="c1"># skip comments</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">):</span>  <span class="c1"># this is a continuation line, append</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">oldline</span> <span class="o">+</span> <span class="n">line</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\n</span><span class="s2">&quot;</span><span class="p">):</span>  <span class="c1"># continuation line, buffer, goto next</span>
            <span class="n">oldline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">continue</span>

        <span class="p">(</span><span class="n">headname</span><span class="p">,</span> <span class="n">tails</span><span class="p">)</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>

        <span class="c1"># head</span>
        <span class="n">numfind</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;^\d+&quot;</span><span class="p">)</span>  <span class="c1"># re to find the number of this word</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">numfind</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">headname</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># get the number</span>

        <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">tail</span> <span class="ow">in</span> <span class="n">tails</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="n">tail</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;skipping self loop&quot;</span><span class="p">,</span> <span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">head</span><span class="p">,</span> <span class="n">tail</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">G</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">roget_graph</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loaded roget_dat.txt containing 1022 categories.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;digraph has </span><span class="si">%d</span><span class="s2"> nodes with </span><span class="si">%d</span><span class="s2"> edges&quot;</span>
      <span class="o">%</span> <span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">number_of_nodes</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="n">nx</span><span class="o">.</span><span class="n">number_of_edges</span><span class="p">(</span><span class="n">G</span><span class="p">)))</span>
<span class="n">UG</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">number_connected_components</span><span class="p">(</span><span class="n">UG</span><span class="p">),</span> <span class="s2">&quot;connected components&quot;</span><span class="p">)</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;node_color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
    <span class="s1">&#39;node_size&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;line_color&#39;</span><span class="p">:</span> <span class="s1">&#39;grey&#39;</span><span class="p">,</span>
    <span class="s1">&#39;linewidths&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw_circular</span><span class="p">(</span><span class="n">UG</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">skipping</span> <span class="bp">self</span> <span class="n">loop</span> <span class="mi">400</span> <span class="mi">400</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Loaded</span> <span class="n">roget_dat</span><span class="o">.</span><span class="n">txt</span> <span class="n">containing</span> <span class="mi">1022</span> <span class="n">categories</span><span class="o">.</span>
<span class="n">digraph</span> <span class="n">has</span> <span class="mi">1022</span> <span class="n">nodes</span> <span class="k">with</span> <span class="mi">5075</span> <span class="n">edges</span>
<span class="mi">21</span> <span class="n">connected</span> <span class="n">components</span>
</pre></div>
</div>
<img alt="_images/networkx_127_2.png" src="_images/networkx_127_2.png" />
</div>
</div>
<div class="section" id="tips-an-tricks">
<h1>Tips an’ Tricks<a class="headerlink" href="#tips-an-tricks" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. May 27, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract Some tips, tricks and gotchas, in particular.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;gotchas&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="tips-tricks-and-gotchas">
<h2>Tips, tricks and gotchas<a class="headerlink" href="#tips-tricks-and-gotchas" title="Permalink to this headline">¶</a></h2>
<p>This lecture addresses some gotchas that could arise in daily
programming; moreover, at the beginning we will introduce some helpful
objects that could make coding easier.</p>
<p>First of all, some imports as usual:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">Counter</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="a-grouping-pattern-avoiding-quadratic-time">
<h3>A grouping pattern, avoiding <em>quadratic</em> time<a class="headerlink" href="#a-grouping-pattern-avoiding-quadratic-time" title="Permalink to this headline">¶</a></h3>
<p>Assume to have two lists that have to be related in some way, namely
using a predicate <span class="math notranslate nohighlight">\(P\)</span>. In the following example we want to build a
list of all pairs (boy,girl) such that their names starts with the same
letter. Here the input:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">girls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alice&#39;</span><span class="p">,</span> <span class="s1">&#39;allie&#39;</span><span class="p">,</span> <span class="s1">&#39;bernice&#39;</span><span class="p">,</span> <span class="s1">&#39;brenda&#39;</span><span class="p">,</span> <span class="s1">&#39;clarice&#39;</span><span class="p">,</span> <span class="s1">&#39;cilly&#39;</span><span class="p">]</span>
<span class="n">boys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;chris&#39;</span><span class="p">,</span> <span class="s1">&#39;christopher&#39;</span><span class="p">,</span> <span class="s1">&#39;arald&#39;</span><span class="p">,</span> <span class="s1">&#39;arnold&#39;</span><span class="p">,</span> <span class="s1">&#39;bob&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>the bad way, quadratic time:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boys</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">girls</span> <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;chris&#39;</span><span class="p">,</span> <span class="s1">&#39;clarice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;chris&#39;</span><span class="p">,</span> <span class="s1">&#39;cilly&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;christopher&#39;</span><span class="p">,</span> <span class="s1">&#39;clarice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;christopher&#39;</span><span class="p">,</span> <span class="s1">&#39;cilly&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arald&#39;</span><span class="p">,</span> <span class="s1">&#39;alice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arald&#39;</span><span class="p">,</span> <span class="s1">&#39;allie&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arnold&#39;</span><span class="p">,</span> <span class="s1">&#39;alice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arnold&#39;</span><span class="p">,</span> <span class="s1">&#39;allie&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;bernice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;brenda&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>there is a better approach avoiding quadratic time, toward
<code class="docutils literal notranslate"><span class="pre">`defaultdict</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/library/collections.html#defaultdict-objects">https://docs.python.org/3/library/collections.html#defaultdict-objects</a>&gt;`__:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">letterGirls</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">girl</span> <span class="ow">in</span> <span class="n">girls</span><span class="p">:</span>
    <span class="n">letterGirls</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">girl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">girl</span><span class="p">)</span>

<span class="p">[(</span><span class="n">b</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boys</span> <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">letterGirls</span><span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;chris&#39;</span><span class="p">,</span> <span class="s1">&#39;clarice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;chris&#39;</span><span class="p">,</span> <span class="s1">&#39;cilly&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;christopher&#39;</span><span class="p">,</span> <span class="s1">&#39;clarice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;christopher&#39;</span><span class="p">,</span> <span class="s1">&#39;cilly&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arald&#39;</span><span class="p">,</span> <span class="s1">&#39;alice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arald&#39;</span><span class="p">,</span> <span class="s1">&#39;allie&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arnold&#39;</span><span class="p">,</span> <span class="s1">&#39;alice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;arnold&#39;</span><span class="p">,</span> <span class="s1">&#39;allie&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;bernice&#39;</span><span class="p">),</span>
 <span class="p">(</span><span class="s1">&#39;bob&#39;</span><span class="p">,</span> <span class="s1">&#39;brenda&#39;</span><span class="p">)]</span>
</pre></div>
</div>
<p>However there is an even better solution, as pointed out in the
<a class="reference external" href="https://docs.python.org/3/library/collections.html#defaultdict-examples">example</a>
subsection of the previous link: use <code class="docutils literal notranslate"><span class="pre">defaultdict</span></code> instead of
repeating call <code class="docutils literal notranslate"><span class="pre">setdefault</span></code> method for each new key. From the official
documentation:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="p">[(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-bunch-pattern">
<h3>The <em>Bunch</em> pattern<a class="headerlink" href="#the-bunch-pattern" title="Permalink to this headline">¶</a></h3>
<p>A very good book on algorithms implemented in Python is the one by
Magnus Hetland, <a class="reference external" href="https://www.apress.com/gp/book/9781484200568">https://www.apress.com/gp/book/9781484200568</a>, with the
companion Github repository
<a class="reference external" href="https://github.com/apress/python-algorithms-14">https://github.com/apress/python-algorithms-14</a>.</p>
<p>Hetland, pag. 34, propose the following pattern to build a container of
properties in order to avoid vanilla dict (adjusting from item 4.18 of
Alex Martelli’s <a class="reference external" href="http://shop.oreilly.com/product/9780596007973.do">Python
Cookbook</a>):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Bunch</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Bunch</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="bp">self</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">T</span> <span class="o">=</span> <span class="n">Bunch</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span> <span class="o">=</span> <span class="n">T</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">),</span> <span class="n">right</span><span class="o">=</span><span class="n">T</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="s2">&quot;c&quot;</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">left</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;left&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">:</span> <span class="s1">&#39;b&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="o">.</span><span class="n">left</span><span class="o">.</span><span class="n">right</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;b&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">t</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">][</span><span class="s1">&#39;right&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;b&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="s2">&quot;left&quot;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">right</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;right&quot;</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">right</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
<p>However, inheriting from <code class="docutils literal notranslate"><span class="pre">dict</span></code> is discouraged by Alex:</p>
<blockquote>
<div><p>A further tempting but not fully sound alternative is to have the
Bunch class inherit from <code class="docutils literal notranslate"><span class="pre">dict</span></code>, and set attribute access special
methods equal to the item access special methods, as follows:</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">DictBunch</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
    <span class="fm">__getattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span>
    <span class="fm">__setattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__setitem__</span>
    <span class="fm">__delattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__delitem__</span>
</pre></div>
</div>
<blockquote>
<div><p>One problem with this approach is that, with this definition, an
instance x of <code class="docutils literal notranslate"><span class="pre">DictBunch</span></code> has many attributes it doesn’t really
have, because it inherits all the attributes (methods, actually, but
there’s no significant difference in this context) of <code class="docutils literal notranslate"><span class="pre">dict</span></code>. So,
you can’t meaningfully check <code class="docutils literal notranslate"><span class="pre">hasattr(x,</span> <span class="pre">someattr)</span></code> , as you could
with the classes <code class="docutils literal notranslate"><span class="pre">Bunch</span></code> and <code class="docutils literal notranslate"><span class="pre">EvenSimplerBunch</span></code> (which sets the
dictionary directly, without using <code class="docutils literal notranslate"><span class="pre">update</span></code>) previously shown,
unless you can somehow rule out the value of someattr being any of
several common words such as <code class="docutils literal notranslate"><span class="pre">keys</span></code> , <code class="docutils literal notranslate"><span class="pre">pop</span></code> , and <code class="docutils literal notranslate"><span class="pre">get</span></code>.
Python’s distinction between attributes and items is really a
wellspring of clarity and simplicity. Unfortunately, many newcomers
to Python wrongly believe that it would be better to confuse items
with attributes, generally because of previous experience with
JavaScript and other such languages, in which attributes and items
are regularly confused. But educating newcomers is a much better idea
than promoting item/ attribute confusion.</p>
</div></blockquote>
<p>Alex original definition reads as follows:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Bunch</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds</span><span class="p">)</span>
</pre></div>
</div>
<p>It is interesting to observe that this idiom has been merged within the
<em>standard library</em>, starting from Python <strong>3.3</strong>, as with the name of
<code class="docutils literal notranslate"><span class="pre">`SimpleNamespace</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/library/types.html#types.SimpleNamespace">https://docs.python.org/3/library/types.html#types.SimpleNamespace</a>&gt;`__:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">SimpleNamespace</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span>
<span class="n">point</span> <span class="o">=</span> <span class="n">SimpleNamespace</span><span class="p">(</span><span class="n">datum</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>
<span class="n">point</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">namespace</span><span class="p">(</span><span class="n">datum</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span> <span class="n">squared</span><span class="o">=</span><span class="mi">4096</span><span class="p">,</span> <span class="n">coord</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">point</span><span class="o">.</span><span class="n">datum</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">squared</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">coord</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">4096</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">18</span><span class="o">-</span><span class="mi">70</span><span class="n">c474fd2112</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">point</span><span class="p">]</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="s1">&#39;types.SimpleNamespace&#39;</span> <span class="nb">object</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">iterable</span>
</pre></div>
</div>
<p>If you need <code class="docutils literal notranslate"><span class="pre">point</span></code> to be iterable use the structured object
<code class="docutils literal notranslate"><span class="pre">`namedtuple</span></code> &lt;<a class="reference external" href="https://docs.python.org/3/library/collections.html#collections.namedtuple">https://docs.python.org/3/library/collections.html#collections.namedtuple</a>&gt;`__
instead.</p>
</div>
<div class="section" id="pythons-list-append-isnt-lisps-cons">
<h3>Python’s <code class="docutils literal notranslate"><span class="pre">list.append</span></code> isn’t Lisp’s <code class="docutils literal notranslate"><span class="pre">cons</span></code><a class="headerlink" href="#pythons-list-append-isnt-lisps-cons" title="Permalink to this headline">¶</a></h3>
<p>Python <code class="docutils literal notranslate"><span class="pre">list</span></code> objects behave like <code class="docutils literal notranslate"><span class="pre">stack</span></code> objects, such that it is
<em>cheap</em> to <code class="docutils literal notranslate"><span class="pre">append</span></code> and <code class="docutils literal notranslate"><span class="pre">pop</span></code> at the <em>top</em>, which is the <em>right</em>
end. On the other hand, Lisp <code class="docutils literal notranslate"><span class="pre">pair</span></code> objects allows us to <em>easily</em>
<code class="docutils literal notranslate"><span class="pre">cons</span></code> on the <em>beginning</em>, the very <em>opposite</em> direction.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fast_countdown</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
    <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="n">nums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">nums</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nums</span>

<span class="k">def</span> <span class="nf">slow_countdown</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
    <span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="n">nums</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nums</span>

<span class="k">def</span> <span class="nf">printer</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">chunk</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">...</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst</span><span class="p">[:</span><span class="n">chunk</span><span class="p">])),</span>
                           <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">lst</span><span class="p">[</span><span class="o">-</span><span class="n">chunk</span><span class="p">:]))))</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> nums = fast_countdown(10**5)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>5.13 ms ± 118 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> nums = slow_countdown(10**5)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.61 s ± 13.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)
</pre></div>
</div>
<p>Citing Hetland, pag 11:</p>
<blockquote>
<div><p>Python lists aren’t really lists in the traditional computer science
sense of the word, and that explains the puzzle of why append is so
much more efficient than insert . A classical list - a so-called
linked list - is implemented as a series of nodes, each (except for
the last) keeping a reference to the next. The underlying
implementation of Python’s list type is a bit different. Instead of
several separate nodes referencing each other, a list is basically a
single, contiguous slab of memory - what is usually known as an
array. This leads to some important differences from linked lists.
For example, while iterating over the contents of the list is equally
efficient for both kinds (except for some overhead in the linked
list), directly accessing an element at a given index is much more
efficient in an array. This is because the position of the element
can be calculated, and the right memory location can be accessed
directly. In a linked list, however, one would have to traverse the
list from the beginning. The difference we’ve been bumping up
against, though, has to do with insertion. In a linked list, once you
know where you want to insert something, insertion is cheap; it takes
roughly the same amount of time, no matter how many elements the list
contains. That’s not the case with arrays: An insertion would have to
move all elements that are to the right of the insertion point,
possibly even moving all the elements to a larger array, if needed. A
specific solution for appending is to use what’s often called a
dynamic array, or vector. 4 The idea is to allocate an array that is
too big and then to reallocate it in linear time whenever it
overflows. It might seem that this makes the append just as bad as
the insert. In both cases, we risk having to move a large number of
elements. The main difference is that it happens less often with the
append. In fact, if we can ensure that we always move to an array
that is bigger than the last by a fixed percentage (say 20 percent or
even 100 percent), the average cost, amortized over many appends, is
constant.</p>
</div></blockquote>
<div class="section" id="enhance-with-deque-objects">
<h4>enhance with <code class="docutils literal notranslate"><span class="pre">deque</span></code> objects<a class="headerlink" href="#enhance-with-deque-objects" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">deque</span></code> implements <em>FIFO</em> queues: they are as cheap to append to the
right as a normal <code class="docutils literal notranslate"><span class="pre">list</span></code>, but enhance it to <em>cheaply</em> insert on the
<em>front</em> too.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="k">def</span> <span class="nf">enhanced_slow_countdown</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
    <span class="n">nums</span> <span class="o">=</span> <span class="n">deque</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="n">nums</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">nums</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> nums = enhanced_slow_countdown(10**5)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>5.19 ms ± 159 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
</div>
</div>
<div class="section" id="hidden-squares-concerning-lists-and-sets">
<h3>Hidden squares: concerning <code class="docutils literal notranslate"><span class="pre">list</span></code>s and <code class="docutils literal notranslate"><span class="pre">set</span></code>s<a class="headerlink" href="#hidden-squares-concerning-lists-and-sets" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>

<span class="n">max_value</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">checks</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="n">max_value</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">checks</span><span class="p">)]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> [randrange(max_value) in L for _ in range(checks)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>12.7 ms ± 644 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">L</span><span class="p">)</span> <span class="c1"># convert the list to a set object.</span>

<span class="o">%</span><span class="k">timeit</span> [randrange(max_value) in S for _ in range(checks)]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>439 µs ± 31.6 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<p>Hetland’s words, pag. 35:</p>
<blockquote>
<div><p>They’re both pretty fast, and it might seem pointless to create a set
from the list—unnecessary work, right? Well, it depends. If you’re
going to do many membership checks, it might pay off, because
membership checks are linear for lists and constant for sets. What
if, for example, you were to gradually add values to a collection and
for each step check whether the value was already added? […] Using a
list would give you quadratic running time, whereas using a set would
be linear. That’s a huge difference. <strong>The lesson is that it’s
important to pick the right built-in data structure for the job.</strong></p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lists</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">]]</span>
<span class="nb">sum</span><span class="p">(</span><span class="n">lists</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>Hetland, pag.36:</p>
<blockquote>
<div><p>This works, and it even looks rather elegant, but it really isn’t.
You see, under the covers, the sum function doesn’t know all too much
about what you’re summing, and it has to do one addition after
another. That way, you’re right back at the quadratic running time of
the += example for strings. Here’s a better way: Just try timing both
versions. As long as lists is pretty short, there won’t be much
difference, but it shouldn’t take long before the sum version is
thoroughly beaten.</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">lists</span><span class="p">:</span>
    <span class="n">res</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
<span class="n">res</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<p>try to do that with more populated lists…</p>
<div class="section" id="concerning-strings">
<h4>concerning <code class="docutils literal notranslate"><span class="pre">string</span></code>s<a class="headerlink" href="#concerning-strings" title="Permalink to this headline">¶</a></h4>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">string_producer</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it

<span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">string_producer</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">chunk</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>74.4 ms ± 5.29 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>maybe some optimization is performed because <code class="docutils literal notranslate"><span class="pre">s</span></code> is a <code class="docutils literal notranslate"><span class="pre">string</span></code>
object.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it

<span class="n">chunks</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">string_producer</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">chunks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>61.5 ms ± 1.27 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>a better approach using constant <code class="docutils literal notranslate"><span class="pre">append</span></code> to the top</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> s = &#39;&#39;.join(string_producer(10**5))
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>60.1 ms ± 2.26 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div>
</div>
<p>maybe a little better since it doesn’t loop with <code class="docutils literal notranslate"><span class="pre">for</span></code> explicitly.</p>
</div>
</div>
</div>
<div class="section" id="counting">
<h2>Counting<a class="headerlink" href="#counting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="max-permutation">
<h3>Max permutation<a class="headerlink" href="#max-permutation" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Eight persons with very particular tastes have bought tickets to the
movies. Some of them are happy with their seats, but most of them are
not. Let’s say each of them has a favorite seat, and you want to find
a way to let them switch seats to make as many people as possible
happy with the result. However, all of them refuse to move to another
seat if they can’t get their favorite.</p>
</div></blockquote>
<p>The following function <code class="docutils literal notranslate"><span class="pre">max_perm</span></code> computes the maximum permutation
that can be applied given a desired one; namely, it produces a new
permutation that moves as many elements as it can, in order to ensure
the <code class="docutils literal notranslate"><span class="pre">one-to-one</span></code> property – no one in the set points outside it, and
each seat (in the set) is pointed to exactly once. It can be seen as a
function that <em>fixes</em> a given permutation according to the required
behavior.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">perm_isomorphism</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">domain</span><span class="p">):</span>
    <span class="n">iso</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">enumerate</span><span class="p">(</span><span class="n">domain</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">iso</span><span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))]</span>

<span class="k">def</span> <span class="nf">fix_perm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">fix</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fix</span> <span class="k">else</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">))]</span>
</pre></div>
</div>
<p>The following is a naive implementation, recursive but in
<span class="math notranslate nohighlight">\(\mathcal{O}(n^{2})\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the permutation length.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">naive_max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Fix a permutation such that it is one-to-one and maximal, recursively.</span>

<span class="sd">    consumes:</span>
<span class="sd">    M - a permutation as a list of integers</span>
<span class="sd">    A - a set of positions allowed to move</span>

<span class="sd">    produces:</span>
<span class="sd">    a set `fix` such that makes M maximal, ensuring to be one-to-one</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">A</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">A</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)))</span> <span class="c1"># init to handle first invocation, all elems can move</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="n">A</span> <span class="c1"># recursion base, unary perm can move, trivial</span>

    <span class="n">B</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">A</span><span class="p">)</span> <span class="c1"># b in B iff b is desired by someone</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span> <span class="c1"># c in C iff c isn&#39;t desired, so discard it</span>
    <span class="k">return</span> <span class="n">naive_max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">A</span> <span class="o">-</span> <span class="n">C</span><span class="p">)</span> <span class="k">if</span> <span class="n">C</span> <span class="k">else</span> <span class="n">A</span> <span class="c1"># recur with desired position only</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">I</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># the identity permutation</span>
<span class="n">letters</span> <span class="o">=</span> <span class="s2">&quot;abcdefgh&quot;</span>
<span class="n">perm_isomorphism</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">letters</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">perm_isomorphism</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">letters</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="o">=</span> <span class="n">naive_max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">max_M</span> <span class="o">=</span> <span class="n">fix_perm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">fix</span><span class="p">)</span>
<span class="n">perm_isomorphism</span><span class="p">(</span><span class="n">max_M</span><span class="p">,</span> <span class="n">letters</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Hetland, pag. 78:</p>
<blockquote>
<div><p>The function <code class="docutils literal notranslate"><span class="pre">naive_max_perm</span></code> receives a set <code class="docutils literal notranslate"><span class="pre">A</span></code> of remaining
people and creates a set <code class="docutils literal notranslate"><span class="pre">B</span></code> of seats that are pointed to. If it
finds an element in <code class="docutils literal notranslate"><span class="pre">A</span></code> that is not in <code class="docutils literal notranslate"><span class="pre">B</span></code>, it removes the
element and solves the remaining problem recursively. Let’s use the
implementation on our example, M = <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">2,</span> <span class="pre">0,</span> <span class="pre">5,</span> <span class="pre">3,</span> <span class="pre">5,</span> <span class="pre">7,</span> <span class="pre">4]</span></code>:</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">naive_max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> {0, 2, 5}



So, a, c, and f can take part in the permutation. The others will
have to sit in nonfavorite seats. The implementation isn’t too bad.
The handy set type lets us manipulate sets with ready-made high-level
operations, rather than having to implement them ourselves. There are
some problems, though. For one thing, we might want an iterative
solution. […] A worse problem, though, is that the algorithm is
quadratic! (Exercise 4-10 asks you to show this.) The most wasteful
operation is the repeated creation of the set B. If we could just
keep track of which chairs are no longer pointed to, we could
eliminate this operation entirely. One way of doing this would be to
keep a count for each element. We could decrement the count for chair
x when a person pointing to x is eliminated, and if x ever got a
count of zero, both person and chair x would be out of the game.
&gt;This idea of reference counting can be useful in general. It is, for
example, a basic component in many systems for garbage collection (a
form of memory management that automatically deallocates objects that
are no longer useful). You’ll see this technique again in the
discussion of topological sorting.

There may be more than one element to be eliminated at any one time,
but we can just put any new ones we come across into a “to-do” list
and deal with them later. If we needed to make sure the elements were
eliminated in the order in which we discover that they’re no longer
useful, we would need to use a first-in, first-out queue such as the
deque class (discussed in Chapter 5). We don’t really care, so we
could use a set, for example, but just appending to and popping from
a list will probably give us quite a bit less overhead. But feel free
to experiment, of course.
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c1"># How many elements?</span>
    <span class="n">A</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="c1"># A = {0, 1, ... , n-1}</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="c1"># desired positions by frequencies</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">A</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="c1"># useless elements</span>
    <span class="k">while</span> <span class="n">Q</span><span class="p">:</span> <span class="c1"># While useless elts. left...</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c1"># get one of them</span>
        <span class="n">A</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="c1"># remove it from the maximal permutation</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># get its desired position</span>
        <span class="n">count</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span> <span class="c1"># and release it for someone else</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">count</span><span class="p">[</span><span class="n">j</span><span class="p">]:</span> <span class="c1"># if such position isn&#39;t desired anymore</span>
            <span class="n">Q</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="c1"># enqueue such position in order to discard it</span>
    <span class="k">return</span> <span class="n">A</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fix</span> <span class="o">=</span> <span class="n">max_perm</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="n">max_M</span> <span class="o">=</span> <span class="n">fix_perm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">fix</span><span class="p">)</span>
<span class="n">perm_isomorphism</span><span class="p">(</span><span class="n">max_M</span><span class="p">,</span> <span class="n">letters</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;h&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="counting-sort">
<h3>Counting Sort<a class="headerlink" href="#counting-sort" title="Permalink to this headline">¶</a></h3>
<p>Hetland, pag 85:</p>
<blockquote>
<div><p>By default, I’m just sorting objects based on their values. By
supplying a key function, you can sort by anything you’d like. Note
that the keys must be integers in a limited range. If this range is
<span class="math notranslate nohighlight">\(0\ldots k-1\)</span>, running time is then <span class="math notranslate nohighlight">\(\mathcal{O}(n + k)\)</span>.
(Note that although the common implementation simply counts the
elements and then figures out where to put them in <code class="docutils literal notranslate"><span class="pre">B</span></code>, Python
makes it easy to just build value lists for each key and then
concatenate them.) If several values have the same key, they’ll end
up in the original order with respect to each other. Sorting
algorithms with this property are called <em>stable</em>.</p>
</div></blockquote>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">counting_sort</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sort_boundary</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sorts the given collection A in linear time, assuming their elements are hashable.</span>

<span class="sd">    This implementation implements a vanilla counting sort, working in linear time respect</span>
<span class="sd">    iterable length and spacing between objects. It works best if elements are evenly, namely</span>
<span class="sd">    *uniformly* distributed in the domain; on contrast, if they are sparse and concentrated</span>
<span class="sd">    near accumulation points, traversing distances between them is time consuming.</span>

<span class="sd">    If `sort_boundary` is instantiated to a float within [0,1], then the domain is ordered</span>
<span class="sd">    using a classic loglinear algorithm before building the result.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span>

    <span class="n">B</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">A</span><span class="p">:</span>
        <span class="n">C</span><span class="p">[</span><span class="n">key</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">domain</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>  <span class="k">if</span> <span class="n">sort_boundary</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="n">sort_boundary</span> \
                        <span class="k">else</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">C</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">domain</span><span class="p">:</span>
        <span class="n">B</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">B</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">randrange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)]</span>

<span class="k">assert</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="n">counting_sort</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;elements&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequencies&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/gotchas_75_0.png" src="_images/gotchas_75_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> counting_sort(A)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>219 µs ± 10.7 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> counting_sort(A, sort_boundary=1)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>206 µs ± 8.96 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="p">([</span><span class="n">randrange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)]</span> <span class="o">+</span>
     <span class="p">[</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="n">randrange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;elements&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequencies&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/gotchas_79_0.png" src="_images/gotchas_79_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">counting_sort</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> counting_sort(B)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>2.01 ms ± 136 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">timeit</span> counting_sort(B, sort_boundary=1/8)
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>247 µs ± 20.4 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="generators">
<h1>Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h1>
<p><div class="docutils container">
<p>Massimo Nocentini, PhD. May 28, 2020: init</p>
</div>
</p><div class="docutils container">
<p>Abstract A (very concise) introduction to some Python language
constructs.</p>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__AUTHORS__</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;am&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Andrea Marino&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;andrea.marino@unifi.it&quot;</span><span class="p">,),</span>
               <span class="s1">&#39;mn&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;Massimo Nocentini&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;massimo.nocentini@unifi.it&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;https://github.com/massimo-nocentini/&quot;</span><span class="p">,)}</span>

<span class="n">__KEYWORDS__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Python&#39;</span><span class="p">,</span> <span class="s1">&#39;Jupyter&#39;</span><span class="p">,</span> <span class="s1">&#39;language&#39;</span><span class="p">,</span> <span class="s1">&#39;keynote&#39;</span><span class="p">,]</span>
</pre></div>
</div>
<center></center><div class="section" id="the-python-language-documentation">
<h2>The Python language documentation<a class="headerlink" href="#the-python-language-documentation" title="Permalink to this headline">¶</a></h2>
<p>Start at <a class="reference external" href="https://docs.python.org/3/index.html">https://docs.python.org/3/index.html</a> for everything.</p>
<p>For the tutorial have a look at
<a class="reference external" href="https://docs.python.org/3/tutorial/index.html">https://docs.python.org/3/tutorial/index.html</a>, nicely written and
complete.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">increment</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">increment</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">L</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LL</span> <span class="o">=</span> <span class="p">[</span><span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
<span class="n">LL</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">LLL</span> <span class="o">=</span> <span class="p">[</span><span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">LL</span><span class="p">]</span>
<span class="n">LLL</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">r</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">map</span> <span class="n">at</span> <span class="mh">0x7f0590b631c0</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">map</span> <span class="n">at</span> <span class="mh">0x7f0590b630d0</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">6</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">7</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">8</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">9</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">StopIteration</span>                             <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">96</span><span class="o">-</span><span class="mf">0666361e9047</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="nb">next</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>


<span class="ne">StopIteration</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">N</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span> <span class="o">&lt;</span><span class="n">genexpr</span><span class="o">&gt;</span> <span class="n">at</span> <span class="mh">0x7f0568ef1040</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">StopIteration</span>                             <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">103</span><span class="o">-</span><span class="mi">0</span><span class="n">f4723c98d79</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="nb">next</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>


<span class="ne">StopIteration</span><span class="p">:</span>
</pre></div>
</div>
<p>we want to build an object that denotes a Bernoulli random variable.</p>
<p>it is desired to be able to sample from that variable an arbitrary
number of times, not known at design time.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span> <span class="c1"># import the random generator, to be used to sample from the uniform distribution</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="p">()</span> <span class="c1"># a quick check that the random function works</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.03068991525009368</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">int</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># this is a very quick check to see if a Boolean can be used as integer</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Bernoulli</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="s1">&#39;This is a generator for a Bernoulli random variable of parameter `p` for success.&#39;</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>              <span class="c1"># forever we loop</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>         <span class="c1"># get a sample</span>
        <span class="k">yield</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">)</span>    <span class="c1"># if that sample denotes a success or a failure we *yield* that outcome</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">yield</span> <span class="c1"># if we evaluate *yield* not in a context, Python raises an error because it is a construct</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">File</span> <span class="s2">&quot;&lt;ipython-input-112-f8373fab0a85&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span>
    <span class="k">yield</span> <span class="c1"># if we evaluate *yield* not in a context, Python raises an error because it is a construct</span>
    <span class="o">^</span>
<span class="ne">SyntaxError</span><span class="p">:</span> <span class="s1">&#39;yield&#39;</span> <span class="n">outside</span> <span class="n">function</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">Bernoulli</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Help on function Bernoulli in module __main__:

Bernoulli(p)
    This is a generator for a Bernoulli random variable of parameter <cite>p</cite> for success.</pre>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">Bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span> <span class="c1"># B is our random variable</span>
<span class="n">B</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">generator</span> <span class="nb">object</span> <span class="n">Bernoulli</span> <span class="n">at</span> <span class="mh">0x7f0568d4cf20</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">sample</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="c1"># just for a quick evaluation, we print the first 20 elements</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">579</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_flip</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">o</span><span class="p">:</span> <span class="mi">1</span><span class="o">-</span><span class="n">o</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="n">B_flip</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">map</span> <span class="n">at</span> <span class="mh">0x7f0568efe040</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">B_flip</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="n">sample</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span> <span class="c1"># just for a quick evaluation, we print the first 20 elements</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Bernoulli</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="s1">&#39;This is a generator for a Bernoulli random variable of parameter `p` for success.&#39;</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>              <span class="c1"># forever we loop</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>         <span class="c1"># get a sample</span>
        <span class="n">o</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">r</span> <span class="o">&lt;=</span> <span class="n">p</span><span class="p">)</span>      <span class="c1"># if that sample denotes a success or a failure we *yield* that outcome</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">))</span>
        <span class="k">yield</span> <span class="n">o</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">flip</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;flip&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">-</span><span class="n">o</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_flip</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">flip</span><span class="p">,</span> <span class="n">Bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.9</span><span class="p">))</span>
<span class="n">B_flip</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nb">map</span> <span class="n">at</span> <span class="mh">0x7f0568ef89a0</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">B_flip</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="n">Counter</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="mi">0</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">0</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
<span class="n">B</span> <span class="mi">1</span>
<span class="n">flip</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Counter</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">18</span><span class="p">})</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">+</span> <span class="n">i</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">function</span> <span class="n">__main__</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">b</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">increment</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">5</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">143</span><span class="o">-</span><span class="n">a46ef281d6c6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
      <span class="mi">1</span> <span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>


<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">69</span><span class="o">-</span><span class="n">d2b3a35173e0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
      <span class="mi">1</span> <span class="k">def</span> <span class="nf">increment</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">2</span>     <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">+</span><span class="p">:</span> <span class="s1">&#39;A&#39;</span> <span class="ow">and</span> <span class="s1">&#39;int&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">increment</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">TypeError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mi">087</span><span class="n">a68ad802d</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>


<span class="ne">TypeError</span><span class="p">:</span> <span class="n">unsupported</span> <span class="n">operand</span> <span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="k">for</span> <span class="o">+</span><span class="p">:</span> <span class="s1">&#39;int&#39;</span> <span class="ow">and</span> <span class="s1">&#39;A&#39;</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="n">A</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">False</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#past-and-present">past and present</a></li>
<li><a class="reference internal" href="#beware-of-shadows">beware of shadows</a></li>
<li><a class="reference internal" href="#welcome-to-the-carousel">welcome to the carousel</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jupyter-notebooks">Jupyter notebooks</a><ul>
<li><a class="reference internal" href="#ipython-beyond-normal-python">IPython: Beyond Normal Python</a><ul>
<li><a class="reference internal" href="#shell-or-notebook">Shell or Notebook?</a><ul>
<li><a class="reference internal" href="#launching-the-ipython-shell">Launching the IPython Shell</a></li>
<li><a class="reference internal" href="#launching-the-jupyter-notebook">Launching the Jupyter Notebook</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#help-and-documentation-in-ipython">Help and Documentation in IPython</a><ul>
<li><a class="reference internal" href="#accessing-documentation-with">Accessing Documentation with <code class="docutils literal notranslate"><span class="pre">?</span></code></a></li>
<li><a class="reference internal" href="#accessing-source-code-with">Accessing Source Code with <code class="docutils literal notranslate"><span class="pre">??</span></code></a></li>
<li><a class="reference internal" href="#exploring-modules-with-tab-completion">Exploring Modules with Tab-Completion</a><ul>
<li><a class="reference internal" href="#tab-completion-of-object-contents">Tab-completion of object contents</a></li>
<li><a class="reference internal" href="#tab-completion-when-importing">Tab completion when importing</a></li>
<li><a class="reference internal" href="#beyond-tab-completion-wildcard-matching">Beyond tab completion: wildcard matching</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ipython-magic-commands">IPython Magic Commands</a><ul>
<li><a class="reference internal" href="#running-external-code-run">Running External Code: <code class="docutils literal notranslate"><span class="pre">%run</span></code></a></li>
<li><a class="reference internal" href="#timing-code-execution-timeit">Timing Code Execution: <code class="docutils literal notranslate"><span class="pre">%timeit</span></code></a></li>
<li><a class="reference internal" href="#help-on-magic-functions-magic-and-lsmagic">Help on Magic Functions: <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">%magic</span></code>, and <code class="docutils literal notranslate"><span class="pre">%lsmagic</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#input-and-output-history">Input and Output History</a><ul>
<li><a class="reference internal" href="#ipythons-in-and-out-objects">IPython’s <code class="docutils literal notranslate"><span class="pre">In</span></code> and <code class="docutils literal notranslate"><span class="pre">Out</span></code> Objects</a></li>
<li><a class="reference internal" href="#underscore-shortcuts-and-previous-outputs">Underscore Shortcuts and Previous Outputs</a></li>
<li><a class="reference internal" href="#suppressing-output">Suppressing Output</a></li>
<li><a class="reference internal" href="#related-magic-commands">Related Magic Commands</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ipython-and-shell-commands">IPython and Shell Commands</a><ul>
<li><a class="reference internal" href="#quick-introduction-to-the-shell">Quick Introduction to the Shell</a></li>
<li><a class="reference internal" href="#shell-commands-in-ipython">Shell Commands in IPython</a></li>
<li><a class="reference internal" href="#passing-values-to-and-from-the-shell">Passing Values to and from the Shell</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors-and-debugging">Errors and Debugging</a><ul>
<li><a class="reference internal" href="#controlling-exceptions-xmode">Controlling Exceptions: <code class="docutils literal notranslate"><span class="pre">%xmode</span></code></a></li>
<li><a class="reference internal" href="#debugging-when-reading-tracebacks-is-not-enough">Debugging: When Reading Tracebacks Is Not Enough</a><ul>
<li><a class="reference internal" href="#partial-list-of-debugging-commands">Partial list of debugging commands</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#profiling-and-timing-code">Profiling and Timing Code</a><ul>
<li><a class="reference internal" href="#timing-code-snippets-timeit-and-time">Timing Code Snippets: <code class="docutils literal notranslate"><span class="pre">%timeit</span></code> and <code class="docutils literal notranslate"><span class="pre">%time</span></code></a></li>
<li><a class="reference internal" href="#profiling-full-scripts-prun">Profiling Full Scripts: <code class="docutils literal notranslate"><span class="pre">%prun</span></code></a></li>
<li><a class="reference internal" href="#line-by-line-profiling-with-lprun">Line-By-Line Profiling with <code class="docutils literal notranslate"><span class="pre">%lprun</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#line-hits-time-per-hit-time-line-contents">Line # Hits Time Per Hit % Time Line Contents</a><ul>
<li><a class="reference internal" href="#profiling-memory-use-memit-and-mprun">Profiling Memory Use: <code class="docutils literal notranslate"><span class="pre">%memit</span></code> and <code class="docutils literal notranslate"><span class="pre">%mprun</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#line-mem-usage-increment-line-contents">Line # Mem usage Increment Line Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#numpy-module"><code class="docutils literal notranslate"><span class="pre">numpy</span></code> module</a><ul>
<li><a class="reference internal" href="#introduction-to-numpy">Introduction to NumPy</a></li>
<li><a class="reference internal" href="#understanding-data-types-in-python">Understanding Data Types in Python</a><ul>
<li><a class="reference internal" href="#creating-arrays-from-python-lists">Creating Arrays from Python Lists</a></li>
<li><a class="reference internal" href="#creating-arrays-from-scratch">Creating Arrays from Scratch</a></li>
<li><a class="reference internal" href="#numpy-standard-data-types">NumPy Standard Data Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-basics-of-numpy-arrays">The Basics of NumPy Arrays</a><ul>
<li><a class="reference internal" href="#numpy-array-attributes">NumPy Array Attributes</a></li>
<li><a class="reference internal" href="#array-indexing-accessing-single-elements">Array Indexing: Accessing Single Elements</a></li>
<li><a class="reference internal" href="#array-slicing-accessing-subarrays">Array Slicing: Accessing Subarrays</a><ul>
<li><a class="reference internal" href="#one-dimensional-subarrays">One-dimensional subarrays</a></li>
<li><a class="reference internal" href="#multi-dimensional-subarrays">Multi-dimensional subarrays</a><ul>
<li><a class="reference internal" href="#accessing-array-rows-and-columns">Accessing array rows and columns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#subarrays-as-no-copy-views">Subarrays as no-copy views</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reshaping-of-arrays">Reshaping of Arrays</a><ul>
<li><a class="reference internal" href="#concatenation-of-arrays">Concatenation of arrays</a></li>
<li><a class="reference internal" href="#splitting-of-arrays">Splitting of arrays</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#computation-on-numpy-arrays-universal-functions">Computation on NumPy Arrays: Universal Functions</a><ul>
<li><a class="reference internal" href="#the-slowness-of-loops">The Slowness of Loops</a></li>
<li><a class="reference internal" href="#introducing-ufuncs">Introducing UFuncs</a><ul>
<li><a class="reference internal" href="#array-arithmetic">Array arithmetic</a></li>
<li><a class="reference internal" href="#trigonometric-functions">Trigonometric functions</a></li>
<li><a class="reference internal" href="#exponents-and-logarithms">Exponents and logarithms</a></li>
<li><a class="reference internal" href="#specifying-output">Specifying output</a></li>
<li><a class="reference internal" href="#outer-products">Outer products</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#aggregations-min-max-and-everything-in-between">Aggregations: Min, Max, and Everything In Between</a><ul>
<li><a class="reference internal" href="#summing-the-values-in-an-array">Summing the Values in an Array</a></li>
<li><a class="reference internal" href="#minimum-and-maximum">Minimum and Maximum</a><ul>
<li><a class="reference internal" href="#multi-dimensional-aggregates">Multi dimensional aggregates</a></li>
<li><a class="reference internal" href="#other-aggregation-functions">Other aggregation functions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#computation-on-arrays-broadcasting">Computation on Arrays: Broadcasting</a><ul>
<li><a class="reference internal" href="#introducing-broadcasting">Introducing Broadcasting</a></li>
<li><a class="reference internal" href="#rules-of-broadcasting">Rules of Broadcasting</a><ul>
<li><a class="reference internal" href="#centering-an-array">Centering an array</a></li>
<li><a class="reference internal" href="#plotting-a-two-dimensional-function">Plotting a two-dimensional function</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#comparisons-masks-and-boolean-logic">Comparisons, Masks, and Boolean Logic</a><ul>
<li><a class="reference internal" href="#comparison-operators-as-ufuncs">Comparison Operators as ufuncs</a><ul>
<li><a class="reference internal" href="#counting-entries">Counting entries</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boolean-arrays-as-masks">Boolean Arrays as Masks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fancy-indexing">Fancy Indexing</a><ul>
<li><a class="reference internal" href="#combined-indexing">Combined Indexing</a></li>
<li><a class="reference internal" href="#example-selecting-random-points">Example: Selecting Random Points</a></li>
<li><a class="reference internal" href="#modifying-values-with-fancy-indexing">Modifying Values with Fancy Indexing</a></li>
<li><a class="reference internal" href="#example-binning-data">Example: Binning Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sorting-arrays">Sorting Arrays</a><ul>
<li><a class="reference internal" href="#fast-sorting-in-numpy-np-sort-and-np-argsort">Fast Sorting in NumPy: <code class="docutils literal notranslate"><span class="pre">np.sort</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argsort</span></code></a><ul>
<li><a class="reference internal" href="#sorting-along-rows-or-columns">Sorting along rows or columns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#partial-sorts-partitioning">Partial Sorts: Partitioning</a></li>
<li><a class="reference internal" href="#example-k-nearest-neighbors">Example: k-Nearest Neighbors</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pandas-module"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> module</a><ul>
<li><a class="reference internal" href="#introducing-pandas-objects">Introducing Pandas Objects</a><ul>
<li><a class="reference internal" href="#the-pandas-series-object">The Pandas Series Object</a><ul>
<li><a class="reference internal" href="#series-as-generalized-numpy-array"><code class="docutils literal notranslate"><span class="pre">Series</span></code> as generalized NumPy array</a></li>
<li><a class="reference internal" href="#series-as-specialized-dictionary">Series as specialized dictionary</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-pandas-dataframe-object">The Pandas DataFrame Object</a><ul>
<li><a class="reference internal" href="#dataframe-as-a-generalized-numpy-array">DataFrame as a generalized NumPy array</a></li>
<li><a class="reference internal" href="#dataframe-as-specialized-dictionary">DataFrame as specialized dictionary</a></li>
<li><a class="reference internal" href="#constructing-dataframe-objects">Constructing DataFrame objects</a><ul>
<li><a class="reference internal" href="#from-a-single-series-object">From a single Series object</a></li>
<li><a class="reference internal" href="#from-a-list-of-dicts">From a list of dicts</a></li>
<li><a class="reference internal" href="#from-a-two-dimensional-numpy-array">From a two-dimensional NumPy array</a></li>
<li><a class="reference internal" href="#from-a-numpy-structured-array">From a NumPy structured array</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#the-pandas-index-object">The Pandas Index Object</a><ul>
<li><a class="reference internal" href="#index-as-immutable-array">Index as immutable array</a></li>
<li><a class="reference internal" href="#index-as-ordered-set">Index as ordered set</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#data-indexing-and-selection">Data Indexing and Selection</a><ul>
<li><a class="reference internal" href="#data-selection-in-series">Data Selection in Series</a><ul>
<li><a class="reference internal" href="#series-as-dictionary">Series as dictionary</a></li>
<li><a class="reference internal" href="#series-as-one-dimensional-array">Series as one-dimensional array</a></li>
<li><a class="reference internal" href="#indexers-loc-iloc-and-ix">Indexers: loc, iloc, and ix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-selection-in-dataframe">Data Selection in DataFrame</a><ul>
<li><a class="reference internal" href="#dataframe-as-two-dimensional-array">DataFrame as two-dimensional array</a></li>
<li><a class="reference internal" href="#additional-indexing-conventions">Additional indexing conventions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#operating-on-data-in-pandas">Operating on Data in Pandas</a><ul>
<li><a class="reference internal" href="#ufuncs-index-preservation">Ufuncs: Index Preservation</a></li>
<li><a class="reference internal" href="#ufuncs-index-alignment">UFuncs: Index Alignment</a><ul>
<li><a class="reference internal" href="#index-alignment-in-series">Index alignment in Series</a></li>
<li><a class="reference internal" href="#index-alignment-in-dataframe">Index alignment in DataFrame</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ufuncs-operations-between-dataframe-and-series">Ufuncs: Operations Between DataFrame and Series</a></li>
</ul>
</li>
<li><a class="reference internal" href="#handling-missing-data">Handling Missing Data</a><ul>
<li><a class="reference internal" href="#trade-offs-in-missing-data-conventions">Trade-Offs in Missing Data Conventions</a></li>
<li><a class="reference internal" href="#missing-data-in-pandas">Missing Data in Pandas</a><ul>
<li><a class="reference internal" href="#none-pythonic-missing-data"><code class="docutils literal notranslate"><span class="pre">None</span></code>: Pythonic missing data</a></li>
<li><a class="reference internal" href="#nan-missing-numerical-data"><code class="docutils literal notranslate"><span class="pre">NaN</span></code>: Missing numerical data</a></li>
<li><a class="reference internal" href="#nan-and-none-in-pandas">NaN and None in Pandas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#operating-on-null-values">Operating on Null Values</a><ul>
<li><a class="reference internal" href="#detecting-null-values">Detecting null values</a></li>
<li><a class="reference internal" href="#dropping-null-values">Dropping null values</a></li>
<li><a class="reference internal" href="#filling-null-values">Filling null values</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#hierarchical-indexing">Hierarchical Indexing</a><ul>
<li><a class="reference internal" href="#a-multiply-indexed-series">A Multiply Indexed Series</a><ul>
<li><a class="reference internal" href="#the-bad-way">The bad way</a></li>
<li><a class="reference internal" href="#the-better-way-pandas-multiindex">The Better Way: Pandas MultiIndex</a></li>
<li><a class="reference internal" href="#multiindex-as-extra-dimension">MultiIndex as extra dimension</a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods-of-multiindex-creation">Methods of MultiIndex Creation</a><ul>
<li><a class="reference internal" href="#explicit-multiindex-constructors">Explicit MultiIndex constructors</a></li>
<li><a class="reference internal" href="#multiindex-level-names">MultiIndex level names</a></li>
<li><a class="reference internal" href="#multiindex-for-columns">MultiIndex for columns</a></li>
</ul>
</li>
<li><a class="reference internal" href="#indexing-and-slicing-a-multiindex">Indexing and Slicing a MultiIndex</a><ul>
<li><a class="reference internal" href="#multiply-indexed-series">Multiply indexed Series</a></li>
<li><a class="reference internal" href="#multiply-indexed-dataframes">Multiply indexed DataFrames</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rearranging-multi-indices">Rearranging Multi-Indices</a><ul>
<li><a class="reference internal" href="#sorted-and-unsorted-indices">Sorted and unsorted indices</a></li>
<li><a class="reference internal" href="#stacking-and-unstacking-indices">Stacking and unstacking indices</a></li>
<li><a class="reference internal" href="#index-setting-and-resetting">Index setting and resetting</a></li>
</ul>
</li>
<li><a class="reference internal" href="#data-aggregations-on-multi-indices">Data Aggregations on Multi-Indices</a></li>
</ul>
</li>
<li><a class="reference internal" href="#combining-datasets-concat-and-append">Combining Datasets: Concat and Append</a><ul>
<li><a class="reference internal" href="#simple-concatenation-with-pd-concat">Simple Concatenation with <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code></a><ul>
<li><a class="reference internal" href="#duplicate-indices">Duplicate indices</a><ul>
<li><a class="reference internal" href="#ignoring-the-index">Ignoring the index</a></li>
<li><a class="reference internal" href="#adding-multiindex-keys">Adding MultiIndex keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#concatenation-with-joins">Concatenation with joins</a></li>
<li><a class="reference internal" href="#the-append-method">The <code class="docutils literal notranslate"><span class="pre">append()</span></code> method</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#combining-datasets-merge-and-join">Combining Datasets: Merge and Join</a><ul>
<li><a class="reference internal" href="#relational-algebra">Relational Algebra</a></li>
<li><a class="reference internal" href="#categories-of-joins">Categories of Joins</a><ul>
<li><a class="reference internal" href="#one-to-one-joins">One-to-one joins</a></li>
<li><a class="reference internal" href="#many-to-one-joins">Many-to-one joins</a></li>
<li><a class="reference internal" href="#many-to-many-joins">Many-to-many joins</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specification-of-the-merge-key">Specification of the Merge Key</a><ul>
<li><a class="reference internal" href="#the-on-keyword">The <code class="docutils literal notranslate"><span class="pre">on</span></code> keyword</a></li>
<li><a class="reference internal" href="#the-left-on-and-right-on-keywords">The <code class="docutils literal notranslate"><span class="pre">left_on</span></code> and <code class="docutils literal notranslate"><span class="pre">right_on</span></code> keywords</a></li>
<li><a class="reference internal" href="#the-left-index-and-right-index-keywords">The <code class="docutils literal notranslate"><span class="pre">left_index</span></code> and <code class="docutils literal notranslate"><span class="pre">right_index</span></code> keywords</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specifying-set-arithmetic-for-joins">Specifying Set Arithmetic for Joins</a></li>
<li><a class="reference internal" href="#overlapping-column-names-the-suffixes-keyword">Overlapping Column Names: The <code class="docutils literal notranslate"><span class="pre">suffixes</span></code> Keyword</a></li>
<li><a class="reference internal" href="#example-us-states-data">Example: US States Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aggregation-and-grouping">Aggregation and Grouping</a><ul>
<li><a class="reference internal" href="#planets-data">Planets Data</a></li>
<li><a class="reference internal" href="#simple-aggregation-in-pandas">Simple Aggregation in Pandas</a></li>
<li><a class="reference internal" href="#groupby-split-apply-combine">GroupBy: Split, Apply, Combine</a><ul>
<li><a class="reference internal" href="#split-apply-combine">Split, apply, combine</a></li>
<li><a class="reference internal" href="#the-groupby-object">The GroupBy object</a><ul>
<li><a class="reference internal" href="#column-indexing">Column indexing</a></li>
<li><a class="reference internal" href="#iteration-over-groups">Iteration over groups</a></li>
<li><a class="reference internal" href="#dispatch-methods">Dispatch methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aggregate-filter-transform-apply">Aggregate, filter, transform, apply</a><ul>
<li><a class="reference internal" href="#aggregation">Aggregation</a></li>
<li><a class="reference internal" href="#filtering">Filtering</a></li>
<li><a class="reference internal" href="#transformation">Transformation</a></li>
<li><a class="reference internal" href="#the-apply-method">The apply() method</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specifying-the-split-key">Specifying the split key</a><ul>
<li><a class="reference internal" href="#a-list-array-series-or-index-providing-the-grouping-keys">A list, array, series, or index providing the grouping keys</a></li>
<li><a class="reference internal" href="#a-dictionary-or-series-mapping-index-to-group">A dictionary or series mapping index to group</a></li>
<li><a class="reference internal" href="#any-python-function">Any Python function</a></li>
<li><a class="reference internal" href="#a-list-of-valid-keys">A list of valid keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#grouping-example">Grouping example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pivot-tables">Pivot Tables</a><ul>
<li><a class="reference internal" href="#motivating-pivot-tables">Motivating Pivot Tables</a></li>
<li><a class="reference internal" href="#pivot-tables-by-hand">Pivot Tables by Hand</a></li>
<li><a class="reference internal" href="#pivot-table-syntax">Pivot Table Syntax</a><ul>
<li><a class="reference internal" href="#multi-level-pivot-tables">Multi-level pivot tables</a></li>
<li><a class="reference internal" href="#additional-pivot-table-options">Additional pivot table options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-birthrate-data">Example: Birthrate Data</a><ul>
<li><a class="reference internal" href="#further-data-exploration">Further data exploration</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-time-series">Working with Time Series</a><ul>
<li><a class="reference internal" href="#dates-and-times-in-python">Dates and Times in Python</a><ul>
<li><a class="reference internal" href="#native-python-dates-and-times-datetime-and-dateutil">Native Python dates and times: <code class="docutils literal notranslate"><span class="pre">datetime</span></code> and <code class="docutils literal notranslate"><span class="pre">dateutil</span></code></a></li>
<li><a class="reference internal" href="#typed-arrays-of-times-numpys-datetime64">Typed arrays of times: NumPy’s <code class="docutils literal notranslate"><span class="pre">datetime64</span></code></a></li>
<li><a class="reference internal" href="#dates-and-times-in-pandas-best-of-both-worlds">Dates and times in pandas: best of both worlds</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pandas-time-series-indexing-by-time">Pandas Time Series: Indexing by Time</a></li>
<li><a class="reference internal" href="#pandas-time-series-data-structures">Pandas Time Series Data Structures</a><ul>
<li><a class="reference internal" href="#regular-sequences-pd-date-range">Regular sequences: <code class="docutils literal notranslate"><span class="pre">pd.date_range()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#frequencies-and-offsets">Frequencies and Offsets</a></li>
<li><a class="reference internal" href="#resampling-shifting-and-windowing">Resampling, Shifting, and Windowing</a><ul>
<li><a class="reference internal" href="#resampling-and-converting-frequencies">Resampling and converting frequencies</a></li>
<li><a class="reference internal" href="#time-shifts">Time-shifts</a></li>
<li><a class="reference internal" href="#rolling-windows">Rolling windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-visualizing-seattle-bicycle-counts">Example: Visualizing Seattle Bicycle Counts</a><ul>
<li><a class="reference internal" href="#visualizing-the-data">Visualizing the data</a></li>
<li><a class="reference internal" href="#digging-into-the-data">Digging into the data</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#matplotlib-module"><code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> module</a><ul>
<li><a class="reference internal" href="#visualization-with-matplotlib">Visualization with Matplotlib</a><ul>
<li><a class="reference internal" href="#general-matplotlib-tips">General Matplotlib Tips</a><ul>
<li><a class="reference internal" href="#saving-figures-to-file">Saving Figures to File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#two-interfaces-for-the-price-of-one">Two Interfaces for the Price of One</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simple-line-plots">Simple Line Plots</a><ul>
<li><a class="reference internal" href="#adjusting-the-plot-line-colors-and-styles">Adjusting the Plot: Line Colors and Styles</a></li>
<li><a class="reference internal" href="#adjusting-the-plot-axes-limits">Adjusting the Plot: Axes Limits</a></li>
<li><a class="reference internal" href="#labeling-plots">Labeling Plots</a></li>
<li><a class="reference internal" href="#aside-matplotlib-gotchas">Aside: Matplotlib Gotchas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simple-scatter-plots">Simple Scatter Plots</a><ul>
<li><a class="reference internal" href="#scatter-plots-with-plt-plot">Scatter Plots with <code class="docutils literal notranslate"><span class="pre">plt.plot</span></code></a></li>
<li><a class="reference internal" href="#scatter-plots-with-plt-scatter">Scatter Plots with <code class="docutils literal notranslate"><span class="pre">plt.scatter</span></code></a></li>
<li><a class="reference internal" href="#plot-versus-scatter-a-note-on-efficiency"><code class="docutils literal notranslate"><span class="pre">plot</span></code> Versus <code class="docutils literal notranslate"><span class="pre">scatter</span></code>: A Note on Efficiency</a></li>
</ul>
</li>
<li><a class="reference internal" href="#visualizing-errors">Visualizing Errors</a><ul>
<li><a class="reference internal" href="#basic-errorbars">Basic Errorbars</a></li>
</ul>
</li>
<li><a class="reference internal" href="#density-and-contour-plots">Density and Contour Plots</a><ul>
<li><a class="reference internal" href="#visualizing-a-three-dimensional-function">Visualizing a Three-Dimensional Function</a></li>
</ul>
</li>
<li><a class="reference internal" href="#histograms-binnings-and-density">Histograms, Binnings, and Density</a><ul>
<li><a class="reference internal" href="#two-dimensional-histograms-and-binnings">Two-Dimensional Histograms and Binnings</a><ul>
<li><a class="reference internal" href="#plt-hist2d-two-dimensional-histogram"><code class="docutils literal notranslate"><span class="pre">plt.hist2d</span></code>: Two-dimensional histogram</a></li>
<li><a class="reference internal" href="#plt-hexbin-hexagonal-binnings"><code class="docutils literal notranslate"><span class="pre">plt.hexbin</span></code>: Hexagonal binnings</a></li>
<li><a class="reference internal" href="#kernel-density-estimation">Kernel density estimation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-plot-legends">Customizing Plot Legends</a><ul>
<li><a class="reference internal" href="#choosing-elements-for-the-legend">Choosing Elements for the Legend</a></li>
<li><a class="reference internal" href="#legend-for-size-of-points">Legend for Size of Points</a></li>
<li><a class="reference internal" href="#multiple-legends">Multiple Legends</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-colorbars">Customizing Colorbars</a><ul>
<li><a class="reference internal" href="#id9">Customizing Colorbars</a><ul>
<li><a class="reference internal" href="#choosing-the-colormap">Choosing the Colormap</a></li>
<li><a class="reference internal" href="#color-limits-and-extensions">Color limits and extensions</a></li>
<li><a class="reference internal" href="#discrete-color-bars">Discrete Color Bars</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-handwritten-digits">Example: Handwritten Digits</a></li>
</ul>
</li>
<li><a class="reference internal" href="#multiple-subplots">Multiple Subplots</a><ul>
<li><a class="reference internal" href="#plt-axes-subplots-by-hand"><code class="docutils literal notranslate"><span class="pre">plt.axes</span></code>: Subplots by Hand</a></li>
<li><a class="reference internal" href="#plt-subplot-simple-grids-of-subplots"><code class="docutils literal notranslate"><span class="pre">plt.subplot</span></code>: Simple Grids of Subplots</a></li>
<li><a class="reference internal" href="#plt-subplots-the-whole-grid-in-one-go"><code class="docutils literal notranslate"><span class="pre">plt.subplots</span></code>: The Whole Grid in One Go</a></li>
<li><a class="reference internal" href="#plt-gridspec-more-complicated-arrangements"><code class="docutils literal notranslate"><span class="pre">plt.GridSpec</span></code>: More Complicated Arrangements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#text-and-annotation">Text and Annotation</a><ul>
<li><a class="reference internal" href="#example-effect-of-holidays-on-us-births">Example: Effect of Holidays on US Births</a></li>
<li><a class="reference internal" href="#transforms-and-text-position">Transforms and Text Position</a></li>
<li><a class="reference internal" href="#arrows-and-annotation">Arrows and Annotation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-ticks">Customizing Ticks</a><ul>
<li><a class="reference internal" href="#major-and-minor-ticks">Major and Minor Ticks</a></li>
<li><a class="reference internal" href="#hiding-ticks-or-labels">Hiding Ticks or Labels</a></li>
<li><a class="reference internal" href="#reducing-or-increasing-the-number-of-ticks">Reducing or Increasing the Number of Ticks</a></li>
<li><a class="reference internal" href="#fancy-tick-formats">Fancy Tick Formats</a></li>
<li><a class="reference internal" href="#summary-of-formatters-and-locators">Summary of Formatters and Locators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#customizing-matplotlib-configurations-and-stylesheets">Customizing Matplotlib: Configurations and Stylesheets</a><ul>
<li><a class="reference internal" href="#plot-customization-by-hand">Plot Customization by Hand</a></li>
<li><a class="reference internal" href="#changing-the-defaults-rcparams">Changing the Defaults: <code class="docutils literal notranslate"><span class="pre">rcParams</span></code></a></li>
<li><a class="reference internal" href="#stylesheets">Stylesheets</a><ul>
<li><a class="reference internal" href="#default-style">Default style</a></li>
<li><a class="reference internal" href="#fivethiryeight-style">FiveThiryEight style</a></li>
<li><a class="reference internal" href="#ggplot">ggplot</a></li>
<li><a class="reference internal" href="#bayesian-methods-for-hackers-style"><em>Bayesian Methods for Hackers</em> style</a></li>
<li><a class="reference internal" href="#seaborn-style">Seaborn style</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#three-dimensional-plotting-in-matplotlib">Three-Dimensional Plotting in Matplotlib</a><ul>
<li><a class="reference internal" href="#three-dimensional-points-and-lines">Three-dimensional Points and Lines</a></li>
<li><a class="reference internal" href="#three-dimensional-contour-plots">Three-dimensional Contour Plots</a></li>
<li><a class="reference internal" href="#wireframes-and-surface-plots">Wireframes and Surface Plots</a></li>
<li><a class="reference internal" href="#surface-triangulations">Surface Triangulations</a><ul>
<li><a class="reference internal" href="#example-visualizing-a-mobius-strip">Example: Visualizing a Möbius strip</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#visualization-with-seaborn">Visualization with Seaborn</a><ul>
<li><a class="reference internal" href="#seaborn-versus-matplotlib">Seaborn Versus Matplotlib</a></li>
<li><a class="reference internal" href="#exploring-seaborn-plots">Exploring Seaborn Plots</a><ul>
<li><a class="reference internal" href="#histograms-kde-and-densities">Histograms, KDE, and densities</a></li>
<li><a class="reference internal" href="#pair-plots">Pair plots</a></li>
<li><a class="reference internal" href="#faceted-histograms">Faceted histograms</a></li>
<li><a class="reference internal" href="#factor-plots">Factor plots</a></li>
<li><a class="reference internal" href="#joint-distributions">Joint distributions</a></li>
<li><a class="reference internal" href="#bar-plots">Bar plots</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-exploring-marathon-finishing-times">Example: Exploring Marathon Finishing Times</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#networkx-module"><code class="docutils literal notranslate"><span class="pre">networkx</span></code> module</a><ul>
<li><a class="reference internal" href="#nodes">Nodes</a></li>
<li><a class="reference internal" href="#edges">Edges</a></li>
<li><a class="reference internal" href="#what-to-use-as-nodes-and-edges">What to use as nodes and edges</a></li>
<li><a class="reference internal" href="#accessing-edges-and-neighbors">Accessing edges and neighbors</a></li>
<li><a class="reference internal" href="#adding-attributes-to-graphs-nodes-and-edges">Adding attributes to graphs, nodes, and edges</a><ul>
<li><a class="reference internal" href="#graph-attributes">Graph attributes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#node-attributes">Node attributes</a></li>
<li><a class="reference internal" href="#edge-attributes">Edge Attributes</a></li>
<li><a class="reference internal" href="#multigraphs">Multigraphs</a></li>
<li><a class="reference internal" href="#graph-generators-and-graph-operations">Graph generators and graph operations</a></li>
<li><a class="reference internal" href="#analyzing-graphs">Analyzing graphs</a></li>
<li><a class="reference internal" href="#drawing-graphs">Drawing graphs</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tips-an-tricks">Tips an’ Tricks</a><ul>
<li><a class="reference internal" href="#tips-tricks-and-gotchas">Tips, tricks and gotchas</a><ul>
<li><a class="reference internal" href="#a-grouping-pattern-avoiding-quadratic-time">A grouping pattern, avoiding <em>quadratic</em> time</a></li>
<li><a class="reference internal" href="#the-bunch-pattern">The <em>Bunch</em> pattern</a></li>
<li><a class="reference internal" href="#pythons-list-append-isnt-lisps-cons">Python’s <code class="docutils literal notranslate"><span class="pre">list.append</span></code> isn’t Lisp’s <code class="docutils literal notranslate"><span class="pre">cons</span></code></a><ul>
<li><a class="reference internal" href="#enhance-with-deque-objects">enhance with <code class="docutils literal notranslate"><span class="pre">deque</span></code> objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#hidden-squares-concerning-lists-and-sets">Hidden squares: concerning <code class="docutils literal notranslate"><span class="pre">list</span></code>s and <code class="docutils literal notranslate"><span class="pre">set</span></code>s</a><ul>
<li><a class="reference internal" href="#concerning-strings">concerning <code class="docutils literal notranslate"><span class="pre">string</span></code>s</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#counting">Counting</a><ul>
<li><a class="reference internal" href="#max-permutation">Max permutation</a></li>
<li><a class="reference internal" href="#counting-sort">Counting Sort</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#generators">Generators</a><ul>
<li><a class="reference internal" href="#the-python-language-documentation">The Python language documentation</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">APAD course’s content</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/all.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="APAD course’s content"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">APAD course  documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Massimo Nocentini.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>